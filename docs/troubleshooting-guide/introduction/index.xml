<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>– Introduction</title><link>/docs/troubleshooting-guide/introduction/</link><description>Recent content in Introduction on</description><generator>Hugo -- gohugo.io</generator><atom:link href="/docs/troubleshooting-guide/introduction/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Systemd and TDNF</title><link>/docs/troubleshooting-guide/introduction/systemd-and-tdnf/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/troubleshooting-guide/introduction/systemd-and-tdnf/</guid><description>
&lt;p>By using systemd, Photon OS adopts a contemporary Linux standard to bootstrap the user space and concurrently start services, an architecture that differs from traditional Linux systems such as SUSE Linux Enterprise Server 11.&lt;/p>
&lt;p>A traditional Linux system contains an initialization system called SysVinit. With SLES 11, for instance, SysVinit-style init programs control how the system starts up and shuts down. Init implements system runlevels. A SysVinit runlevel defines a state in which a process or service runs. In contrast to a SysVinit system, systemd defines no such runlevels. Instead, systemd uses a dependency tree of &lt;em>targets&lt;/em> to determine which services to start when.&lt;/p>
&lt;p>Because the systemd commands differ from those of an init.d-based Linux system, a section later in this guide illustrates how to troubleshoot by using systemctl commands instead of init.d-style commands.&lt;/p>
&lt;p>Tdnf keeps the operating system as small as possible while preserving yum&amp;rsquo;s robust package-management capabilities. On Photon OS, tdnf is the default package manager for installing new packages. Since troubleshooting with tdnf differs from using yum, a later section of this guide describes how to solve problems with packages and repositories by using tdnf commands.&lt;/p></description></item><item><title>Docs: The Root Account and the `sudo` and `su` Commands</title><link>/docs/troubleshooting-guide/introduction/root-account-sudo-and-su-commands/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/troubleshooting-guide/introduction/root-account-sudo-and-su-commands/</guid><description>
&lt;p>The &lt;em>Troubleshooting Guide&lt;/em> assumes that you are logged in to Photon OS with the root account and running commands as root. The &lt;code>sudo&lt;/code> program comes with the full version of Photon OS. On the minimal version, you must install &lt;code>sudo&lt;/code> with tdnf if you want to use it. As an alternative to installing &lt;code>sudo&lt;/code> on the minimal version, you can switch users as needed with the &lt;code>su&lt;/code> command to run commands that require root privileges.&lt;/p></description></item><item><title>Docs: Checking the Version and Build Number</title><link>/docs/troubleshooting-guide/introduction/checking-the-version-and-build-number/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/troubleshooting-guide/introduction/checking-the-version-and-build-number/</guid><description>
&lt;p>To check the version and build number of Photon OS, concatenate &lt;code>/etc/photon-release&lt;/code>.&lt;/p>
&lt;p>Example:&lt;/p>
&lt;pre>&lt;code>cat /etc/photon-release
VMware Photon Linux 1.0
PHOTON_BUILD_NUMBER=a6f0f63
&lt;/code>&lt;/pre>
&lt;p>The build number in the results maps to the commit number on the VMware Photon OS GitHub &lt;a href="https://github.com/vmware/photon/commits/master">commits page&lt;/a>.&lt;/p></description></item><item><title>Docs: General Best Practices</title><link>/docs/troubleshooting-guide/introduction/general-best-practices/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/troubleshooting-guide/introduction/general-best-practices/</guid><description>
&lt;p>When troubleshooting, it is recommended that you follow some general best practices:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Take a snapshot.&lt;/strong> Before you do anything to a virtual machine running Photon OS, take a snapshot of the VM so that you can restore it if need be.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Make a backup copy.&lt;/strong> Before you change a configuration file, make a copy of the original file. For example: &lt;code>cp /etc/tdnf/tdnf.conf /etc/tdnf/tdnf.conf.orig&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Collect logs.&lt;/strong> Save the log files associated with a Photon OS problem. Include not only the log files on the guest but also the &lt;code>vmware.log&lt;/code> file on the host. The &lt;code>vmware.log&lt;/code> file is in the host&amp;rsquo;s directory that contains the VM.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Know what is in your toolbox.&lt;/strong> View the man page for a tool before you use it so that you know what your options are. The options can help focus the command&amp;rsquo;s output on the problem you&amp;rsquo;re trying to solve.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Understand the system.&lt;/strong> The more you know about the operating system and how it works, the better you can troubleshoot.&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>Docs: Photon OS Logs</title><link>/docs/troubleshooting-guide/introduction/photon-os-logs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/troubleshooting-guide/introduction/photon-os-logs/</guid><description>
&lt;p>On Photon OS, all the system logs except the installation logs and the cloud-init logs are written into the systemd journal. The &lt;code>journalctl&lt;/code> command queries the contents of the systemd journal.&lt;/p>
&lt;p>The installation log files and the cloud-init log files reside in &lt;code>/var/log&lt;/code>. If Photon OS is running on a virtual machine in a VMware hypervisor, the log file for the VMware tools, &lt;code>vmware-vmsvc.log&lt;/code>, also resides in &lt;code>/var/log&lt;/code>.&lt;/p>
&lt;p>##Journalctl
Journalctl is a utility to query and display logs from journald and systemd’s logging service. Since journald stores log data in a binary format instead of a plain text format, &lt;code>journalctl&lt;/code> is the standard way of reading log messages processed by journald.&lt;/p>
&lt;p>Journald is a service provided by systemd. To see the staus of the daemon, run the following commands:&lt;/p>
&lt;pre>&lt;code># systemctl status systemd-journald
● systemd-journald.service - Journal Service
Loaded: loaded (/lib/systemd/system/systemd-journald.service; static; vendor preset: enabled)
Active: active (running) since Tue 2020-04-07 14:33:41 CST; 2 days ago
Docs: man:systemd-journald.service(8)
man:journald.conf(5)
Main PID: 943 (systemd-journal)
Status: &amp;quot;Processing requests...&amp;quot;
Tasks: 1 (limit: 4915)
Memory: 18.0M
CGroup: /system.slice/systemd-journald.service
└─943 /lib/systemd/systemd-journald
Apr 07 14:33:41 photon-4a0e7f2307d4 systemd-journald[943]: Journal started
Apr 07 14:33:41 photon-4a0e7f2307d4 systemd-journald[943]: Runtime journal (/run/log/journal/b8cebc61a6cb446a968ee1d4c5bbbbd5) is 8.0M, max 1.5G, 1.5G free.
Apr 07 14:33:41 photon-4a0e7f2307d4 systemd-journald[943]: Time spent on flushing to /var is 88.263ms for 1455 entries.
Apr 07 14:33:41 photon-4a0e7f2307d4 systemd-journald[943]: System journal (/var/log/journal/b8cebc61a6cb446a968ee1d4c5bbbbd5) is 40.0M, max 4.0G, 3.9G free.
root@photon-4a0e7f2307d4 [ ~ ]#
&lt;/code>&lt;/pre>&lt;p>The following command are related to &lt;code>journalctl&lt;/code>:&lt;/p>
&lt;ul>
&lt;li>&lt;code>journalctl&lt;/code> : This command displays all the logs after the system has booted up. &lt;code>journalctl&lt;/code> splits the results into pages, similar to the &lt;code>less&lt;/code> command in Linux. You can navigate using the arrow keys, the Page Up, Page Down keys or the Space bar. To quit navigation, press the &lt;strong>q&lt;/strong> key.&lt;/li>
&lt;li>&lt;code>journalctl -b&lt;/code> : This command displays the logs for the current boot.&lt;/li>
&lt;/ul>
&lt;p>The following commands pull logs based on a time range:&lt;/p>
&lt;ul>
&lt;li>&lt;code>journalctl --since &amp;quot;1 hour ago&amp;quot;&lt;/code> : This command displays the journal logs from the past 1 hour.&lt;/li>
&lt;li>&lt;code>journalctl --since &amp;quot;2 days ago&amp;quot;&lt;/code> : This command displays the logs generated in the past 2 days.&lt;/li>
&lt;li>&lt;code>journalctl --since &amp;quot;2020-03-25 00:00:00&amp;quot; --until &amp;quot;2020-04-09 00:00:00&amp;quot;&lt;/code> : This command displays the logs generated between the mentioned time frame.&lt;/li>
&lt;/ul>
&lt;p>To traverse for logs in the reverse order, run the following command:&lt;/p>
&lt;ul>
&lt;li>&lt;code>journalctl -r&lt;/code> : This command displays the logs in reverse order.&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Note&lt;/strong>: If you add &lt;code>-r&lt;/code> at the end of a command, the logs are displayed in the reverse order. For example: &lt;code>journalctl -u unit.service -r&lt;/code>&lt;/p>
&lt;p>To pull logs related to a particular daemon, run the following command:&lt;/p>
&lt;ul>
&lt;li>&lt;code>journalctl -u unit.service&lt;/code> : This command displays logs for a specific service. mention the name of the service instead of &lt;code>unit&lt;/code>. This command helps when a service is not behaving properly or when there are crash/core dumps.&lt;/li>
&lt;/ul>
&lt;p>To see Journal logs by their priority, run the following command:&lt;/p>
&lt;ul>
&lt;li>&lt;code>journalctl -p &amp;quot;emerg&amp;quot;..&amp;quot;crit&lt;/code> : This command displays logs &lt;strong>emerg&lt;/strong> to &lt;strong>critical&lt;/strong>. For example: core dumps.&lt;/li>
&lt;/ul>
&lt;p>Journalctl can print log messages to the console as they are added, like the Linux &lt;code>tail&lt;/code> command. Add the &lt;code>-f&lt;/code> switch to follow a specific service or daemon.&lt;/p>
&lt;pre>&lt;code>journalctl -u unit.service -f
&lt;/code>&lt;/pre>&lt;p>To list the boots of the system, run the following command:&lt;/p>
&lt;pre>&lt;code>journalctl --list-boots
&lt;/code>&lt;/pre>&lt;p>You can maintain the journalctl logs manually, by running the following &lt;code>vacuum&lt;/code> commands:&lt;/p>
&lt;ul>
&lt;li>&lt;code>journalctl --vacuum-time=2d&lt;/code> : This command retains the logs from the last 2 days.&lt;/li>
&lt;li>&lt;code>journalctl --vacuum-size=500M&lt;/code> : This command helps retain logs with a maximum size of 500 MB.&lt;/li>
&lt;/ul>
&lt;p>You can configure Journald using the conf file located at &lt;strong>/etc/systemd/journald.conf&lt;/strong>. Run the following command to configure the file:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console"># cat /etc/systemd/journald.conf
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#8f5902;font-style:italic"># This file is part of systemd.&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># systemd is free software; you can redistribute it and/or modify it&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># under the terms of the GNU Lesser General Public License as published by&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># the Free Software Foundation; either version 2.1 of the License, or&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># (at your option) any later version.&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Entries in this file show the compile time defaults.&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># You can change settings by editing this file.&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># Defaults can be restored by simply deleting this file.&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># See journald.conf(5) for details.&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">[Journal]&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#Storage=auto&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#Compress=yes&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#Seal=yes&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#SplitMode=uid&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#SyncIntervalSec=5m&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#RateLimitIntervalSec=30s&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#RateLimitBurst=10000&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#SystemMaxUse=&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#SystemKeepFree=&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#SystemMaxFileSize=&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#SystemMaxFiles=100&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#RuntimeMaxUse=&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#RuntimeKeepFree=&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#RuntimeMaxFileSize=&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#RuntimeMaxFiles=100&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#MaxRetentionSec=&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#MaxFileSec=1month&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#ForwardToSyslog=no&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#ForwardToKMsg=no&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#ForwardToConsole=no&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#ForwardToWall=yes&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#TTYPath=/dev/console&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#MaxLevelStore=debug&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#MaxLevelSyslog=debug&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#MaxLevelKMsg=notice&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#MaxLevelConsole=info&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#MaxLevelWall=emerg&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">#LineMax=48K&lt;/span>
&lt;span style="color:#c4a000">root@photon-4a0e7f2307d4 [ ~ ]#&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>By default &lt;code>rotate&lt;/code> is disabled in Photon. Once the changes are made to the conf file, for the changes to take effect you must restart the systemd-journald by running the &lt;code>systemctl restart systemd-journald&lt;/code> command.&lt;/p>
&lt;h2 id="cloud-init-logs">Cloud-init Logs&lt;/h2>
&lt;p>Cloud-init is the industry standard multi-distribution method for cross-platform cloud instance initialisation.&lt;/p>
&lt;p>If there are with the Cloud-init behaviour, we can debug them by looking at the logs. Run the following command to look at Cloud-init logs:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">journalctl -u cloud-init
&lt;/code>&lt;/pre>&lt;p>For better understanding/debugging, You can also look at logs from the following locations:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>/var/log/cloud-init.log&lt;/strong> : This log contains information from each stage of Cloud-init.&lt;/li>
&lt;li>&lt;strong>/var/log/cloud-init-output.log&lt;/strong> : This log contains errors, warnings, etc..&lt;/li>
&lt;/ul>
&lt;h2 id="syslog">Syslog&lt;/h2>
&lt;p>Syslog is the general standard for logging system and program messages in the Linux environment.&lt;/p>
&lt;p>Photon provides the following two packages to support syslog:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>syslog-ng&lt;/strong> : syslog-ng is syslog with some advanced next gen features. It supports TLS encryption, TCP for transport with other existing features. Configurations can be added to the &lt;code>/etc/syslog-ng/syslog-ng.conf&lt;/code> file.&lt;/li>
&lt;li>&lt;strong>rsyslog&lt;/strong> : The official RSYSLOG website defines the utility as &amp;ldquo;the rocket-fast system for log processing&amp;rdquo;. rsyslog supports some advanced features like relp, imfile, omfile, gnutls protocols. Configurations can be added to the &lt;code>/etc/rsyslog.conf&lt;/code> file. You can configure the required TLS certificates by editing the conf file.&lt;/li>
&lt;/ul>
&lt;h2 id="logs-for-rpms-on-photon">Logs for RPMS on Photon&lt;/h2>
&lt;p>Logs for a particular RPM can be checked in the following ways:&lt;/p>
&lt;ul>
&lt;li>If the RPM provides a daemon, we can see the status of daemon by running &lt;code>systemctl&lt;/code> command and check logs using &lt;code>journactl -u &amp;lt;service name&amp;gt;&lt;/code> command.&lt;/li>
&lt;li>For additional logs, check if a conf file is provided by the RPM by running the &lt;code>rpm -ql &amp;lt;rpm name&amp;gt; | grep conf&lt;/code> command and find the file path of the log file. You can also check the &lt;strong>/var/log&lt;/strong> folder.&lt;/li>
&lt;/ul></description></item><item><title>Docs: Troubleshooting Progression</title><link>/docs/troubleshooting-guide/introduction/troubleshooting-progression/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/troubleshooting-guide/introduction/troubleshooting-progression/</guid><description>
&lt;p>If you encounter a problem running an application or appliance on Photon OS and you suspect it involves the operating system, you can troubleshoot by proceeding as follows.&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Check the services running on Photon OS:&lt;/p>
&lt;p>&lt;code>systemctl status&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Check your application log files for errors. For VMware applications, see &lt;a href="https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;amp;cmd=displayKC&amp;amp;externalId=1021806">Location of Log Files for VMware Products&lt;/a>.)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Check the service controller or service monitor for your application or appliance.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Check the network interfaces and other aspects of the network service with &lt;code>systemd-network&lt;/code> commands.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Check the operating system log files:&lt;/p>
&lt;p>&lt;code>journalctl&lt;/code>&lt;/p>
&lt;p>Next, run the following commands to view all services according to the order in which they were started:&lt;/p>
&lt;p>&lt;code>systemd-analyze critical-chain&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Use the troubleshooting tool that you think is most likely to help with the issue at hand. For example, use &lt;code>strace&lt;/code> to identify the location of the failure.&lt;/p>
&lt;/li>
&lt;/ol></description></item></channel></rss>