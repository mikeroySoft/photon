<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.82.0"><link rel=canonical type=text/html href=../../../../docs/administration-guide/photon-rpm-ostree/><link rel=alternate type=application/rss+xml href=../../../../docs/administration-guide/photon-rpm-ostree/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=../../../../favicons/favicon.ico><link rel=apple-touch-icon href=../../../../favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=../../../../favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=../../../../favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=../../../../favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=../../../../favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=../../../../favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=../../../../favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=../../../../favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=../../../../favicons/android-192x192.png sizes=192x192><title>Photon RPM OSTree: a simple guide |</title><meta property="og:title" content="Photon RPM OSTree: a simple guide"><meta property="og:description" content="VMware Photon docs"><meta property="og:type" content="website"><meta property="og:url" content="/docs/administration-guide/photon-rpm-ostree/"><meta itemprop=name content="Photon RPM OSTree: a simple guide"><meta itemprop=description content="VMware Photon docs"><meta name=twitter:card content="summary"><meta name=twitter:title content="Photon RPM OSTree: a simple guide"><meta name=twitter:description content="VMware Photon docs"><link rel=preload href=../../../../scss/main.min.37920ca9c3c378ff1556150cf2bce5faf1a7ed81d061a0bc35771668193fe176.css as=style><link href=../../../../scss/main.min.37920ca9c3c378ff1556150cf2bce5faf1a7ed81d061a0bc35771668193fe176.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class=td-section><header><div class="container-fluid pl-3 pr-3" id=navbarish><nav class="navbar navbar-default navbar-dark navbar-expand-md d-flex justify-content-between" role=navigation data-toggle=collapse data-target=#menu_items aria-expanded=false aria-controls=navbar><div class="navbar-header d-flex align-items-center justify-content-between"><a class=navbar-brand href=../../../../><span class=navbar-logo><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.4375 135.7375" height="135.7375" width="511.4375" id="svg3355"><defs id="defs3359"><clipPath id="clipPath3387" clipPathUnits="userSpaceOnUse"><path id="path3389" d="M142.293 245.191l494.93 337.36L74.8398 348.098"/></clipPath><linearGradient id="linearGradient3391" spreadMethod="pad" gradientTransform="matrix(-493.8,-339.007,339.007,-493.8,601.845,634.081)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3393" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3395" offset="1" style="stop-opacity:1;stop-color:#80c64c"/></linearGradient><clipPath id="clipPath3405" clipPathUnits="userSpaceOnUse"><path id="path3407" d="M85.2852 570.719 516.813 593.84 54.5195 690.582"/></clipPath><linearGradient id="linearGradient3409" spreadMethod="pad" gradientTransform="matrix(-304.079,-208.759,208.759,-304.079,420.197,734.568)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3411" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3413" offset="1" style="stop-opacity:1;stop-color:#22437e"/></linearGradient><clipPath id="clipPath3423" clipPathUnits="userSpaceOnUse"><path id="path3425" d="m538.137 270.234 95.324 293.5-205.699-247.089"/></clipPath><linearGradient id="linearGradient3427" spreadMethod="pad" gradientTransform="matrix(-255.101,-175.134,175.134,-255.101,686.667,486.234)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3429" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3431" offset="1" style="stop-opacity:1;stop-color:#65a5de"/></linearGradient><clipPath id="clipPath3441" clipPathUnits="userSpaceOnUse"><path id="path3443" d="M857.758 94.3906 656.035 546.801 745.172 53.6406"/></clipPath><linearGradient id="linearGradient3445" spreadMethod="pad" gradientTransform="matrix(-102.35,-449.574,449.574,-102.35,800.888,513.826)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3447" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3449" offset="1" style="stop-opacity:1;stop-color:#c6da3a"/></linearGradient><clipPath id="clipPath3459" clipPathUnits="userSpaceOnUse"><path id="path3461" d="M481.316 864.746 635.938 602.125l-41.313 301.32"/></clipPath><linearGradient id="linearGradient3463" spreadMethod="pad" gradientTransform="matrix(67.7401,274.401,-274.401,67.7401,532.514,627.656)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3465" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3467" offset="1" style="stop-opacity:1;stop-color:#c6da3a"/></linearGradient><clipPath id="clipPath3477" clipPathUnits="userSpaceOnUse"><path id="path3479" d="M1085.54 913.828 683.598 585.359l456.522 219.75"/></clipPath><linearGradient id="linearGradient3481" spreadMethod="pad" gradientTransform="matrix(441.375,262.068,-262.068,441.375,675.147,599.59)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3483" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3485" offset="1" style="stop-opacity:1;stop-color:#22638b"/></linearGradient><clipPath id="clipPath3495" clipPathUnits="userSpaceOnUse"><path id="path3497" d="M1177.19 335.031 693.664 556.211 1106.69 235.887"/></clipPath><linearGradient id="linearGradient3499" spreadMethod="pad" gradientTransform="matrix(450.785,-274.875,274.875,450.785,694.818,558.101)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3501" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3503" offset="1" style="stop-opacity:1;stop-color:#a6dbe7"/></linearGradient><clipPath id="clipPath3513" clipPathUnits="userSpaceOnUse"><path id="path3515" d="M209.754 773.73l382.32-187.417L280.926 872.391"/></clipPath><linearGradient id="linearGradient3517" spreadMethod="pad" gradientTransform="matrix(-360.263,223.047,-223.047,-360.263,601.957,602.271)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3519" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3521" offset="1" style="stop-opacity:1;stop-color:#a6dbe7"/></linearGradient></defs><g transform="matrix(1.25,0,0,-1.25,0,135.7375)" id="g3363"><g transform="scale(0.1,0.1)" id="g3365"><path id="path3367" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1544.2 536.77c69.27.0 114.66 37.031 114.66 91.972v1.192c0 59.726-44.79 90.781-112.28 90.781h-105.7V536.77h103.32zm-150.51 203.652c0 13.141 10.75 23.891 23.29 23.891h133.19c94.36.0 156.47-50.172 156.47-132.586v-1.192c0-90.183-75.25-136.765-164.24-136.765h-101.52V367.148c0-13.132-10.76-23.886-23.9-23.886-12.54.0-23.29 10.754-23.29 23.886v373.274"/><path id="path3369" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1765.51 743.41c0 13.141 10.76 23.887 23.29 23.887 13.14.0 23.9-10.746 23.9-23.887V578.574h241.28V743.41c0 13.141 10.74 23.887 23.88 23.887 12.55.0 23.3-10.746 23.3-23.887V367.148c0-13.132-10.75-23.886-23.3-23.886-13.14.0-23.88 10.754-23.88 23.886v167.227H1812.7V367.148c0-13.132-10.76-23.886-23.9-23.886-12.53.0-23.29 10.754-23.29 23.886V743.41"/><path id="path3371" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2554.86 554.082v1.203c0 94.957-69.28 172.598-164.83 172.598-95.56.0-163.65-76.445-163.65-171.406v-1.192c0-94.961 69.28-172.597 164.84-172.597 95.55.0 163.64 76.445 163.64 171.394zm-377.45.0v1.203c0 115.262 86.6 216.192 213.81 216.192 127.2.0 212.6-99.739 212.6-215v-1.192c0-115.265-86.59-216.203-213.79-216.203-127.22.0-212.62 99.738-212.62 215"/><path id="path3373" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2756.35 720.715h-121.24c-11.94.0-22.09 9.555-22.09 21.5.0 11.941 10.15 22.098 22.09 22.098h290.26c11.94.0 22.1-10.157 22.1-22.098.0-11.945-10.16-21.5-22.1-21.5h-121.23V367.148c0-13.132-10.75-23.886-23.9-23.886-13.13.0-23.89 10.754-23.89 23.886v353.567"/><path id="path3375" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3332.78 554.082v1.203c0 94.957-69.28 172.598-164.83 172.598-95.56.0-163.65-76.445-163.65-171.406v-1.192c0-94.961 69.28-172.597 164.84-172.597 95.55.0 163.64 76.445 163.64 171.394zm-377.45.0v1.203c0 115.262 86.6 216.192 213.81 216.192 127.2.0 212.6-99.739 212.6-215v-1.192c0-115.265-86.59-216.203-213.79-216.203-127.22.0-212.62 99.738-212.62 215"/><path id="path3377" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3458.31 742.813c0 12.539 10.75 23.292 23.29 23.292h6.57c10.75.0 17.32-5.375 23.89-13.742l253.83-323.691v315.332c0 12.547 10.14 23.293 23.29 23.293 12.54.0 22.69-10.746 22.69-23.293V366.555c0-12.539-8.96-22.09-21.5-22.09h-2.4c-10.14.0-17.31 5.965-24.48 14.324l-259.2 331.465V366.555c0-12.539-10.14-23.293-23.29-23.293-12.54.0-22.69 10.754-22.69 23.293v376.258"/><path id="path3379" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3982.91 759.98c0 4.528 3.13 7.665 7.66 7.665h2.09c3.14.0 5.22-1.395 6.97-3.829l37.6-58.503 38.3 58.503c1.74 2.434 3.83 3.829 6.61 3.829h2.09c3.83.0 7.32-3.485 7.32-7.665v-94.011c0-4.18-3.49-7.66-7.66-7.66-4.18.0-7.31 3.48-7.31 7.66v72.426l-32.38-48.403c-1.75-2.785-3.83-4.527-6.97-4.527-3.13.0-5.22 1.742-6.96 4.527l-32.04 48.403v-72.426c0-4.18-3.48-7.66-7.66-7.66s-7.66 3.48-7.66 7.66v94.011zm-73.47-7.308h-28.91c-3.82.0-7.3 3.48-7.3 7.308.0 3.836 3.48 7.317 7.3 7.317h72.78c4.18.0 7.31-3.481 7.31-7.317.0-3.828-3.13-7.308-7.31-7.308h-28.55v-86.703c0-4.18-3.48-7.66-8.01-7.66-4.18.0-7.31 3.48-7.31 7.66v86.703"/><path id="path3381" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m597.898 989.039c-236.39.0-428.714-192.324-428.714-428.719.0-236.39 192.324-428.715 428.714-428.715 236.395.0 428.722 192.325 428.722 428.715.0 236.395-192.327 428.719-428.722 428.719zm0-954.289c-289.796.0-525.566 235.773-525.566 525.57s235.77 525.57 525.566 525.57c289.801.0 525.572-235.773 525.572-525.57S887.699 34.75 597.898 34.75"/><g id="g3383"><g clip-path="url(#clipPath3387)" id="g3385"><path id="path3397" style="fill:url(#linearGradient3391);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M142.293 245.191l494.93 337.36L74.8398 348.098"/></g></g><path id="path3399" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m167.938 304.09c-4.524 34.332-36.024 58.496-70.356 53.973-34.332-4.52-58.5-36.02-53.9765-70.352 4.5234-34.336 36.0234-58.5 70.3555-53.977 34.332 4.524 58.5 36.02 53.977 70.356"/><g id="g3401"><g clip-path="url(#clipPath3405)" id="g3403"><path id="path3415" style="fill:url(#linearGradient3409);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M85.2852 570.719 516.813 593.84 54.5195 690.582"/></g></g><path id="path3417" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m124.875 636.605c-4.523 34.333-36.0234 58.5-70.3555 53.977C20.1875 686.059-3.98047 654.559.542969 620.227 5.06641 585.895 36.5664 561.727 70.8984 566.25c34.3356 4.523 58.4996 36.023 53.9766 70.355"/><g id="g3419"><g clip-path="url(#clipPath3423)" id="g3421"><path id="path3433" style="fill:url(#linearGradient3427);fill-opacity:1;fill-rule:nonzero;stroke:none" d="m538.137 270.234 95.324 293.5-205.699-247.089"/></g></g><path id="path3435" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m541.352 289.715c-4.524 34.332-36.024 58.5-70.356 53.973-34.336-4.52-58.5-36.02-53.976-70.352 4.523-34.336 36.023-58.5 70.355-53.977 34.332 4.524 58.496 36.024 53.977 70.356"/><g id="g3437"><g clip-path="url(#clipPath3441)" id="g3439"><path id="path3451" style="fill:url(#linearGradient3445);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M857.758 94.3906 656.035 546.801 745.172 53.6406"/></g></g><path id="path3453" style="fill:#b9d110;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m846.91 110.883c-26.609 22.164-66.144 18.558-88.308-8.051-22.164-26.6132-18.559-66.1406 8.05-88.3125 26.61-22.16013 66.145-18.55075 88.309 8.0586 22.164 26.6016 18.559 66.1446-8.051 88.3049"/><g id="g3455"><g clip-path="url(#clipPath3459)" id="g3457"><path id="path3469" style="fill:url(#linearGradient3463);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M481.316 864.746 635.938 602.125l-41.313 301.32"/></g></g><path id="path3471" style="fill:#b9d110;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m491.863 848.059c26.203-22.645 65.797-19.758 88.442 6.441 22.64 26.203 19.758 65.797-6.446 88.441-26.199 22.645-65.796 19.758-88.437-6.445-22.645-26.199-19.762-65.797 6.441-88.437"/><g id="g3473"><g clip-path="url(#clipPath3477)" id="g3475"><path id="path3487" style="fill:url(#linearGradient3481);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M1085.54 913.828 683.598 585.359l456.522 219.75"/></g></g><path id="path3489" style="fill:#22638b;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1050.12 855.145c2.26-34.555 32.1-60.743 66.66-58.485 34.55 2.254 60.74 32.098 58.48 66.653-2.25 34.554-32.09 60.742-66.65 58.484-34.56-2.254-60.74-32.098-58.49-66.652"/><g id="g3491"><g clip-path="url(#clipPath3495)" id="g3493"><path id="path3505" style="fill:url(#linearGradient3499);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M1177.19 335.031 693.664 556.211 1106.69 235.887"/></g></g><path id="path3507" style="fill:#91d2e1;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1108.75 338.84c-29.47-18.176-38.63-56.805-20.46-86.281 18.18-29.477 56.81-38.637 86.29-20.461 29.47 18.179 38.63 56.808 20.45 86.285-18.17 29.476-56.8 38.637-86.28 20.457"/><g id="g3509"><g clip-path="url(#clipPath3513)" id="g3511"><path id="path3523" style="fill:url(#linearGradient3517);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M209.754 773.73l382.32-187.417L280.926 872.391"/></g></g><path id="path3525" style="fill:#91d2e1;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m278.168 769.453c29.598 17.977 39.02 56.543 21.043 86.145-17.977 29.597-56.543 39.019-86.145 21.043-29.597-17.977-39.019-56.543-21.043-86.141 17.977-29.602 56.543-39.023 86.145-21.047"/><path id="path3527" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m714.422 718.262c8.172-9.321 22.351-10.246 31.672-2.074 9.316 8.175 10.246 22.355 2.07 31.675-8.172 9.317-22.351 10.246-31.672 2.071-9.316-8.172-10.246-22.356-2.07-31.672"/><path id="path3529" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m827.305 484.969c8.175-9.321 22.355-10.25 31.672-2.074 9.32 8.171 10.25 22.355 2.074 31.671-8.172 9.321-22.356 10.247-31.672 2.075-9.32-8.176-10.246-22.356-2.074-31.672"/><path id="path3531" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m906.813 877.289c8.175-9.316 22.355-10.246 31.675-2.07 9.317 8.172 10.246 22.351 2.071 31.672-8.172 9.32-22.356 10.246-31.672 2.074-9.321-8.176-10.246-22.356-2.074-31.676"/><path id="path3533" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m987.531 166.984c8.172-9.32 22.359-10.246 31.669-2.074 9.32 8.176 10.25 22.356 2.08 31.676-8.18 9.316-22.358 10.242-31.678 2.07-9.317-8.176-10.247-22.355-2.071-31.672"/><path id="path3535" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m140.008 473.707c8.172-9.32 22.351-10.246 31.672-2.074 9.316 8.176 10.246 22.355 2.074 31.676-8.176 9.316-22.356 10.246-31.676 2.07-9.316-8.172-10.246-22.356-2.07-31.672"/><path id="path3537" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m609.063 315.641c8.171-9.321 22.355-10.246 31.671-2.075 9.321 8.176 10.246 22.356 2.075 31.676-8.176 9.317-22.356 10.246-31.676 2.071-9.317-8.172-10.246-22.352-2.07-31.672"/><path id="path3539" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m458.551 398.422c8.172-9.317 22.351-10.246 31.672-2.07 9.32 8.171 10.246 22.351 2.074 31.671-8.176 9.317-22.356 10.247-31.676 2.071-9.316-8.172-10.246-22.352-2.07-31.672"/><path id="path3541" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m518.754 661.82c8.176-9.32 22.355-10.246 31.672-2.074 9.32 8.176 10.25 22.356 2.074 31.676-8.176 9.316-22.355 10.246-31.672 2.07-9.32-8.172-10.25-22.355-2.074-31.672"/><path id="path3543" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m744.523 394.66c8.172-9.32 22.356-10.246 31.672-2.074 9.321 8.176 10.246 22.355 2.075 31.676-8.176 9.316-22.356 10.246-31.672 2.07-9.321-8.172-10.25-22.355-2.075-31.672"/><path id="path3545" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m714.422 605.379c8.172-9.32 22.351-10.246 31.672-2.074 9.316 8.172 10.246 22.355 2.07 31.672-8.172 9.32-22.351 10.246-31.672 2.074-9.316-8.176-10.246-22.356-2.07-31.672"/><path id="path3547" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m368.242 469.918c8.172-9.32 22.356-10.25 31.672-2.074 9.32 8.172 10.246 22.355 2.074 31.672-8.175 9.32-22.355 10.246-31.675 2.074-9.317-8.176-10.247-22.356-2.071-31.672"/><path id="path3549" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m633.461 620.176c8.172-9.317 22.355-10.246 31.672-2.071 9.32 8.172 10.246 22.356 2.074 31.672-8.176 9.321-22.355 10.246-31.676 2.075-9.316-8.176-10.246-22.356-2.07-31.676"/><path id="path3551" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m646.691 752.129c8.172-9.32 22.352-10.25 31.672-2.074 9.321 8.172 10.246 22.355 2.075 31.672-8.176 9.32-22.356 10.246-31.676 2.074-9.317-8.176-10.246-22.356-2.071-31.672"/><path id="path3553" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m819.777 334.453c8.176-9.316 22.356-10.246 31.676-2.07 9.317 8.172 10.246 22.351 2.07 31.672-8.171 9.32-22.351 10.246-31.671 2.074-9.321-8.176-10.247-22.356-2.075-31.676"/><path id="path3555" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m812.242 571.512c8.176-9.321 22.356-10.246 31.676-2.074 9.316 8.175 10.246 22.355 2.07 31.675-8.172 9.317-22.351 10.246-31.672 2.071-9.316-8.172-10.246-22.356-2.074-31.672"/><path id="path3557" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m382.156 392.988c8.172-9.316 22.356-10.246 31.672-2.07 9.32 8.172 10.246 22.355 2.074 31.672-8.175 9.32-22.355 10.246-31.672 2.074-9.32-8.176-10.25-22.355-2.074-31.676"/><path id="path3559" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m613.543 476.398c8.176-9.32 22.355-10.25 31.676-2.074 9.316 8.176 10.246 22.356 2.07 31.672-8.172 9.32-22.355 10.246-31.672 2.074-9.32-8.175-10.246-22.355-2.074-31.672"/><path id="path3561" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m435.969 645.902c8.172-9.32 22.351-10.246 31.672-2.074 9.32 8.176 10.246 22.356 2.074 31.676-8.176 9.316-22.356 10.246-31.676 2.07-9.316-8.172-10.246-22.355-2.07-31.672"/><path id="path3563" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m629.688 164.293c8.171-9.32 22.355-10.246 31.671-2.074 9.321 8.176 10.246 22.355 2.075 31.676-8.176 9.316-22.356 10.246-31.672 2.07-9.321-8.172-10.25-22.356-2.074-31.672"/><path id="path3565" style="fill:#b9d110;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m499.398 462.395c12.329-1.301 23.379 7.632 24.684 19.96 1.305 12.325-7.633 23.375-19.961 24.68-12.324 1.305-23.375-7.633-24.68-19.957-1.304-12.328 7.633-23.379 19.957-24.683"/><path id="path3567" style="fill:#b9d110;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m721.23 510.641c-12.3 1.527-23.511-7.207-25.039-19.508-1.527-12.301 7.207-23.512 19.508-25.039 12.301-1.528 23.512 7.207 25.039 19.508 1.528 12.3-7.207 23.507-19.508 25.039"/><path id="path3569" style="fill:#22638b;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m594.34 420.676c-7.543 9.836-21.629 11.695-31.469 4.152-9.836-7.543-11.691-21.633-4.148-31.469s21.632-11.695 31.468-4.152 11.696 21.633 4.149 31.469"/><path id="path3571" style="fill:#22638b;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m594.828 581.156c-7.543 9.836-21.633 11.696-31.469 4.153s-11.695-21.633-4.152-31.469c7.547-9.836 21.633-11.695 31.469-4.152 9.836 7.542 11.695 21.632 4.152 31.468"/><path id="path3573" style="fill:#91d2e1;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m458.199 576.973c5.156 11.273.199 24.59-11.07 29.75-11.274 5.156-24.59.199-29.746-11.071-5.16-11.273-.203-24.589 11.066-29.75 11.274-5.156 24.594-.199 29.75 11.071"/><path id="path3575" style="fill:#91d2e1;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m635.691 569.449c-5.234-11.234-.367-24.59 10.868-29.82 11.238-5.234 24.589-.371 29.824 10.867 5.234 11.234.367 24.586-10.867 29.82-11.239 5.235-24.59.372-29.825-10.867"/></g></g></svg></span><span class="text-uppercase font-weight-bold"></span></a></div><div class=ml-auto><button type=button class="navbar-toggler third-button collapsed" data-toggle=collapse data-target=#menu_items aria-expanded=false aria-controls=navbar><div class=animated-icon><span></span><span></span><span></span></div></button></div><div id=menu_items class="navbar-collapse collapse ml-md-auto justify-content-end text-center"><ul class="nav navbar-nav"><li class="nav-item p-0"><a class=nav-link href=../../../../><span>Home</span></a></li><li class="nav-item p-0"><a class=nav-link href=../../../../blog/><span>Blog</span></a></li><li class="nav-item p-0"><a class=nav-link href=../../../../#features><span>Features</span></a></li><li class="nav-item p-0"><a class=nav-link href=../../../../#contributing><span>Contribute</span></a></li><li class="nav-item p-0"><a class=nav-link href=../../../../docs/><span>Docs</span></a></li><li class="nav-item p-0"><a class=nav-link href=https://github.com/vmware/photon target=_blank><span>Github</span></a></li><div class="navbar-nav dropdown border-0"><li class=nav-item><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Release</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=../../../../docs/>v4 - Latest</a>
<a class=dropdown-item href=../../../../docs-v3/>v3</a>
<a class=dropdown-item href=../../../../assets/files/html/3.0/>v3 (old)</a>
<a class=dropdown-item href=../../../../assets/files/html/1.0-2.0/>v2 and v1</a></div></li></div></ul></div></nav></div></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=../../../../docs/administration-guide/photon-rpm-ostree/>Return to the regular view of this page</a>.</p></div><h1 class=title>Photon RPM OSTree: a simple guide</h1><ul><li>1: <a href=#pg-8f7f63a7d25766bd5b0ef616451b55bb>Introduction</a></li><ul></ul><li>2: <a href=#pg-ec749f9f7439e85434ec839477fa69dd>Installing a host against default server repository</a></li><ul></ul><li>3: <a href=#pg-63adc650f4a841f3597922787528f17c>Concepts in Action</a></li><ul></ul><li>4: <a href=#pg-b62b64295450ca65a5186142fd9f1603>Querying For Commit File and Package Metadata</a></li><ul></ul><li>5: <a href=#pg-6b453783bf3141d3bc03b2e2732f3afc>Host Updating Operations</a></li><ul></ul><li>6: <a href=#pg-9a48799a4bec43b263b76904358449d1>Creating a Server</a></li><ul></ul><li>7: <a href=#pg-51d1d7888a9d42c1f88448d4c263a998>Installing a Photon RPM-OStree host against a custom server repository</a></li><ul></ul><li>8: <a href=#pg-d4ceeae3e03f91651df3a54320340a53>Automatic Updates</a></li><ul></ul><li>9: <a href=#pg-b7d11860a5b7ce11ea16ac719d59deb4>File Oriented Server Operations</a></li><ul></ul><li>10: <a href=#pg-80a9484e4b01a64f6235e211efb26409>Package Oriented Server Operations</a></li><ul></ul><li>11: <a href=#pg-2472b0296edd8e9542da1d39ed9b48cd>Remotes</a></li><ul></ul><li>12: <a href=#pg-732a7f8dd299bd9ffbffb4afab9b21f0>Running container applications between bootable images</a></li><ul></ul><li>13: <a href=#pg-f4acccc20969d619858c0e6c930ecb82>Install or rebase to Photon OS 4.0</a></li><ul></ul></ul><div class=content></div></div><div class=td-content><h1 id=pg-8f7f63a7d25766bd5b0ef616451b55bb>1 - Introduction</h1><h2 id=rpm-ostree-overview>RPM-OSTree Overview</h2><p>OSTree is a tool to manage bootable, immutable, versioned filesystem trees. Unlike traditional package managers like rpm or dpkg that know how to install, uninstall, configure packages, OSTree has no knowledge of the relationship between files. But when you add rpm capabilities on top of OSTree, it becomes RPM-OSTree, meaning a filetree replication system that is also package-aware.</p><p>The idea behind it is to use a client/server architecture to keep your Linux installed machines (physical or VM) in sync with the latest bits, in a predictable and reliable manner. To achieve that, OSTree uses a git-like repository that records the changes to any file and replicate them to any subscriber.</p><p>A system administrator or an image builder developer takes a base Linux image, prepares the packages and other configuration on a server box, executes a command to compose a filetree that the host machines will download and then incrementally upgrade whenever a new change has been committed.
You may read more about OSTree <a href=https://ostree.readthedocs.org/en/latest/>here</a>.</p><h2 id=why-use-rpm-ostree-in-photon>Why use RPM-OSTree in Photon?</h2><p>There are several important benefits:</p><ul><li>Reliable, efficient: The filetree replication is simple, reliable and efficient. It will only transfer deltas over the network. If you have deployed two almost identical bootable images on same box (differing just by several files), it will not take twice the space. The new tree will have a set of hardlinks to the old tree and only the different files will have a separate copy stored to disk.</li><li>Atomic: the filetree replication is atomic. At the end of a deployment, you are either booting from one deployment, or the other. There is no &ldquo;partial deployed bootable image&rdquo;. If anything bad happens during replication or deployment- power loss, network failure, your machine boots from the old image. There is even a tool option to cleanup old deployed (successfully or not) image.</li><li>Manageable: You are provided simple tools to figure out exactly what packages have been installed, to compare files, configuration and package changes between versions.</li><li>Predictable, repeatable: A big headache for a system administrator is to maintain a farm of computers with different packages, files and configuration installed in different order, that will result in exponential set of test cases. With RPM-OStree, you get identical, predictable installed systems.</li></ul><p>As drawbacks, I would mention:</p><ul><li>Some applications configured by user on host may have compatibility issues if they save configuration or download into read only directories like /usr.</li><li>People not used with &ldquo;read only&rdquo; file systems will be disappointed that they could no longer use RPM, yum, tdnf to install whatever they want. Think of this as an &ldquo;enterprise policy&rdquo;. They may circumvent this by customizing the target directory to a writable directory like /var or using rpm to install packages and record them using a new RPM repository in a writable place.</li><li>Administrators need to be aware about the directories re-mapping specific to OSTree and plan accordingly.</li></ul><h2 id=photon-with-rpm-ostree-installation-profiles>Photon with RPM-OSTree installation profiles</h2><p>Photon takes advantage of RPM-OSTree and offers several installation choices:</p><ul><li>Photon RPM-OSTree server - used to compose customized Photon OS installations and to prepare updates. I will call it for short &lsquo;server&rsquo;.</li><li>Photon RPM-OSTree host connected to a default online server repository via http or https, maintained by VMware Photon OS team, where future updates will be published. This will create a minimal installation profile, but with the option to self-upgrade. I will call it for short &lsquo;default host&rsquo;.</li><li>Photon RPM-OSTree host connected to a custom server repository. It requires a Photon RPM-OSTree Server installed in advance. I will call it for short &lsquo;custom host&rsquo;.</li></ul><h2 id=terminology>Terminology</h2><p>In this section, the term <em>OSTree</em> refers to the general use of this technology, the format of the repository or replication protocol.</p><p>The term <em>RPM-OSTree</em> emphasizes the layer that adds RedHat Package Manager compatibility on both ends - at server and at host. However, since Photon OS is an RPM-based Linux, there are places in the documentation and even in the installer menus where <em>OSTree</em> may be used instead of <em>RPM-OSTree</em> when the distinction is not obvious or does not matter in that context.</p><p>When <code>ostree</code> and <code>rpm-ostree</code> are encountered, they refer to the usage of the specific Unix commands.</p><p>Finally, <em>Photon RPM-OSTree</em> is the application or implementation of the RPM-OStree system into Photon OS, materialized into two options: Photon Server and Photon Host (or client). <em>Server</em> or <em>Host</em> may be used with or without the <em>Photon</em> and/or <em>RPM-OStree</em> qualifier, but it means the same thing.</p><h2 id=sample-code>Sample code</h2><p>Codes samples used throughout the book are small commands that can be typed at shell command prompt and do not require downloading additional files. As an alternative, one can remote connect via ssh, so cut & paste sample code from outside sources or copy files via scp will work. See the Photon Administration guide to learn <a href=../../../../docs/troubleshooting-guide/solutions-to-common-problems/permitting-root-login-with-ssh/>how to enable ssh</a>.
The samples assume that the following VMs have been installed - see the steps in the next chapters:</p><ul><li>A default host VM named <strong>photon-host-def</strong>.</li><li>Two server VMs named <strong>photon-srv1</strong> and <strong>photon-srv2</strong>.</li><li>Two custom host VMs named <strong>photon-host-cus1</strong> and <strong>photon-host-cus2</strong>, connected each to the corresponding server during install.</li></ul><h2 id=how-to-read-this-document>How to read this document</h2><p>The RPM OSTree guide is structured to be used both as a sequential read and as a reference documentation.<br>If you are just interested in deploying a host system and keeping it up to date, then read <a href=../../../../docs/administration-guide/installing-a-host-against-default-server-repository/>Installing a Photon RPM-OSTree host against default server repository</a> and <a href=../../../../docs/administration-guide/photon-rpm-ostree/host-updating-operations/>Host updating operations</a>.</p><p>If you want to install your own server and experiment with customizing packages for your Photon hosts, then read <a href=docs/administration-guide/photon-rpm-ostree/creating-a-rpm-ostree-server/>Installing a Photon RPM-OSTree server</a> onwards. There are references to the concepts discussed throughout the book, if you need to understand them better.</p><h2 id=rpm-ostree-in-photon-os-40>RPM OSTree in Photon OS 4.0</h2><p>This book is relevant to RPM OSTree in Photon OS 4.0.</p><p>Version 4.0 supports the following features:</p><ul><li>Upgrade</li><li>Rollback</li><li>Remote, compose, and rebase server</li><li>Installation and uninstallation of packages with URL</li><li>Installation and uninstallation of packages from default repos</li><li>Automatic updates</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ec749f9f7439e85434ec839477fa69dd>2 - Installing a host against default server repository</h1><p>RPM-OSTree Host default server repo installation option in Photon OS will setup a profile similar to Photon Minimal, with the added benefit of being able to self-upgrade.</p><h2 id=who-is-this-for>Who is this for?</h2><p>The RPM-OSTree &lsquo;default host&rsquo; is the easiest way to deploy a Photon RPM-OSTree host from ISO/cdrom, without the need to deploy and maintain an RPM-OSTree server. It is targeted at the user who relies on VMware Photon OS team to keep his or her system up-to-date, configured to get its updates from the official Photon OSTree repository.</p><p>This is also the fastest way to install a host, as we&rsquo;ve included in the ISO/cdrom an identical copy of the Photon &ldquo;starter&rdquo; RPM-OSTree repository that is published online by VMware Photon OS team. So rather than pulling from the online repository, the installer pulls the repo from cdrom, which saves bandwidth and also reduces to zero the chances of failing due to a networking problem. After successful installation, any updates are going to be pulled from the official online repository, when Photon OS team will make them available.</p><p><strong>Note</strong>: It is also possible to install an RPM-OSTree host against the official online repo via PXE boot, without the benefit of fast, local pull from cdrom. This will be covered in the PXE boot/kickstart chapter, as it requires additional configuration.</p><h2 id=installing-the-iso>Installing the ISO</h2><p>User will first download <a href=https://github.com/vmware/photon/wiki/Downloading-Photon-OS>Photon OS ISO file</a> that contains the installer, which is able to deploy any of the supported Photon installation profiles.</p><p>There are some steps common to all Photon installation profiles, starting with adding a VM in VMware Fusion, Workstation or ESXi, selecting the OS family, then customizing for disk size, CPU, memory size, network interface etc. (or leaving the defaults) and selecting the ISO image as cdrom. The installer will launch, that will go through disk partitioning and accepting the license agreement screens, followed by selecting an installation profile.
These steps are described at the page linked below, so I won&rsquo;t repeat them, just that instead of setting up a Photon Minimal profile, we will install a Photon OSTree host:</p><p><a href=../../../../docs/installation-guide/run-photon-on-fusion/>Running Project Photon on Fusion</a>.</p><p>Select the <strong>Photon OSTree Host</strong> option.</p><p><img src=../../../../docs/images/rpmostree-install-options.png alt=PhotonChooseHost></p><p>Continue with setting up a host name like <strong>photon1-def</strong> and a root password, re-confirm.
Then, select &ldquo;Default OSTree Server&rdquo; and continue.</p><p><img src=../../../../docs/images/rpmostree-default.png alt=PhotonChooseHostDefault></p><p><img src=../../../../docs/images/photon-os-finish.png alt=PhotonHostDefaultFinish></p><p>When installation is over, the VM will reboot and will show in grub VMWare Photon/Linux 4.0_minimal (ostree), which will reassure that it&rsquo;s booting from an OSTree image!</p><p><img src=../../../../docs/images/rpmostree-grub.png alt=PhotonHostFirstRebootGrub></p><p>Boot, login and you are ready to use it.</p><p>To upgrade your host, see <a href=../../../../docs/administration-guide/photon-rpm-ostree/host-updating-operations/>Host updating operations</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-63adc650f4a841f3597922787528f17c>3 - Concepts in Action</h1><p>Now that we have a fresh installed host (either as <a href=../../../../docs/administration-guide/photon-rpm-ostree/Installing-a-host-against-default-server-repository>default</a> or <a href=../../../../docs/administration-guide/photon-rpm-ostree/Photon-RPM-OSTree:-7-Installing-a-host-against-a-custom-server-repository>custom</a>, we can better explain the OStree concepts and see them in action.</p><h2 id=querying-the-deployed-filetrees>Querying the deployed filetrees</h2><p>The first thing to do is to run a command that tells us what is installed on the machine and when. Since it&rsquo;s a fresh install from the CD, there is only one bootable filetree image deployed.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree status 
State: idle
Deployments:
● ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2021-02-20T07:15:43Z)
Commit: 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f
</code></pre><h2 id=bootable-filetree-version>Bootable filetree version</h2><p><strong>4.0_minimal</strong> is not the Linux Photon OS release version, nor daily build, but rather a human readable, self-incrementing version associated with every commit that brings file/package updates. Think of this as version 0. The following versions are going to be 4.0_minimal.1, 4.0_minimal.2, 4.0_minimal.3 and so on.</p><h2 id=commit-id>Commit ID</h2><p>The ID listed is actually the first 5 bytes (10 hex digits) of the commit hash. If you want to see the verbose mode, use the <code>-v</code> option.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree status -v
State: idle
AutomaticUpdates: disabled
Deployments:
● ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2021-02-20T07:15:43Z)
Commit: 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f
└─ photon (2021-02-20T07:11:24Z)
Staged: no
    StateRoot: photon
</code></pre><h3 id=rpm-ostree-options>RPM OStree Options</h3><p>To see the list of options available with the rpm-ostree command, use the -h option.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree -h
Usage:
    rpm-ostree [OPTION…] COMMAND

Builtin Commands:
    compose  Commands to compose a tree
    cleanup  Clear cached/pending data
    db   Commands to query the RPM database
    deploy   Deploy a specific commit
    rebase   Switch to a different tree
    rollback Revert to the previously booted tree
    status   Get the version of the booted system
    upgrade  Perform a system upgrade
    reload   Reload configuration
    usroverlay   Apply a transient overlayfs to /usr
    cancel   Cancel an active transaction
    initramfsEnable or disable local initramfs regeneration
    install  Overlay additional packages
    uninstallRemove overlayed additional packages
    override Manage base package overrides
    resetRemove all mutations
    refresh-md   Generate rpm repo metadata
    kargsQuery or modify kernel arguments

Help Options:
    -h, --help   Show help options

Application Options:
    --versionPrint version information and exit
</code></pre><h2 id=osname>OSname</h2><p>The OS Name identifies the operating system installed. All bootable filetrees for the same OS will share the /var directory, in other words applications installed in one booted image into this directory will be available in all other images.<br>If a new set of images are created for a different OS, they will receive a fresh copy of /var that is not shared with the previous OS images for the initial OS. In other words, if a machine is dual boot for different operating systems, they will not share each other&rsquo;s /var content, however they will still merge 3-way /etc.</p><h2 id=refspec>Refspec</h2><p>The <strong>Refspec</strong> is a branch inside the repo, expressed in a hierarchical way. In this case, it&rsquo;s the default branch that will receive package updates for the Photon OS 1.0 Minimal installation profile on Intel platforms. There could be other branches in the future, for example photon/3.0/x86_64/full that will match the Full installation profile (full set of packages installed).<br>Think of Refspec as the head of the minimal branch (just like in git) at the origin repo. On the replicated, local repo at the host, <strong>minimal</strong> is a file that contains the latest commit ID known for that branch.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# cat /ostree/repo/refs/remotes/photon/photon/4.0/x86_64/minimal
820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88
</code></pre><p>Why are there two &lsquo;photon&rsquo; directory levels in the remotes path? The <strong>photon:</strong> prefix in the Refspec listed by <code>rpm-ostree status</code> corresponds to the first <strong>photon</strong> directory in the remotes path and is actually the name given to the remote that the host is connected to, which points to an http or https URL. We&rsquo;ll talk about remotes later, but for now think of it as a namespace qualifier. The second <strong>photon</strong> is part of the Refspec path itself.</p><h2 id=deployments>Deployments</h2><p>We&rsquo;ve used so far <code>rpm-ostree</code>. The same information can be obtained running an <code>ostree</code> command:</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree admin status
* photon 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f.0
Version: 4.0_minimal
origin refspec: photon:photon/4.0/x86_64/minimal
</code></pre><p>But where is this information stored? As you may have guessed, the local repo stores the heads of the deployed trees - the most recent commitment ID, just like Git does:</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# cat /ostree/repo/refs/heads/ostree/0/1/0 
965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f
</code></pre><p>This also where this command that lists the references (local heads and remotes) takes its data from:</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree refs
photon:photon/4.0/x86_64/minimal
ostree/0/1/0
</code></pre><p>Based on that, it could find the root of the deployment that it boots from. The actual filetree is deployed right here:</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ls -l /ostree/deploy/photon/deploy/965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f.0
total 36
lrwxrwxrwx  2 root root7 Feb 23 05:43 bin -&gt; usr/bin
drwxr-xr-x  2 root root 4096 Jan  1  1970 boot
drwxr-xr-x  2 root root 4096 Jan  1  1970 dev
drwxr-xr-x 45 root root 4096 Feb 23 06:08 etc
lrwxrwxrwx  2 root root8 Feb 23 05:43 home -&gt; var/home
lrwxrwxrwx  3 root root7 Feb 23 05:43 lib -&gt; usr/lib
lrwxrwxrwx  3 root root7 Feb 23 05:43 lib64 -&gt; usr/lib
lrwxrwxrwx  2 root root9 Feb 23 05:43 media -&gt; run/media
lrwxrwxrwx  2 root root7 Feb 23 05:43 mnt -&gt; var/mnt
lrwxrwxrwx  2 root root7 Feb 23 05:43 opt -&gt; var/opt
lrwxrwxrwx  2 root root   14 Feb 23 05:43 ostree -&gt; sysroot/ostree
drwxr-xr-x  2 root root 4096 Jan  1  1970 proc
lrwxrwxrwx  2 root root   12 Feb 23 05:43 root -&gt; var/roothome
drwxr-xr-x  2 root root 4096 Jan  1  1970 run
lrwxrwxrwx  2 root root8 Feb 23 05:43 sbin -&gt; usr/sbin
lrwxrwxrwx  2 root root7 Feb 23 05:43 srv -&gt; var/srv
drwxr-xr-x  2 root root 4096 Jan  1  1970 sys
drwxr-xr-x  4 root root 4096 Feb 23 05:44 sysroot
lrwxrwxrwx  2 root root   11 Feb 23 05:43 tmp -&gt; sysroot/tmp
drwxr-xr-x 10 root root 4096 Jan  1  1970 usr
drwxr-xr-x  8 root root 4096 Feb 23 05:44 var
</code></pre><p>So how is a deployment linked to a specific branch, originating from a remote repo? Well, there is a file next to the deployed filetree root directory with the same name and <strong>.origin</strong> suffix, that contains exactly this info:</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# cat /ostree/deploy/photon/deploy/965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f.0.origin 
[origin]
refspec=photon:photon/4.0/x86_64/minimal
</code></pre><p>Fast forwarding a bit, if there is a new deployment due to an upgrade or rebase, a new filetree will be added at the same level, and a new .origin file will tie it to the remote branch it originated from.</p><p>The <strong>photon</strong> directory in the path is the actual OSname. Multiple deployments of same OS will share a writable /var folder.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ls -l /ostree/deploy/photon/var/
total 52
drwxr-xr-x   5 root root 4096 Feb 23 05:44 cache
drwxr-xr-x   2 root root 4096 Feb 23 05:44 home
drwxr-xr-x. 17 root root 4096 Feb 23 05:44 lib
drwxr-xr-x   2 root root 4096 Feb 23 05:44 local
lrwxrwxrwx.  1 root root   11 Feb 23 05:44 lock -&gt; ../run/lock
drwxr-xr-x.  4 root root 4096 Feb 23 05:44 log
drwxr-xr-x   2 root root 4096 Feb 23 05:44 mail
drwxr-xr-x   2 root root 4096 Feb 23 05:44 mnt
drwxr-xr-x   4 root root 4096 Feb 23 05:44 opt
drwx------   4 root root 4096 Feb 23 06:09 roothome
lrwxrwxrwx.  1 root root6 Feb 23 05:44 run -&gt; ../run
drwxr-xr-x   3 root root 4096 Feb 23 05:44 spool
drwxr-xr-x   2 root root 4096 Feb 23 05:44 srv
drwxrwxrwt.  5 root root 4096 Feb 23 06:08 tmp
drwxr-xr-x  11 root root 4096 Feb 23 05:44 usrlocal
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-b62b64295450ca65a5186142fd9f1603>4 - Querying For Commit File and Package Metadata</h1><p>There are several ostree and rpm-ostree commands that list file or package data based on either the Commit ID, or Refspec. If Refspec is passed as a parameter, it&rsquo;s the same as passing the most recent commit ID (head) for that branch.</p><h2 id=commit-history>Commit history</h2><p>For a host that is freshly installed, there is only one commit in the history for the only branch.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree log photon/4.0/x86_64/minimal
commit 820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88
ContentChecksum:  c7956cedc5c1b8c07a06e10789c17364a5b7a4b970daab64f3398b7c42bd97d9
Date:  2020-11-04 02:21:47 +0000
Version: 4.0_minimal
(no subject)
</code></pre><p>This commit has no parent; if there was an older commit, it would have been listed too. We can get the same listing (either nicely formatted or raw variant data) by passing the Commit ID. Just the first several hex digits will suffice to identify the commit ID. We can either request to be displayed in a pretty format, or raw - the actual C struct.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree log 820b
commit 820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88
ContentChecksum:  c7956cedc5c1b8c07a06e10789c17364a5b7a4b970daab64f3398b7c42bd97d9
Date:  2020-11-04 02:21:47 +0000
Version: 4.0_minimal
(no subject)
</code></pre><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree log 820b --raw
commit 820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88
({'rpmostree.inputhash': &lt;'1ce3f6d518ec2cbaebc2de2ccb01888e59fc7efb482caba590bc96a604e54f82'&gt;, 'rpmostree.rpmmd-repos': &lt;[{'id': &lt;'photon'&gt;, 'timestamp': &lt;uint64 1604456423&gt;}]&gt;, 'version': &lt;'4.0_minimal'&gt;, 'rpmostree.rpmdb.pkglist': &lt;[('Linux-PAM', '0', '1.4.0', '2.ph4', 'x86_64'), ('attr', '0', '2.4.48', '1.ph4', 'x86_64'), ('audit', '0', '2.8.5', '3.ph4', 'x86_64'), ('autogen-libopts', '0', '5.18.16', '3.ph4', 'x86_64'), ('bash', '0', '5.0', '1.ph4', 'x86_64'), ('bc', '0', '1.07.1', '4.ph4', 'x86_64'), ('bridge-utils', '0', '1.6', '1.ph4', 'x86_64'), ('bubblewrap', '0', '0.4.1', '1.ph4', 'x86_64'), ('bzip2', '0', '1.0.8', '3.ph4', 'x86_64'), ('bzip2-libs', '0', '1.0.8', '3.ph4', 'x86_64'), ('ca-certificates', '0', '20201001', '1.ph4', 'x86_64'), ('ca-certificates-pki', '0', '20201001', '1.ph4', 'x86_64'), ('cloud-init', '0', '20.3', '2.ph4', 'noarch'), ('coreutils-selinux', '0', '8.32', '2.ph4', 'x86_64'), ('cpio', '0', '2.13', '1.ph4', 'x86_64'), ('cracklib', '0', '2.9.7', '1.ph4', 'x86_64'), ('cracklib-dicts', '0', '2.9.7', '1.ph4', 'x86_64'), ('curl', '0', '7.72.0', '2.ph4', 'x86_64'), ('curl-libs', '0', '7.72.0', '2.ph4', 'x86_64'), ('cyrus-sasl', '0', '2.1.27', '3.ph4', 'x86_64'), ('dbus', '0', '1.13.18', '1.ph4', 'x86_64'), ('device-mapper', '0', '2.03.10', '2.ph4', 'x86_64'), ('device-mapper-libs', '0', '2.03.10', '2.ph4', 'x86_64'), ('dhcp-client', '0', '4.4.2', '1.ph4', 'x86_64'), ('dhcp-libs', '0', '4.4.2', '1.ph4', 'x86_64'), ('dracut', '0', '050', '5.ph4', 'x86_64'), ('dracut-tools', '0', '050', '5.ph4', 'x86_64'), ('e2fsprogs', '0', '1.45.6', '2.ph4', 'x86_64'), ('e2fsprogs-libs', '0', '1.45.6', '2.ph4', 'x86_64'), ('elfutils', '0', '0.181', '2.ph4', 'x86_64'), ('elfutils-libelf', '0', '0.181', '2.ph4', 'x86_64'), ('expat', '0', '2.2.9', '2.ph4', 'x86_64'), ('expat-libs', '0', '2.2.9', '2.ph4', 'x86_64'), ('file', '0', '5.39', '1.ph4', 'x86_64'), ('file-libs', '0', '5.39', '1.ph4', 'x86_64'), ('filesystem', '0', '1.1', '4.ph4', 'x86_64'), ('findutils', '0', '4.7.0', '1.ph4', 'x86_64'), ('finger', '0', '0.17', '3.ph4', 'x86_64'), ('flex', '0', '2.6.4', '3.ph4', 'x86_64'), ('fuse', '0', '2.9.9', '1.ph4', 'x86_64'), ('gawk', '0', '5.1.0', '1.ph4', 'x86_64'), ('gc', '0', '8.0.4', '1.ph4', 'x86_64'), ('gdbm', '0', '1.18.1', '1.ph4', 'x86_64'), ('glib', '0', '2.66.1', '1.ph4', 'x86_64'), ('glib-networking', '0', '2.66.0', '1.ph4', 'x86_64'), ('glibc', '0', '2.32', '1.ph4', 'x86_64'), ('glibc-iconv', '0', '2.32', '1.ph4', 'x86_64'), ('gmp', '0', '6.2.0', '1.ph4', 'x86_64'), ('gnupg', '0', '2.2.23', '1.ph4', 'x86_64'), ('gnutls', '0', '3.6.15', '3.ph4', 'x86_64'), ('gobject-introspection', '0', '1.66.0', '1.ph4', 'x86_64'), ('gpgme', '0', '1.14.0', '1.ph4', 'x86_64'), ('grep', '0', '3.4', '1.ph4', 'x86_64'), ('grub2', '0', '2.04', '2.ph4', 'x86_64'), ('grub2-efi', '0', '2.04', '2.ph4', 'x86_64'), ('grub2-efi-image', '0', '2.04', '2.ph4', 'x86_64'), ('grub2-pc', '0', '2.04', '2.ph4', 'x86_64'), ('grub2-theme', '0', '4.0', '1.ph4', 'noarch'), ('grub2-theme-ostree', '0', '4.0', '1.ph4', 'noarch'), ('guile', '0', '2.0.13', '3.ph4', 'x86_64'), ('gzip', '0', '1.10', '1.ph4', 'x86_64'), ('iana-etc', '0', '2.30', '2.ph4', 'noarch'), ('icu', '0', '67.1', '1.ph4', 'x86_64'), ('iproute2', '0', '5.8.0', '1.ph4', 'x86_64'), ('iptables', '0', '1.8.4', '1.ph4', 'x86_64'), ('iputils', '0', '20200821', '1.ph4', 'x86_64'), ('json-c', '0', '0.15', '2.ph4', 'x86_64'), ('json-glib', '0', '1.6.0', '1.ph4', 'x86_64'), ('kmod', '0', '27', '1.ph4', 'x86_64'), ('krb5', '0', '1.17', '4.ph4', 'x86_64'), ('libacl', '0', '2.2.53', '1.ph4', 'x86_64'), ('libarchive', '0', '3.4.3', '3.ph4', 'x86_64'), ('libassuan', '0', '2.5.3', '1.ph4', 'x86_64'), ('libcap', '0', '2.43', '1.ph4', 'x86_64'), ('libcap-ng', '0', '0.8', '1.ph4', 'x86_64'), ('libdb', '0', '5.3.28', '2.ph4', 'x86_64'), ('libdnet', '0', '1.11', '7.ph4', 'x86_64'), ('libffi', '0', '3.3', '1.ph4', 'x86_64'), ('libgcc', '0', '8.4.0', '1.ph4', 'x86_64'), ('libgcrypt', '0', '1.8.6', '2.ph4', 'x86_64'), ('libgpg-error', '0', '1.39', '1.ph4', 'x86_64'), ('libgpg-error-devel', '0', '1.39', '1.ph4', 'x86_64'), ('libksba', '0', '1.4.0', '1.ph4', 'x86_64'), ('libltdl', '0', '2.4.6', '3.ph4', 'x86_64'), ('libmetalink', '0', '0.1.3', '2.ph4', 'x86_64'), ('libmicrohttpd', '0', '0.9.71', '2.ph4', 'x86_64'), ('libmodulemd', '0', '2.9.4', '1.ph4', 'x86_64'), ('libmspack', '0', '0.10.1alpha', '1.ph4', 'x86_64'), ('libnsl', '0', '1.3.0', '1.ph4', 'x86_64'), ('libpsl', '0', '0.21.1', '1.ph4', 'x86_64'), ('libpwquality', '0', '1.4.2', '1.ph4', 'x86_64'), ('librepo', '0', '1.12.1', '3.ph4', 'x86_64'), ('libseccomp', '0', '2.5.0', '2.ph4', 'x86_64'), ('libselinux', '0', '3.1', '1.ph4', 'x86_64'), ('libsemanage', '0', '3.1', '1.ph4', 'x86_64'), ('libsepol', '0', '3.1', '1.ph4', 'x86_64'), ('libsolv', '0', '0.6.35', '5.ph4', 'x86_64'), ('libsoup', '0', '2.72.0', '1.ph4', 'x86_64'), ('libssh2', '0', '1.9.0', '2.ph4', 'x86_64'), ('libstdc++', '0', '8.4.0', '1.ph4', 'x86_64'), ('libtasn1', '0', '4.14', '1.ph4', 'x86_64'), ('libtirpc', '0', '1.2.6', '1.ph4', 'x86_64'), ('libtool', '0', '2.4.6', '3.ph4', 'x86_64'), ('libunistring', '0', '0.9.10', '1.ph4', 'x86_64'), ('libxml2', '0', '2.9.10', '3.ph4', 'x86_64'), ('libxml2-devel', '0', '2.9.10', '3.ph4', 'x86_64'), ('libxslt', '0', '1.1.34', '1.ph4', 'x86_64'), ('libyaml', '0', '0.2.5', '1.ph4', 'x86_64'), ('linux', '0', '5.9.0', '3.ph4', 'x86_64'), ('lua', '0', '5.3.5', '1.ph4', 'x86_64'), ('lz4', '0', '1.9.2', '1.ph4', 'x86_64'), ('m4', '0', '1.4.18', '3.ph4', 'x86_64'), ('motd', '0', '0.1.3', '6.ph4', 'noarch'), ('mozjs', '0', '78.3.1', '1.ph4', 'x86_64'), ('mpfr', '0', '4.1.0', '1.ph4', 'x86_64'), ('ncurses', '0', '6.2', '2.ph4', 'x86_64'), ('ncurses-libs', '0', '6.2', '2.ph4', 'x86_64'), ('ncurses-terminfo', '0', '6.2', '2.ph4', 'x86_64'), ('net-tools', '0', '1.60', '12.ph4', 'x86_64'), ('nettle', '0', '3.6', '1.ph4', 'x86_64'), ('npth', '0', '1.6', '1.ph4', 'x86_64'), ('nspr', '0', '4.29', '1.ph4', 'x86_64'), ('nss', '0', '3.57', '1.ph4', 'x86_64'), ('nss-altfiles', '0', '2.23.0', '1.ph4', 'x86_64'), ('nss-libs', '0', '3.57', '1.ph4', 'x86_64'), ('open-vm-tools', '0', '11.1.5', '4.ph4', 'x86_64'), ('openldap', '0', '2.4.53', '2.ph4', 'x86_64'), ('openssh', '0', '8.4p1', '2.ph4', 'x86_64'), ('openssh-clients', '0', '8.4p1', '2.ph4', 'x86_64'), ('openssh-server', '0', '8.4p1', '2.ph4', 'x86_64'), ('openssl', '0', '1.1.1g', '3.ph4', 'x86_64'), ('ostree', '0', '2020.6', '1.ph4', 'x86_64'), ('ostree-grub2', '0', '2020.6', '1.ph4', 'x86_64'), ('ostree-libs', '0', '2020.6', '1.ph4', 'x86_64'), ('pcre', '0', '8.44', '1.ph4', 'x86_64'), ('pcre-libs', '0', '8.44', '1.ph4', 'x86_64'), ('photon-release', '0', '4.0', '1.ph4', 'noarch'), ('photon-repos', '0', '4.0', '1.ph4', 'noarch'), ('pinentry', '0', '1.1.0', '1.ph4', 'x86_64'), ('pkg-config', '0', '0.29.2', '3.ph4', 'x86_64'), ('policycoreutils', '0', '3.1', '1.ph4', 'x86_64'), ('polkit', '0', '0.118', '1.ph4', 'x86_64'), ('popt', '0', '1.16', '5.ph4', 'x86_64'), ('procps-ng', '0', '3.3.16', '1.ph4', 'x86_64'), ('python3', '0', '3.8.6', '1.ph4', 'x86_64'), ('python3-PyYAML', '0', '5.3.1', '1.ph4', 'x86_64'), ('python3-asn1crypto', '0', '1.4.0', '1.ph4', 'noarch'), ('python3-attrs', '0', '20.2.0', '2.ph4', 'noarch'), ('python3-certifi', '0', '2020.6.20', '1.ph4', 'noarch'), ('python3-cffi', '0', '1.14.3', '2.ph4', 'x86_64'), ('python3-chardet', '0', '3.0.4', '2.ph4', 'noarch'), ('python3-configobj', '0', '5.0.6', '5.ph4', 'noarch'), ('python3-cryptography', '0', '3.1.1', '2.ph4', 'x86_64'), ('python3-gobject-introspection', '0', '1.66.0', '1.ph4', 'x86_64'), ('python3-idna', '0', '2.10', '1.ph4', 'noarch'), ('python3-jinja2', '0', '2.11.2', '1.ph4', 'noarch'), ('python3-jsonpatch', '0', '1.26', '1.ph4', 'noarch'), ('python3-jsonpointer', '0', '2.0', '2.ph4', 'noarch'), ('python3-jsonschema', '0', '3.2.0', '1.ph4', 'noarch'), ('python3-libs', '0', '3.8.6', '1.ph4', 'x86_64'), ('python3-markupsafe', '0', '1.1.1', '1.ph4', 'x86_64'), ('python3-netifaces', '0', '0.10.9', '2.ph4', 'x86_64'), ('python3-oauthlib', '0', '3.1.0', '1.ph4', 'noarch'), ('python3-packaging', '0', '20.4', '2.ph4', 'noarch'), ('python3-prettytable', '0', '0.7.2', '7.ph4', 'noarch'), ('python3-pyOpenSSL', '0', '19.1.0', '2.ph4', 'noarch'), ('python3-pyasn1', '0', '0.4.8', '1.ph4', 'noarch'), ('python3-pycparser', '0', '2.20', '1.ph4', 'noarch'), ('python3-pyparsing', '0', '2.4.7', '1.ph4', 'noarch'), ('python3-pyrsistent', '0', '0.17.3', '1.ph4', 'x86_64'), ('python3-requests', '0', '2.24.0', '1.ph4', 'noarch'), ('python3-setuptools', '0', '3.8.6', '1.ph4', 'noarch'), ('python3-six', '0', '1.15.0', '2.ph4', 'noarch'), ('python3-urllib3', '0', '1.25.10', '2.ph4', 'noarch'), ('python3-xml', '0', '3.8.6', '1.ph4', 'x86_64'), ('readline', '0', '7.0', '3.ph4', 'x86_64'), ('rpcsvc-proto', '0', '1.4.2', '1.ph4', 'x86_64'), ('rpm', '0', '4.14.2', '11.ph4', 'x86_64'), ('rpm-libs', '0', '4.14.2', '11.ph4', 'x86_64'), ('rpm-ostree', '0', '2020.5', '4.ph4', 'x86_64'), ('sed', '0', '4.8', '1.ph4', 'x86_64'), ('selinux-policy', '0', '3.14.7', '1.ph4', 'noarch'), ('shadow', '0', '4.8.1', '2.ph4', 'x86_64'), ('shadow-tools', '0', '4.8.1', '2.ph4', 'x86_64'), ('shim-signed', '0', '15', '1.ph4', 'x86_64'), ('sqlite-libs', '0', '3.33.0', '1.ph4', 'x86_64'), ('sudo', '0', '1.8.30', '2.ph4', 'x86_64'), ('systemd', '0', '245.5', '3.ph4', 'x86_64'), ('tcp_wrappers', '0', '7.6', '7.ph4', 'x86_64'), ('tzdata', '0', '2020a', '1.ph4', 'noarch'), ('util-linux', '0', '2.36', '1.ph4', 'x86_64'), ('util-linux-libs', '0', '2.36', '1.ph4', 'x86_64'), ('vim', '0', '8.2.1361', '1.ph4', 'x86_64'), ('which', '0', '2.21', '6.ph4', 'x86_64'), ('xmlsec1', '0', '1.2.30', '3.ph4', 'x86_64'), ('xz', '0', '5.2.5', '1.ph4', 'x86_64'), ('xz-libs', '0', '5.2.5', '1.ph4', 'x86_64'), ('zchunk', '0', '1.1.7', '1.ph4', 'x86_64'), ('zchunk-libs', '0', '1.1.7', '1.ph4', 'x86_64'), ('zlib', '0', '1.2.11', '2.ph4', 'x86_64'), ('zstd', '0', '1.4.5', '2.ph4', 'x86_64'), ('zstd-libs', '0', '1.4.5', '2.ph4', 'x86_64')]&gt;}, @ay [], @a(say) [], '', '', uint64 1604456507, [byte 0xca, 0x99, 0x35, 0xe5, 0xaa, 0xc6, 0xbd, 0xb3, 0x52, 0xb4, 0x81, 0x62, 0xbb, 0x3f, 0xba, 0x44, 0x0e, 0x3c, 0xa0, 0x00, 0xc8, 0x6f, 0x7c, 0x32, 0xa0, 0xa0, 0x8b, 0xc6, 0xf0, 0xd5, 0x06, 0x0e], [byte 0x44, 0x6a, 0x0e, 0xf1, 0x1b, 0x7c, 0xc1, 0x67, 0xf3, 0xb6, 0x03, 0xe5, 0x85, 0xc7, 0xee, 0xee, 0xb6, 0x75, 0xfa, 0xa4, 0x12, 0xd5, 0xec, 0x73, 0xf6, 0x29, 0x88, 0xeb, 0x0b, 0x6c, 0x54, 0x88])
</code></pre><h2 id=listing-file-mappings>Listing file mappings</h2><p>This command lists the file relations between the original source Linux Photon filetree and the deployed filetree. The normal columns include file type type (regular file, directory, link), permissions in chmod octal format, userID, groupID, file size, file name.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree ls photon/4.0/x86_64/minimal
d00755 0 0  0 /
l00777 0 0  0 /bin -&gt; usr/bin
l00777 0 0  0 /home -&gt; var/home
l00777 0 0  0 /lib -&gt; usr/lib
l00777 0 0  0 /lib64 -&gt; usr/lib
l00777 0 0  0 /media -&gt; run/media
l00777 0 0  0 /mnt -&gt; var/mnt
l00777 0 0  0 /opt -&gt; var/opt
l00777 0 0  0 /ostree -&gt; sysroot/ostree
l00777 0 0  0 /root -&gt; var/roothome
l00777 0 0  0 /sbin -&gt; usr/sbin
l00777 0 0  0 /srv -&gt; var/srv
l00777 0 0  0 /tmp -&gt; sysroot/tmp
d00755 0 0  0 /boot
d00755 0 0  0 /dev
d00755 0 0  0 /proc
d00755 0 0  0 /run
d00755 0 0  0 /sys
d00755 0 0  0 /sysroot
d00755 0 0  0 /usr
d00755 0 0  0 /var
</code></pre><p>Extra columns can be added like checksum (-C) and extended attributes (-X).</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree ls photon/4.0/x86_64/minimal -C
d00755 0 0  0 ca9935e5aac6bdb352b48162bb3fba440e3ca000c86f7c32a0a08bc6f0d5060e 446a0ef11b7cc167f3b603e585c7eeeeb675faa412d5ec73f62988eb0b6c5488 /
l00777 0 0  0 389846c2702216e1367c8dfb68326a6b93ccf5703c89c93979052a9bf359608e /bin -&gt; usr/bin
l00777 0 0  0 4344c10bf4931483f918496534f12ed9b50dc6a2cead35e3cd9dd898d6ac9414 /home -&gt; var/home
l00777 0 0  0 f11902ca9d69a80df33918534a3e443251fd0aa7f94b76301e1f55e52aed29dd /lib -&gt; usr/lib
l00777 0 0  0 f11902ca9d69a80df33918534a3e443251fd0aa7f94b76301e1f55e52aed29dd /lib64 -&gt; usr/lib
l00777 0 0  0 75317a3df11447c470ffdd63dde045450ca97dfb2a97a0f3f6a21a5da66f737c /media -&gt; run/media
l00777 0 0  0 97c55dbe24e8f3aecfd3f3e5b3f44646fccbb39799807d37a217e9c871da108b /mnt -&gt; var/mnt
l00777 0 0  0 46b1abbd27a846a9257a8d8c9fc4b384ac0888bdb8ac0d6a2d5de72715bd5092 /opt -&gt; var/opt
l00777 0 0  0 d37269e3f46023fd0275212473e07011894cdf4148cbf3fb5758a7e9471dad8e /ostree -&gt; sysroot/ostree
l00777 0 0  0 6f800e74eed172661278d1e1f09e389a6504dcd3358618e1c1618f91f9d33601 /root -&gt; var/roothome
l00777 0 0  0 e0bead7be9323b06bea05cb9b66eb151839989e3a4e5d1a93e09a36919e91818 /sbin -&gt; usr/sbin
l00777 0 0  0 5d4250bba1ed300f793fa9769474351ee5cebd71e8339078af7ebfbe6256d9b5 /srv -&gt; var/srv
l00777 0 0  0 364fbd62f91ca1e06eb7dbd50c93de8976f2cea633658e2dbe803ce6f7490c09 /tmp -&gt; sysroot/tmp
d00755 0 0  0 6e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d 446a0ef11b7cc167f3b603e585c7eeeeb675faa412d5ec73f62988eb0b6c5488 /boot
d00755 0 0  0 6e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d 446a0ef11b7cc167f3b603e585c7eeeeb675faa412d5ec73f62988eb0b6c5488 /dev
d00755 0 0  0 6e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d 446a0ef11b7cc167f3b603e585c7eeeeb675faa412d5ec73f62988eb0b6c5488 /proc
d00755 0 0  0 6e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d 446a0ef11b7cc167f3b603e585c7eeeeb675faa412d5ec73f62988eb0b6c5488 /run
d00755 0 0  0 6e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d 446a0ef11b7cc167f3b603e585c7eeeeb675faa412d5ec73f62988eb0b6c5488 /sys
d00755 0 0  0 6e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d 446a0ef11b7cc167f3b603e585c7eeeeb675faa412d5ec73f62988eb0b6c5488 /sysroot
d00755 0 0  0 83902b1171980665a74c9ea4d3817add50e9fd3279d3ee92381fb2c0098f7ab0 446a0ef11b7cc167f3b603e585c7eeeeb675faa412d5ec73f62988eb0b6c5488 /usr
d00755 0 0  0 a3a987e053ea5a116f1e75a31cd7557fc6e57a3ae09e64171d7fea17ef71ec3e 446a0ef11b7cc167f3b603e585c7eeeeb675faa412d5ec73f62988eb0b6c5488 /var
</code></pre><p>By default, only the top folders are listed, but -R will list recursively. Instead of listing over 10,000 files, let&rsquo;s filter to just all files that contain &lsquo;rpm-ostree&rsquo;, &lsquo;rpmostree&rsquo; or &lsquo;RpmOstree&rsquo;, that must belong to <strong>rpm-ostree</strong> package itself.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree ls photon/4.0/x86_64/minimal -R | grep -e '[Rr]pm-\?[Oo]stree'
-00755 0 0 787208 /usr/bin/rpm-ostree
d00755 0 0  0 /usr/bin/rpm-ostree-host
-00644 0 0   1069 /usr/bin/rpm-ostree-host/function.inc
-00755 0 0  10507 /usr/bin/rpm-ostree-host/mk-ostree-host.sh
d00755 0 0  0 /usr/bin/rpm-ostree-server
-00755 0 0   6452 /usr/bin/rpm-ostree-server/mkostreerepo
-00644 0 0209 /usr/etc/rpm-ostreed.conf
l00777 0 0  0 /usr/lib/librpmostree-1.so.1 -&gt; librpmostree-1.so.1.0.0
-00755 0 0 9878248 /usr/lib/librpmostree-1.so.1.0.0
-00644 0 0   2312 /usr/lib/girepository-1.0/RpmOstree-1.0.typelib
-00755 0 0 22 /usr/lib/kernel/install.d/00-rpmostree-skip.install
d00755 0 0  0 /usr/lib/rpm-ostree
-00755 0 0 1846216 /usr/lib/rpm-ostree/libdnf.so.2
-00644 0 0622 /usr/lib/rpm-ostree/rpm-ostree-0-integration.conf
d00755 0 0  0 /usr/lib/sysimage/rpm-ostree-base-db
-00644 0 0 1069056 /usr/lib/sysimage/rpm-ostree-base-db/Basenames
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Conflictname
-00644 0 0 159744 /usr/lib/sysimage/rpm-ostree-base-db/Dirnames
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Enhancename
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Filetriggername
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Group
-00644 0 0  12288 /usr/lib/sysimage/rpm-ostree-base-db/Installtid
-00644 0 0  16384 /usr/lib/sysimage/rpm-ostree-base-db/Name
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Obsoletename
-00644 0 0 4313088 /usr/lib/sysimage/rpm-ostree-base-db/Packages
-00644 0 0 102400 /usr/lib/sysimage/rpm-ostree-base-db/Providename
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Recommendname
-00644 0 0 106496 /usr/lib/sysimage/rpm-ostree-base-db/Requirename
-00644 0 0  24576 /usr/lib/sysimage/rpm-ostree-base-db/Sha1header
-00644 0 0  16384 /usr/lib/sysimage/rpm-ostree-base-db/Sigmd5
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Suggestname
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Supplementname
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Transfiletriggername
-00644 0 0   8192 /usr/lib/sysimage/rpm-ostree-base-db/Triggername
-00644 0 0263 /usr/lib/systemd/system/rpm-ostree-bootstatus.service
-00644 0 0257 /usr/lib/systemd/system/rpm-ostreed-automatic.service
-00644 0 0227 /usr/lib/systemd/system/rpm-ostreed-automatic.timer
-00644 0 0325 /usr/lib/systemd/system/rpm-ostreed.service
-00644 0 0102 /usr/lib/systemd/system-preset/40-rpm-ostree-auto.preset
-00644 0 0622 /usr/lib/tmpfiles.d/rpm-ostree-0-integration.conf
-00644 0 0   1572 /usr/lib/tmpfiles.d/rpm-ostree-1-autovar.conf
-00755 0 0 53 /usr/libexec/rpm-ostreed
-00644 0 0   3049 /usr/share/bash-completion/completions/rpm-ostree
-00644 0 0  17210 /usr/share/dbus-1/interfaces/org.projectatomic.rpmostree1.xml
-00644 0 0133 /usr/share/dbus-1/system-services/org.projectatomic.rpmostree1.service
-00644 0 0   1530 /usr/share/dbus-1/system.d/org.projectatomic.rpmostree1.conf
-00644 0 0   6593 /usr/share/polkit-1/actions/org.projectatomic.rpmostree1.policy
d00755 0 0  0 /usr/share/rpm-ostree
-00644 0 0   1199 /usr/share/rpm-ostree/treefile.json
</code></pre><p><strong>atomic</strong> is really an alias for rpm-ostree command. The last file <strong>treefile.json</strong> is not installed by the rpm-ostree package, it is actually downloaded from the server, as we will see in the next chapter. For now, let us notice <strong>&ldquo;osname&rdquo; : &ldquo;photon&rdquo;, &ldquo;ref&rdquo; : &ldquo;photon/1.0/x86_64/minimal&rdquo;, &ldquo;automatic_version_prefix&rdquo; : &ldquo;1.0_minimal&rdquo;</strong>, that matches what we have known so far, and also the <strong>&ldquo;documentation&rdquo; : false</strong> setting, that explains why there are no manual files installed for rpm-ostree, and in fact for any package.</p><pre><code class=language-console data-lang=console>root@photon-host [ /usr/share/rpm-ostree ]# ls -l /usr/share/man/man1 
total 0
</code></pre><h2 id=listing-configuration-changes>Listing configuration changes</h2><p>To diff the current /etc configuration versus default /etc (from the base image), this command will show the <strong>M</strong>odified, <strong>A</strong>dded and <strong>D</strong>eleted files:</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree admin config-diff
M  ssh/sshd_config
M  udev/hwdb.bin
M  fstab
M  machine-id
M  gshadow
M  hosts
M  shadow
A  ssh/ssh_host_rsa_key
A  ssh/ssh_host_rsa_key.pub
A  ssh/ssh_host_dsa_key
A  ssh/ssh_host_dsa_key.pub
A  ssh/ssh_host_ecdsa_key
A  ssh/ssh_host_ecdsa_key.pub
A  ssh/ssh_host_ed25519_key
A  ssh/ssh_host_ed25519_key.pub
A  hostname
A  group-
A  locale.conf
A  .pwd.lock
A  gshadow-
A  shadow-
A  resolv.conf
A  .updated
</code></pre><h2 id=listing-packages>Listing packages</h2><p>The following is the rpm-ostree command that lists all the packages for that branch, extracted from RPM database.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree db list photon/4.0/x86_64/minimal
    ostree commit: photon/4.0/x86_64/minimal (820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88)
     Linux-PAM-1.4.0-2.ph4.x86_64
     attr-2.4.48-1.ph4.x86_64
     audit-2.8.5-3.ph4.x86_64
     autogen-libopts-5.18.16-3.ph4.x86_64
     bash-5.0-1.ph4.x86_64
     bc-1.07.1-4.ph4.x86_64
     bridge-utils-1.6-1.ph4.x86_64
     bubblewrap-0.4.1-1.ph4.x86_64
     bzip2-1.0.8-3.ph4.x86_64
     bzip2-libs-1.0.8-3.ph4.x86_64
     ca-certificates-20201001-1.ph4.x86_64
     ca-certificates-pki-20201001-1.ph4.x86_64
     cloud-init-20.3-2.ph4.noarch
     coreutils-selinux-8.32-2.ph4.x86_64
     cpio-2.13-1.ph4.x86_64
     cracklib-2.9.7-1.ph4.x86_64
     cracklib-dicts-2.9.7-1.ph4.x86_64
     curl-7.72.0-2.ph4.x86_64
     curl-libs-7.72.0-2.ph4.x86_64
     cyrus-sasl-2.1.27-3.ph4.x86_64
     dbus-1.13.18-1.ph4.x86_64
     device-mapper-2.03.10-2.ph4.x86_64
     device-mapper-libs-2.03.10-2.ph4.x86_64
     dhcp-client-4.4.2-1.ph4.x86_64
     dhcp-libs-4.4.2-1.ph4.x86_64
     dracut-050-5.ph4.x86_64
     dracut-tools-050-5.ph4.x86_64
     e2fsprogs-1.45.6-2.ph4.x86_64
     e2fsprogs-libs-1.45.6-2.ph4.x86_64
     elfutils-0.181-2.ph4.x86_64
     elfutils-libelf-0.181-2.ph4.x86_64
     expat-2.2.9-2.ph4.x86_64
     expat-libs-2.2.9-2.ph4.x86_64
     file-5.39-1.ph4.x86_64
     file-libs-5.39-1.ph4.x86_64
     filesystem-1.1-4.ph4.x86_64
     findutils-4.7.0-1.ph4.x86_64
     finger-0.17-3.ph4.x86_64
     flex-2.6.4-3.ph4.x86_64
     fuse-2.9.9-1.ph4.x86_64
     gawk-5.1.0-1.ph4.x86_64
     gc-8.0.4-1.ph4.x86_64
     gdbm-1.18.1-1.ph4.x86_64
     glib-2.66.1-1.ph4.x86_64
     glib-networking-2.66.0-1.ph4.x86_64
     glibc-2.32-1.ph4.x86_64
     glibc-iconv-2.32-1.ph4.x86_64
     gmp-6.2.0-1.ph4.x86_64
     gnupg-2.2.23-1.ph4.x86_64
     gnutls-3.6.15-3.ph4.x86_64
     gobject-introspection-1.66.0-1.ph4.x86_64
     gpgme-1.14.0-1.ph4.x86_64
     grep-3.4-1.ph4.x86_64
     grub2-2.04-2.ph4.x86_64
     grub2-efi-2.04-2.ph4.x86_64
     grub2-efi-image-2.04-2.ph4.x86_64
     grub2-pc-2.04-2.ph4.x86_64
     grub2-theme-4.0-1.ph4.noarch
     grub2-theme-ostree-4.0-1.ph4.noarch
     guile-2.0.13-3.ph4.x86_64
     gzip-1.10-1.ph4.x86_64
     iana-etc-2.30-2.ph4.noarch
     icu-67.1-1.ph4.x86_64
     iproute2-5.8.0-1.ph4.x86_64
     iptables-1.8.4-1.ph4.x86_64
     iputils-20200821-1.ph4.x86_64
     json-c-0.15-2.ph4.x86_64
     json-glib-1.6.0-1.ph4.x86_64
     kmod-27-1.ph4.x86_64
     krb5-1.17-4.ph4.x86_64
     libacl-2.2.53-1.ph4.x86_64
     libarchive-3.4.3-3.ph4.x86_64
     libassuan-2.5.3-1.ph4.x86_64
     libcap-2.43-1.ph4.x86_64
     libcap-ng-0.8-1.ph4.x86_64
     libdb-5.3.28-2.ph4.x86_64
     libdnet-1.11-7.ph4.x86_64
     libffi-3.3-1.ph4.x86_64
     libgcc-8.4.0-1.ph4.x86_64
     libgcrypt-1.8.6-2.ph4.x86_64
     libgpg-error-1.39-1.ph4.x86_64
     libgpg-error-devel-1.39-1.ph4.x86_64
     libksba-1.4.0-1.ph4.x86_64
     libltdl-2.4.6-3.ph4.x86_64
     libmetalink-0.1.3-2.ph4.x86_64
     libmicrohttpd-0.9.71-2.ph4.x86_64
     libmodulemd-2.9.4-1.ph4.x86_64
     libmspack-0.10.1alpha-1.ph4.x86_64
     libnsl-1.3.0-1.ph4.x86_64
     libpsl-0.21.1-1.ph4.x86_64
     libpwquality-1.4.2-1.ph4.x86_64
     librepo-1.12.1-3.ph4.x86_64
     libseccomp-2.5.0-2.ph4.x86_64
     libselinux-3.1-1.ph4.x86_64
     libsemanage-3.1-1.ph4.x86_64
     libsepol-3.1-1.ph4.x86_64
     libsolv-0.6.35-5.ph4.x86_64
     libsoup-2.72.0-1.ph4.x86_64
     libssh2-1.9.0-2.ph4.x86_64
     libstdc++-8.4.0-1.ph4.x86_64
     libtasn1-4.14-1.ph4.x86_64
     libtirpc-1.2.6-1.ph4.x86_64
     libtool-2.4.6-3.ph4.x86_64
     libunistring-0.9.10-1.ph4.x86_64
     libxml2-2.9.10-3.ph4.x86_64
     libxml2-devel-2.9.10-3.ph4.x86_64
     libxslt-1.1.34-1.ph4.x86_64
     libyaml-0.2.5-1.ph4.x86_64
     linux-5.9.0-3.ph4.x86_64
     lua-5.3.5-1.ph4.x86_64
     lz4-1.9.2-1.ph4.x86_64
     m4-1.4.18-3.ph4.x86_64
     motd-0.1.3-6.ph4.noarch
     mozjs-78.3.1-1.ph4.x86_64
     mpfr-4.1.0-1.ph4.x86_64
     ncurses-6.2-2.ph4.x86_64
     ncurses-libs-6.2-2.ph4.x86_64
     ncurses-terminfo-6.2-2.ph4.x86_64
     net-tools-1.60-12.ph4.x86_64
     nettle-3.6-1.ph4.x86_64
     npth-1.6-1.ph4.x86_64
     nspr-4.29-1.ph4.x86_64
     nss-3.57-1.ph4.x86_64
     nss-altfiles-2.23.0-1.ph4.x86_64
     nss-libs-3.57-1.ph4.x86_64
     open-vm-tools-11.1.5-4.ph4.x86_64
     openldap-2.4.53-2.ph4.x86_64
     openssh-8.4p1-2.ph4.x86_64
     openssh-clients-8.4p1-2.ph4.x86_64
     openssh-server-8.4p1-2.ph4.x86_64
     openssl-1.1.1g-3.ph4.x86_64
     ostree-2020.6-1.ph4.x86_64
     ostree-grub2-2020.6-1.ph4.x86_64
     ostree-libs-2020.6-1.ph4.x86_64
     pcre-8.44-1.ph4.x86_64
     pcre-libs-8.44-1.ph4.x86_64
     photon-release-4.0-1.ph4.noarch
     photon-repos-4.0-1.ph4.noarch
     pinentry-1.1.0-1.ph4.x86_64
     pkg-config-0.29.2-3.ph4.x86_64
     policycoreutils-3.1-1.ph4.x86_64
     polkit-0.118-1.ph4.x86_64
     popt-1.16-5.ph4.x86_64
     procps-ng-3.3.16-1.ph4.x86_64
     python3-3.8.6-1.ph4.x86_64
     python3-PyYAML-5.3.1-1.ph4.x86_64
     python3-asn1crypto-1.4.0-1.ph4.noarch
     python3-attrs-20.2.0-2.ph4.noarch
     python3-certifi-2020.6.20-1.ph4.noarch
     python3-cffi-1.14.3-2.ph4.x86_64
     python3-chardet-3.0.4-2.ph4.noarch
     python3-configobj-5.0.6-5.ph4.noarch
     python3-cryptography-3.1.1-2.ph4.x86_64
     python3-gobject-introspection-1.66.0-1.ph4.x86_64
     python3-idna-2.10-1.ph4.noarch
     python3-jinja2-2.11.2-1.ph4.noarch
     python3-jsonpatch-1.26-1.ph4.noarch
     python3-jsonpointer-2.0-2.ph4.noarch
     python3-jsonschema-3.2.0-1.ph4.noarch
     python3-libs-3.8.6-1.ph4.x86_64
     python3-markupsafe-1.1.1-1.ph4.x86_64
     python3-netifaces-0.10.9-2.ph4.x86_64
     python3-oauthlib-3.1.0-1.ph4.noarch
     python3-packaging-20.4-2.ph4.noarch
     python3-prettytable-0.7.2-7.ph4.noarch
     python3-pyOpenSSL-19.1.0-2.ph4.noarch
     python3-pyasn1-0.4.8-1.ph4.noarch
     python3-pycparser-2.20-1.ph4.noarch
     python3-pyparsing-2.4.7-1.ph4.noarch
     python3-pyrsistent-0.17.3-1.ph4.x86_64
     python3-requests-2.24.0-1.ph4.noarch
     python3-setuptools-3.8.6-1.ph4.noarch
     python3-six-1.15.0-2.ph4.noarch
     python3-urllib3-1.25.10-2.ph4.noarch
     python3-xml-3.8.6-1.ph4.x86_64
     readline-7.0-3.ph4.x86_64
     rpcsvc-proto-1.4.2-1.ph4.x86_64
     rpm-4.14.2-11.ph4.x86_64
     rpm-libs-4.14.2-11.ph4.x86_64
     rpm-ostree-2020.5-4.ph4.x86_64
     sed-4.8-1.ph4.x86_64
     selinux-policy-3.14.7-1.ph4.noarch
     shadow-4.8.1-2.ph4.x86_64
     shadow-tools-4.8.1-2.ph4.x86_64
     shim-signed-15-1.ph4.x86_64
     sqlite-libs-3.33.0-1.ph4.x86_64
     sudo-1.8.30-2.ph4.x86_64
     systemd-245.5-3.ph4.x86_64
     tcp_wrappers-7.6-7.ph4.x86_64
     tzdata-2020a-1.ph4.noarch
     util-linux-2.36-1.ph4.x86_64
     util-linux-libs-2.36-1.ph4.x86_64
     vim-8.2.1361-1.ph4.x86_64
     which-2.21-6.ph4.x86_64
     xmlsec1-1.2.30-3.ph4.x86_64
     xz-5.2.5-1.ph4.x86_64
     xz-libs-5.2.5-1.ph4.x86_64
     zchunk-1.1.7-1.ph4.x86_64
     zchunk-libs-1.1.7-1.ph4.x86_64
     zlib-1.2.11-2.ph4.x86_64
     zstd-1.4.5-2.ph4.x86_64
     zstd-libs-1.4.5-2.ph4.x86_64
</code></pre><h2 id=querying-for-package-details>Querying for package details</h2><p>We are able to use the query option of rpm to make sure any package have been installed properly. The files list should match the previous file mappings in 4.2, so let&rsquo;s check package <strong>rpm-ostree</strong>. As we&rsquo;ve seen, manual files listed here are actually missing, they were not installed.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm -ql  rpm-ostree
    /etc/rpm-ostreed.conf
    /usr/bin/rpm-ostree
    /usr/bin/rpm-ostree-host
    /usr/bin/rpm-ostree-host/function.inc
    /usr/bin/rpm-ostree-host/mk-ostree-host.sh
    /usr/bin/rpm-ostree-server
    /usr/bin/rpm-ostree-server/mkostreerepo
    /usr/lib/girepository-1.0/RpmOstree-1.0.typelib
    /usr/lib/librpmostree-1.so.1
    /usr/lib/librpmostree-1.so.1.0.0
    /usr/lib/rpm-ostree
    /usr/lib/rpm-ostree/libdnf.so.2
    /usr/lib/rpm-ostree/rpm-ostree-0-integration.conf
    /usr/lib/systemd/system/rpm-ostree-bootstatus.service
    /usr/lib/systemd/system/rpm-ostreed-automatic.service
    /usr/lib/systemd/system/rpm-ostreed-automatic.timer
    /usr/lib/systemd/system/rpm-ostreed.service
    /usr/libexec/rpm-ostreed
    /usr/share/bash-completion/completions/rpm-ostree
    /usr/share/dbus-1/interfaces/org.projectatomic.rpmostree1.xml
    /usr/share/dbus-1/system-services/org.projectatomic.rpmostree1.service
    /usr/share/dbus-1/system.d/org.projectatomic.rpmostree1.conf
    /usr/share/man/man1/rpm-ostree.1.gz
    /usr/share/man/man5/rpm-ostreed.conf.5.gz
    /usr/share/man/man8/rpm-ostreed-automatic.service.8.gz
    /usr/share/man/man8/rpm-ostreed-automatic.timer.8.gz
    /usr/share/polkit-1/actions/org.projectatomic.rpmostree1.policy
</code></pre><h2 id=why-am-i-unable-to-install-upgrade-or-uninstall-packages>Why am I unable to install, upgrade or uninstall packages?</h2><p>The OSTree host installer needs the server URL or the server repository.</p><p>When you perform the installation using the repo, the install packages are located under the layer package. When you install with the URL, the packages are located under the local packages.</p><p>You can use the <code>rpm-ostree uninstall</code> command to uninstall only the layered and local packages but not the base packages. To modify the base packages, you can use the <code>rpm-ostree override</code> command.</p><p>When you run <code>rpm-ostree upgrade</code>, the command will only upgrade packages based on the commit available in the server.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-6b453783bf3141d3bc03b2e2732f3afc>5 - Host Updating Operations</h1><ul><li><a href=#upgrade-overview>Upgrade Overview</a></li><li><a href=#incremental-upgrade>Incremental upgrade</a></li><li><a href=#listing-file-differences>Listing file differences</a></li><li><a href=#listing-package-differences>Listing package differences</a></li><li><a href=#rollback>Rollback</a></li><li><a href=#installing-packages>Installing Packages</a></li><li><a href=#uninstalling-packages>Uninstalling Packages</a></li><li><a href=#deleting-a-deployed-filetree>Deleting a deployed filetree</a></li><li><a href=#version-skipping-upgrade>Version skipping upgrade</a></li><li><a href=#tracking-parent-commits>Tracking parent commits</a></li><li><a href=#resetting-a-branch-to-a-previous-commit>Resetting a branch to a previous commit</a></li></ul><h2 id=upgrade-overview>Upgrade overview</h2><p>If you&rsquo;ve used yum, dnf (and now tdnf for Photon) in RPM systems or apt-get in Debian based Unix, you understand what &ldquo;install&rdquo; is for packages and the subtle difference between &ldquo;update&rdquo; and &ldquo;upgrade&rdquo;.</p><p>OSTree and RPM-OSTree don&rsquo;t distinguish between them and the term &ldquo;upgrade&rdquo; has a slightly different meaning - to bring the system in sync with the remote repo, to the top of the Refspec (branch), just like in Git, by pulling the latest changes.</p><p>In fact, ostree and rpm-ostree commands support a single &ldquo;upgrade&rdquo; verb for a file image tree and a package list in the same refspec (branch). <code>rpm-ostree upgrade</code> will install a package if it doesn&rsquo;t exist, will not touch it if it has same version in the new image, will upgrade it if the version number is higher and it may actually downgrade it, if the package has been downgraded in the new image. I wish this operation had a different name, to avoid any confusion.</p><p>The reverse operation of an upgrade is a &ldquo;rollback&rdquo; and fortunately it&rsquo;s not named &ldquo;downgrade&rdquo; because it may upgrade packages in the last case describe above.</p><p>As we&rsquo;ll see in a future chapter, a jump to a different Refspec (branch) is also supported and it&rsquo;s named &ldquo;rebase&rdquo;.</p><h2 id=incremental-upgrade>Incremental upgrade</h2><p>To check if there are any updates available, one would execute:</p><pre><code class=language-console data-lang=console>root@photon-host-def [ ~ ]# rpm-ostree upgrade
Updating from: photon:photon/4.0/x86_64/minimal

No upgrade available.
</code></pre><p>It is good idea to check periodically for updates.</p><p>To check if there are any new updates without actually applying them, we will pass the &ndash;check-diff flag, that would list the different packages as added, modified or deleted - if such operations were to happen.</p><pre><code class=language-console data-lang=console>root@photon-host [ ~ ]# rpm-ostree upgrade --check-diff
Updating from: photon:photon/4.0/x86_64/minimal

8 metadata, 13 content objects fetched; 1026 KiB transferred in 0 seconds
+gawk-4.1.3-2.ph1.x86_64
+sudo-1.8.15-3.ph1.x86_64
+wget-1.17.1-2.ph1.x86_64
</code></pre><p>We like what we see and now let&rsquo;s upgrade for real. This command will deploy a new bootable filetree.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree upgrade --allow-downgrade
⠂ Receiving metadata objects: 0/(estimating) -/s 0 bytes... 
Receiving metadata objects: 0/(estimating) -/s 0 bytes... done
Staging deployment... done
Downgraded:
  audit 2.8.5-6.ph4 -&gt; 2.8.5-3.ph4
  cloud-init 20.4.1-1.ph4 -&gt; 20.3-2.ph4
  cpio 2.13-3.ph4 -&gt; 2.13-1.ph4
  curl 7.74.0-1.ph4 -&gt; 7.72.0-2.ph4
  curl-libs 7.74.0-1.ph4 -&gt; 7.72.0-2.ph4
  cyrus-sasl 2.1.27-4.ph4 -&gt; 2.1.27-3.ph4
  dhcp-client 4.4.2-2.ph4 -&gt; 4.4.2-1.ph4
  dhcp-libs 4.4.2-2.ph4 -&gt; 4.4.2-1.ph4
  dracut 050-7.ph4 -&gt; 050-5.ph4
  dracut-tools 050-7.ph4 -&gt; 050-5.ph4
  file 5.39-2.ph4 -&gt; 5.39-1.ph4
  file-libs 5.39-2.ph4 -&gt; 5.39-1.ph4
  gdbm 1.19-1.ph4 -&gt; 1.18.1-1.ph4
  glibc 2.32-2.ph4 -&gt; 2.32-1.ph4
  glibc-iconv 2.32-2.ph4 -&gt; 2.32-1.ph4
  gobject-introspection 1.66.0-3.ph4 -&gt; 1.66.0-1.ph4
  grub2-theme 4.0-2.ph4 -&gt; 4.0-1.ph4
  grub2-theme-ostree 4.0-2.ph4 -&gt; 4.0-1.ph4
  iproute2 5.10.0-1.ph4 -&gt; 5.8.0-1.ph4
  iptables 1.8.7-1.ph4 -&gt; 1.8.4-1.ph4
  json-c 0.15-3.ph4 -&gt; 0.15-2.ph4
  libgcc 10.2.0-1.ph4 -&gt; 8.4.0-1.ph4
  libmetalink 0.1.3-3.ph4 -&gt; 0.1.3-2.ph4
  libmodulemd 2.11.0-1.ph4 -&gt; 2.9.4-1.ph4
  librepo 1.12.1-4.ph4 -&gt; 1.12.1-3.ph4
  libsepol 3.1-2.ph4 -&gt; 3.1-1.ph4
  libsolv 0.6.35-7.ph4 -&gt; 0.6.35-5.ph4
  libssh2 1.9.0-3.ph4 -&gt; 1.9.0-2.ph4
  libstdc++ 10.2.0-1.ph4 -&gt; 8.4.0-1.ph4
  libxml2 2.9.10-6.ph4 -&gt; 2.9.10-3.ph4
  libxml2-devel 2.9.10-6.ph4 -&gt; 2.9.10-3.ph4
  libxslt 1.1.34-2.ph4 -&gt; 1.1.34-1.ph4
  linux 5.10.4-15.ph4 -&gt; 5.9.0-3.ph4
  ncurses 6.2-3.ph4 -&gt; 6.2-2.ph4
  ncurses-libs 6.2-3.ph4 -&gt; 6.2-2.ph4
  ncurses-terminfo 6.2-3.ph4 -&gt; 6.2-2.ph4
  nss 3.57-2.ph4 -&gt; 3.57-1.ph4
  nss-libs 3.57-2.ph4 -&gt; 3.57-1.ph4
  open-vm-tools 11.2.5-1.ph4 -&gt; 11.1.5-4.ph4
  openldap 2.4.53-3.ph4 -&gt; 2.4.53-2.ph4
  openssl 1.1.1i-2.ph4 -&gt; 1.1.1g-3.ph4
  pcre 8.44-2.ph4 -&gt; 8.44-1.ph4
  pcre-libs 8.44-2.ph4 -&gt; 8.44-1.ph4
  python3 3.9.1-2.ph4 -&gt; 3.8.6-1.ph4
  python3-PyYAML 5.4.1-1.ph4 -&gt; 5.3.1-1.ph4
  python3-attrs 20.3.0-2.ph4 -&gt; 20.2.0-2.ph4
  python3-cryptography 3.2.1-1.ph4 -&gt; 3.1.1-2.ph4
  python3-gobject-introspection 1.66.0-3.ph4 -&gt; 1.66.0-1.ph4
  python3-libs 3.9.1-2.ph4 -&gt; 3.8.6-1.ph4
  python3-packaging 20.4-3.ph4 -&gt; 20.4-2.ph4
  python3-pyrsistent 0.17.3-2.ph4 -&gt; 0.17.3-1.ph4
  python3-setuptools 3.9.1-2.ph4 -&gt; 3.8.6-1.ph4
  python3-urllib3 1.25.11-1.ph4 -&gt; 1.25.10-2.ph4
  python3-xml 3.9.1-2.ph4 -&gt; 3.8.6-1.ph4
  rpm 4.16.1.2-1.ph4 -&gt; 4.14.2-11.ph4
  rpm-libs 4.16.1.2-1.ph4 -&gt; 4.14.2-11.ph4
  rpm-ostree 2020.5-5.ph4 -&gt; 2020.5-4.ph4
  shadow 4.8.1-3.ph4 -&gt; 4.8.1-2.ph4
  shadow-tools 4.8.1-3.ph4 -&gt; 4.8.1-2.ph4
  sudo 1.9.5-1.ph4 -&gt; 1.8.30-2.ph4
  systemd 247.3-1.ph4 -&gt; 245.5-3.ph4
  util-linux 2.36-2.ph4 -&gt; 2.36-1.ph4
  util-linux-libs 2.36-2.ph4 -&gt; 2.36-1.ph4
Removed:
  libpcap-1.10.0-1.ph4.x86_64
  python3-Pygments-2.7.2-2.ph4.noarch
  python3-alabaster-0.7.12-1.ph4.noarch
  python3-babel-2.8.0-3.ph4.noarch
  python3-docutils-0.16-1.ph4.noarch
  python3-imagesize-1.2.0-2.ph4.noarch
  python3-pytz-2020.4-2.ph4.noarch
  python3-snowballstemmer-2.0.0-1.ph4.noarch
  python3-sphinx-3.3.0-2.ph4.noarch
  python3-sphinxcontrib-applehelp-1.0.2-1.ph4.noarch
  python3-sphinxcontrib-devhelp-1.0.2-1.ph4.noarch
  python3-sphinxcontrib-htmlhelp-1.0.3-1.ph4.noarch
  python3-sphinxcontrib-jsmath-1.0.1-1.ph4.noarch
  python3-sphinxcontrib-qthelp-1.0.3-1.ph4.noarch
  python3-sphinxcontrib-serializinghtml-1.1.4-1.ph4.noarch
  python3-typing-3.7.4.3-1.ph4.noarch
  systemd-libs-247.3-1.ph4.x86_64
  systemd-pam-247.3-1.ph4.x86_64
  systemd-rpm-macros-247.3-1.ph4.noarch
  systemd-udev-247.3-1.ph4.x86_64
Run &quot;systemctl reboot&quot; to start a reboot
</code></pre><p>By looking at the commit history, notice that the new commit has the original commit as parent.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree log photon/4.0/x86_64/minimal
commit 820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88
ContentChecksum:  c7956cedc5c1b8c07a06e10789c17364a5b7a4b970daab64f3398b7c42bd97d9
Date:  2020-11-04 02:21:47 +0000
Version: 4.0_minimal
(no subject)
</code></pre><p>Notice that now we have a new reference, that corresponds to the newly deployed image.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree refs
ostree/0/1/1
photon:photon/4.0/x86_64/minimal
ostree/0/1/0
</code></pre><p>Let us look at the status. The new filetree version .1 has the expected Commit ID and a newer timestamp, that is actually the server date/time when the image has been generated, not the time/date when it was downloaded or installed at the host. The old image has a star next to it, showing that&rsquo;s the image the system is booted currently into.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree status
State: idle
Deployments:
  ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2020-11-04T02:21:47Z)
Commit: 820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88
  Diff: 63 downgraded, 20 removed

● ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2021-02-20T07:15:43Z)
Commit: 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f
</code></pre><p>Now let&rsquo;s type <code>reboot</code>. Grub will list the new filetree as the first image, marked with a star, as the default bootable image. If the keyboard is not touched and order is not changed, grub will timeout and will boot into that image.</p><p><img src=../../../../docs/images/rpmostree-grub.png alt=Grub-dual-boot-1-0></p><p>Let&rsquo;s look again at the status. It&rsquo;s identical, just that the star is next to the newer image, to show it&rsquo;s the current image it has booted from.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree status
State: idle
Deployments:
● ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2020-11-04T02:21:47Z)
Commit: 820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88
  Diff: 63 downgraded, 20 removed

  ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2021-02-20T07:15:43Z)
Commit: 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f
</code></pre><p>Also, the current deployment directory is based on the new commit:</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree admin config-diff --print-current-dir
/ostree/deploy/photon/deploy/820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88.0
</code></pre><p>A fresh upgrade for a new version will delete the older, original image and bring a new one, that will become the new default image. The previous &lsquo;default&rsquo; image will move down one position as the backup image.</p><h2 id=listing-file-differences>Listing file differences</h2><p>Now we can look at what files have been <strong>A</strong>dded, <strong>M</strong>odified, <strong>D</strong>eleted due to the addition of those three packages and switching of the boot directories, by comparing the two commits.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree diff 820b 965c
M    /usr/bin/VGAuthService
M    /usr/bin/[
M    /usr/bin/asn1Coding
M    /usr/bin/asn1Decoding
M    /usr/bin/asn1Parser
M    /usr/bin/attr
M    /usr/bin/aulast
M    /usr/bin/aulastlog
M    /usr/bin/ausyscall
M    /usr/bin/auvirt
M    /usr/bin/b2sum
M    /usr/bin/base32
M    /usr/bin/base64
M    /usr/bin/basename
M    /usr/bin/basenc
M    /usr/bin/bash
M    /usr/bin/bc
M    /usr/bin/bootctl
M    /usr/bin/bsdcat
M    /usr/bin/bsdcpio
M    /usr/bin/bsdtar
M    /usr/bin/busctl
M    /usr/bin/bwrap
M    /usr/bin/bzip2
M    /usr/bin/bzip2recover
M    /usr/bin/cal
M    /usr/bin/captest
M    /usr/bin/cat
M    /usr/bin/certtool
M    /usr/bin/certutil
M    /usr/bin/chage
M    /usr/bin/chattr
M    /usr/bin/chcon
M    /usr/bin/chfn
M    /usr/bin/chgrp
M    /usr/bin/chmem
M    /usr/bin/chmod
M    /usr/bin/choom
M    /usr/bin/chown
M    /usr/bin/chrt
M    /usr/bin/chsh
M    /usr/bin/cksum
M    /usr/bin/clear
M    /usr/bin/cloud-id
M    /usr/bin/cloud-init
M    /usr/bin/col
M    /usr/bin/colcrt
M    /usr/bin/colrm
M    /usr/bin/column
M    /usr/bin/comm
M    /usr/bin/coredumpctl
M    /usr/bin/cp
M    /usr/bin/cpio
M    /usr/bin/csplit
M    /usr/bin/curl
M    /usr/bin/curl-config
M    /usr/bin/cut
M    /usr/bin/cvtsudoers
M    /usr/bin/date
M    /usr/bin/dbus-cleanup-sockets
M    /usr/bin/dbus-daemon
M    /usr/bin/dbus-launch
M    /usr/bin/dbus-monitor
M    /usr/bin/dbus-run-session
M    /usr/bin/dbus-send
M    /usr/bin/dbus-test-tool
M    /usr/bin/dbus-update-activation-environment
M    /usr/bin/dbus-uuidgen
M    /usr/bin/dc
M    /usr/bin/dd
M    /usr/bin/debuginfod
M    /usr/bin/debuginfod-find
M    /usr/bin/deltainfoxml2solv
M    /usr/bin/derb
M    /usr/bin/df
M    /usr/bin/dir
M    /usr/bin/dircolors
M    /usr/bin/dirmngr
M    /usr/bin/dirmngr-client
M    /usr/bin/dirname
M    /usr/bin/dmesg
M    /usr/bin/du
M    /usr/bin/dumpsexp
M    /usr/bin/dumpsolv
M    /usr/bin/echo
M    /usr/bin/eject
M    /usr/bin/env
M    /usr/bin/eu-addr2line
M    /usr/bin/eu-ar
M    /usr/bin/eu-elfclassify
M    /usr/bin/eu-elfcmp
M    /usr/bin/eu-elfcompress
M    /usr/bin/eu-elflint
M    /usr/bin/eu-findtextrel
M    /usr/bin/eu-nm
M    /usr/bin/eu-objdump
M    /usr/bin/eu-ranlib
M    /usr/bin/eu-readelf
M    /usr/bin/eu-size
M    /usr/bin/eu-stack
M    /usr/bin/eu-strings
M    /usr/bin/eu-strip
M    /usr/bin/eu-unstrip
M    /usr/bin/expand
M    /usr/bin/expiry
M    /usr/bin/expr
M    /usr/bin/factor
M    /usr/bin/faillog
M    /usr/bin/fallocate
M    /usr/bin/false
M    /usr/bin/file
M    /usr/bin/filecap
M    /usr/bin/fincore
M    /usr/bin/find
M    /usr/bin/findmnt
M    /usr/bin/finger
M    /usr/bin/flex
M    /usr/bin/flock
M    /usr/bin/fmt
M    /usr/bin/fold
M    /usr/bin/free
M    /usr/bin/fusermount
M    /usr/bin/gawk
M    /usr/bin/gawk-5.1.0
M    /usr/bin/gdbm_dump
M    /usr/bin/gdbm_load
M    /usr/bin/gdbmtool
M    /usr/bin/genbrk
M    /usr/bin/gencat
M    /usr/bin/gencfu
M    /usr/bin/gencnval
M    /usr/bin/gendict
M    /usr/bin/gendiff
M    /usr/bin/genrb
M    /usr/bin/getconf
M    /usr/bin/getent
M    /usr/bin/getfattr
M    /usr/bin/getopt
M    /usr/bin/gnutls-cli
M    /usr/bin/gnutls-cli-debug
M    /usr/bin/gnutls-serv
M    /usr/bin/gpasswd
M    /usr/bin/gpg
M    /usr/bin/gpg-agent
M    /usr/bin/gpg-connect-agent
M    /usr/bin/gpg-error
M    /usr/bin/gpg-wks-server
M    /usr/bin/gpgconf
M    /usr/bin/gpgparsemail
M    /usr/bin/gpgscm
M    /usr/bin/gpgsm
M    /usr/bin/gpgsplit
M    /usr/bin/gpgtar
M    /usr/bin/gpgv
M    /usr/bin/grep
M    /usr/bin/groups
M    /usr/bin/grub2-editenv
M    /usr/bin/grub2-file
M    /usr/bin/grub2-fstest
M    /usr/bin/grub2-glue-efi
M    /usr/bin/grub2-menulst2cfg
M    /usr/bin/grub2-mkimage
M    /usr/bin/grub2-mklayout
M    /usr/bin/grub2-mknetdir
M    /usr/bin/grub2-mkpasswd-pbkdf2
M    /usr/bin/grub2-mkrelpath
M    /usr/bin/grub2-mkrescue
M    /usr/bin/grub2-mkstandalone
M    /usr/bin/grub2-render-label
M    /usr/bin/grub2-script-check
M    /usr/bin/grub2-syslinux2cfg
M    /usr/bin/gss-client
M    /usr/bin/guile
M    /usr/bin/gzip
M    /usr/bin/hardlink
M    /usr/bin/head
M    /usr/bin/hexdump
M    /usr/bin/hmac256
M    /usr/bin/hostid
M    /usr/bin/hostname
M    /usr/bin/hostnamectl
M    /usr/bin/iconv
M    /usr/bin/icuinfo
M    /usr/bin/id
M    /usr/bin/infocmp
M    /usr/bin/install
M    /usr/bin/installcheck
M    /usr/bin/ionice
M    /usr/bin/ipcmk
M    /usr/bin/ipcrm
M    /usr/bin/ipcs
M    /usr/bin/irqtop
M    /usr/bin/isosize
M    /usr/bin/join
M    /usr/bin/journalctl
M    /usr/bin/js78
M    /usr/bin/json-glib-format
M    /usr/bin/json-glib-validate
M    /usr/bin/kadmin
M    /usr/bin/kbxutil
M    /usr/bin/kdestroy
M    /usr/bin/kernel-install
M    /usr/bin/kill
M    /usr/bin/kinit
M    /usr/bin/klist
M    /usr/bin/kmod
M    /usr/bin/kpasswd
M    /usr/bin/kswitch
M    /usr/bin/ktutil
M    /usr/bin/kvno
M    /usr/bin/last
M    /usr/bin/lastlog
M    /usr/bin/ldapcompare
M    /usr/bin/ldapdelete
M    /usr/bin/ldapexop
M    /usr/bin/ldapmodify
M    /usr/bin/ldapmodrdn
M    /usr/bin/ldappasswd
M    /usr/bin/ldapsearch
M    /usr/bin/ldapurl
M    /usr/bin/ldapwhoami
M    /usr/bin/libtool
M    /usr/bin/link
M    /usr/bin/ln
M    /usr/bin/locale
M    /usr/bin/localectl
M    /usr/bin/localedef
M    /usr/bin/locate
M    /usr/bin/logger
M    /usr/bin/login
M    /usr/bin/loginctl
M    /usr/bin/logname
M    /usr/bin/look
M    /usr/bin/ls
M    /usr/bin/lsattr
M    /usr/bin/lsblk
M    /usr/bin/lscpu
M    /usr/bin/lsipc
M    /usr/bin/lsirq
M    /usr/bin/lslocks
M    /usr/bin/lslogins
M    /usr/bin/lsmem
M    /usr/bin/lsns
M    /usr/bin/lua
M    /usr/bin/luac
M    /usr/bin/lz4
M    /usr/bin/lzmadec
M    /usr/bin/lzmainfo
M    /usr/bin/m4
M    /usr/bin/makeconv
M    /usr/bin/makedb
M    /usr/bin/mcookie
M    /usr/bin/md5sum
M    /usr/bin/mergesolv
M    /usr/bin/mesg
M    /usr/bin/mkdir
M    /usr/bin/mkfifo
M    /usr/bin/mkinitrd
M    /usr/bin/mknod
M    /usr/bin/mktemp
M    /usr/bin/modulemd-validator
M    /usr/bin/more
M    /usr/bin/mount
M    /usr/bin/mountpoint
M    /usr/bin/mpicalc
M    /usr/bin/mt
M    /usr/bin/mv
M    /usr/bin/namei
M    /usr/bin/netcap
M    /usr/bin/netstat
M    /usr/bin/nettle-hash
M    /usr/bin/nettle-lfib-stream
M    /usr/bin/nettle-pbkdf2
M    /usr/bin/networkctl
M    /usr/bin/newgidmap
M    /usr/bin/newgrp
M    /usr/bin/newrole
M    /usr/bin/newuidmap
M    /usr/bin/nice
M    /usr/bin/nl
M    /usr/bin/nohup
M    /usr/bin/nproc
M    /usr/bin/nsenter
M    /usr/bin/numfmt
M    /usr/bin/ocsptool
M    /usr/bin/od
M    /usr/bin/openssl
M    /usr/bin/ostree
M    /usr/bin/passwd
M    /usr/bin/paste
M    /usr/bin/pathchk
M    /usr/bin/pcregrep
M    /usr/bin/pcretest
M    /usr/bin/pgrep
M    /usr/bin/pidof
M    /usr/bin/pinentry-curses
M    /usr/bin/pinentry-tty
M    /usr/bin/ping
M    /usr/bin/pinky
M    /usr/bin/pk-example-frobnicate
M    /usr/bin/pk12util
M    /usr/bin/pkaction
M    /usr/bin/pkcheck
M    /usr/bin/pkcs1-conv
M    /usr/bin/pkexec
M    /usr/bin/pkg-config
M    /usr/bin/pkgdata
M    /usr/bin/pkill
M    /usr/bin/pkttyagent
M    /usr/bin/pmap
M    /usr/bin/portablectl
M    /usr/bin/pr
M    /usr/bin/printenv
M    /usr/bin/printf
M    /usr/bin/prlimit
M    /usr/bin/ps
M    /usr/bin/pscap
M    /usr/bin/psktool
M    /usr/bin/ptx
M    /usr/bin/pwd
M    /usr/bin/pwdx
M    /usr/bin/pwmake
M    /usr/bin/pwscore
M    /usr/bin/pydoc3
M    /usr/bin/python3
M    /usr/bin/readlink
M    /usr/bin/realpath
M    /usr/bin/rename
M    /usr/bin/renice
M    /usr/bin/repo2solv
M    /usr/bin/repomdxml2solv
M    /usr/bin/resolvectl
M    /usr/bin/rev
M    /usr/bin/rm
M    /usr/bin/rmdir
M    /usr/bin/rofiles-fuse
M    /usr/bin/rpcgen
M    /usr/bin/rpm
M    /usr/bin/rpm-ostree
M    /usr/bin/rpm2archive
M    /usr/bin/rpm2cpio
M    /usr/bin/rpmdb
M    /usr/bin/rpmdb2solv
M    /usr/bin/rpmgraph
M    /usr/bin/rpmkeys
M    /usr/bin/rpmmd2solv
M    /usr/bin/rpms2solv
M    /usr/bin/runcon
M    /usr/bin/sclient
M    /usr/bin/scp
M    /usr/bin/script
M    /usr/bin/scriptlive
M    /usr/bin/scriptreplay
M    /usr/bin/secon
M    /usr/bin/sed
M    /usr/bin/seq
M    /usr/bin/setarch
M    /usr/bin/setfattr
M    /usr/bin/setsid
M    /usr/bin/setterm
M    /usr/bin/sexp-conv
M    /usr/bin/sftp
M    /usr/bin/sha1sum
M    /usr/bin/sha224sum
M    /usr/bin/sha256sum
M    /usr/bin/sha384sum
M    /usr/bin/sha512sum
M    /usr/bin/shred
M    /usr/bin/shuf
M    /usr/bin/sim_client
M    /usr/bin/slabtop
M    /usr/bin/sleep
M    /usr/bin/sort
M    /usr/bin/split
M    /usr/bin/srptool
M    /usr/bin/ssh
M    /usr/bin/ssh-add
M    /usr/bin/ssh-agent
M    /usr/bin/ssh-keygen
M    /usr/bin/ssh-keyscan
M    /usr/bin/stat
M    /usr/bin/stdbuf
M    /usr/bin/stty
M    /usr/bin/su
M    /usr/bin/sudo
M    /usr/bin/sudoreplay
M    /usr/bin/sum
M    /usr/bin/sync
M    /usr/bin/systemctl
M    /usr/bin/systemd-analyze
M    /usr/bin/systemd-ask-password
M    /usr/bin/systemd-cat
M    /usr/bin/systemd-cgls
M    /usr/bin/systemd-cgtop
M    /usr/bin/systemd-delta
M    /usr/bin/systemd-detect-virt
M    /usr/bin/systemd-escape
M    /usr/bin/systemd-hwdb
M    /usr/bin/systemd-id128
M    /usr/bin/systemd-inhibit
M    /usr/bin/systemd-machine-id-setup
M    /usr/bin/systemd-mount
M    /usr/bin/systemd-notify
M    /usr/bin/systemd-path
M    /usr/bin/systemd-repart
M    /usr/bin/systemd-run
M    /usr/bin/systemd-socket-activate
M    /usr/bin/systemd-stdio-bridge
M    /usr/bin/systemd-tmpfiles
M    /usr/bin/systemd-tty-ask-password-agent
M    /usr/bin/tabs
M    /usr/bin/tac
M    /usr/bin/tail
M    /usr/bin/taskset
M    /usr/bin/tee
M    /usr/bin/test
M    /usr/bin/testsolv
M    /usr/bin/tic
M    /usr/bin/timedatectl
M    /usr/bin/timeout
M    /usr/bin/tload
M    /usr/bin/toe
M    /usr/bin/top
M    /usr/bin/touch
M    /usr/bin/tput
M    /usr/bin/tr
M    /usr/bin/tracepath
M    /usr/bin/traceroute6
M    /usr/bin/true
M    /usr/bin/truncate
M    /usr/bin/tset
M    /usr/bin/tsort
M    /usr/bin/tty
M    /usr/bin/uconv
M    /usr/bin/udevadm
M    /usr/bin/ul
M    /usr/bin/ulockmgr_server
M    /usr/bin/umount
M    /usr/bin/uname
M    /usr/bin/unexpand
M    /usr/bin/uniq
M    /usr/bin/unlink
M    /usr/bin/unshare
M    /usr/bin/unzck
M    /usr/bin/updateinfoxml2solv
M    /usr/bin/uptime
M    /usr/bin/userdbctl
M    /usr/bin/users
M    /usr/bin/utmpdump
M    /usr/bin/uuclient
M    /usr/bin/uuidgen
M    /usr/bin/uuidparse
M    /usr/bin/vdir
M    /usr/bin/vim
M    /usr/bin/vmhgfs-fuse
M    /usr/bin/vmstat
M    /usr/bin/vmtoolsd
M    /usr/bin/vmware-checkvm
M    /usr/bin/vmware-hgfsclient
M    /usr/bin/vmware-namespace-cmd
M    /usr/bin/vmware-rpctool
M    /usr/bin/vmware-toolbox-cmd
M    /usr/bin/vmware-vgauth-cmd
M    /usr/bin/vmware-vgauth-smoketest
M    /usr/bin/vmware-vmblock-fuse
M    /usr/bin/vmware-xferlogs
M    /usr/bin/w
M    /usr/bin/wall
M    /usr/bin/watch
M    /usr/bin/watchgnupg
M    /usr/bin/wc
M    /usr/bin/wdctl
M    /usr/bin/whereis
M    /usr/bin/which
M    /usr/bin/who
M    /usr/bin/whoami
M    /usr/bin/xargs
M    /usr/bin/xmlcatalog
M    /usr/bin/xmllint
M    /usr/bin/xmlsec1
M    /usr/bin/xmlwf
M    /usr/bin/xsltproc
M    /usr/bin/xz
M    /usr/bin/xzdec
M    /usr/bin/yat2m
M    /usr/bin/yes
M    /usr/bin/zck
M    /usr/bin/zck_delta_size
M    /usr/bin/zck_gen_zdict
M    /usr/bin/zck_read_header
M    /usr/bin/zckdl
M    /usr/bin/zstd
M    /usr/bin/rpm-ostree-server/mkostreerepo
M    /usr/etc/ld.so.cache
M    /usr/etc/photon-release
M    /usr/etc/shadow
M    /usr/etc/sudoers
M    /usr/etc/cloud/cloud.cfg
M    /usr/etc/iproute2/rt_protos
M    /usr/etc/pam.d/vmtoolsd
M    /usr/etc/systemd/journald.conf
M    /usr/etc/systemd/logind.conf
M    /usr/etc/systemd/networkd.conf
M    /usr/etc/systemd/resolved.conf
M    /usr/etc/systemd/system.conf
M    /usr/etc/systemd/user.conf
M    /usr/etc/udev/hwdb.bin
M    /usr/etc/udev/udev.conf
M    /usr/etc/udev/rules.d/99-vmware-hotplug.rules
M    /usr/etc/vmware-tools/tools.conf.example
M    /usr/etc/vmware-tools/vgauth.conf
M    /usr/include/sudo_plugin.h
M    /usr/lib/e2initrd_helper
M    /usr/lib/ld-2.32.so
M    /usr/lib/libBrokenLocale-2.32.so
M    /usr/lib/libDeployPkg.so.0.0.0
M    /usr/lib/libSegFault.so
M    /usr/lib/libacl.so.1.1.2253
M    /usr/lib/libanl-2.32.so
M    /usr/lib/libarchive.so.13.4.3
M    /usr/lib/libasm-0.181.so
M    /usr/lib/libassuan.so.0.8.3
M    /usr/lib/libattr.so.1.1.2448
M    /usr/lib/libaudit.so.1.0.0
M    /usr/lib/libauparse.so.0.0.0
M    /usr/lib/libblkid.so.1.1.0
M    /usr/lib/libbz2.so.1.0.8
M    /usr/lib/libc-2.32.so
M    /usr/lib/libcap-ng.so.0.0.0
M    /usr/lib/libcap.so.2.43
M    /usr/lib/libcom_err.so.2.1
M    /usr/lib/libcord.so.1.4.0
M    /usr/lib/libcrack.so.2.9.0
M    /usr/lib/libcrypt-2.32.so
M    /usr/lib/libcrypto.so.1.1
M    /usr/lib/libcurl.so.4
M    /usr/lib/libdb-5.3.so
M    /usr/lib/libdbus-1.so.3.29.0
M    /usr/lib/libdebuginfod-0.181.so
M    /usr/lib/libdevmapper.so.1.02
M    /usr/lib/libdhcp.a
M    /usr/lib/libdhcpctl.a
M    /usr/lib/libdl-2.32.so
M    /usr/lib/libdnet.1.0.1
M    /usr/lib/libdw-0.181.so
M    /usr/lib/libe2p.so.2.3
M    /usr/lib/libelf-0.181.so
M    /usr/lib/libexpat.so.1.6.11
M    /usr/lib/libexslt.so.0.8.20
M    /usr/lib/libext2fs.so.2.4
M    /usr/lib/libfdisk.so.1.1.0
M    /usr/lib/libffi.so.7.1.0
M    /usr/lib/libfl.so.2.0.0
M    /usr/lib/libformw.so.6.2
M    /usr/lib/libfreebl3.chk
M    /usr/lib/libfreebl3.so
M    /usr/lib/libfreeblpriv3.chk
M    /usr/lib/libfreeblpriv3.so
M    /usr/lib/libfuse.so.2.9.9
M    /usr/lib/libgc.so.1.4.3
M    /usr/lib/libgcc_s.so.1
M    /usr/lib/libgccpp.so.1.4.0
M    /usr/lib/libgcrypt.so.20.2.6
M    /usr/lib/libgdbm.so.6.0.0
M    /usr/lib/libgdbm_compat.so.4.0.0
M    /usr/lib/libgio-2.0.so.0.6600.1
M    /usr/lib/libgirepository-1.0.so.1.0.0
M    /usr/lib/libglib-2.0.so.0.6600.1
M    /usr/lib/libgmodule-2.0.so.0.6600.1
M    /usr/lib/libgmp.so.10.4.0
M    /usr/lib/libgnutls.so.30.28.1
M    /usr/lib/libgnutlsxx.so.28.1.0
M    /usr/lib/libgobject-2.0.so.0.6600.1
M    /usr/lib/libgpg-error.so.0.30.0
M    /usr/lib/libgpgme.so.11.23.0
M    /usr/lib/libgssapi_krb5.so.2.2
M    /usr/lib/libgssrpc.so.4.2
M    /usr/lib/libgthread-2.0.so.0.6600.1
M    /usr/lib/libguestlib.so.0.0.0
M    /usr/lib/libguile-2.0.so.22.8.1
M    /usr/lib/libguilereadline-v-18.so.18.0.0
M    /usr/lib/libhgfs.so.0.0.0
M    /usr/lib/libhistory.so.7.0
M    /usr/lib/libhogweed.so.6.0
M    /usr/lib/libicui18n.so.67.1
M    /usr/lib/libicuio.so.67.1
M    /usr/lib/libicutest.so.67.1
M    /usr/lib/libicutu.so.67.1
M    /usr/lib/libicuuc.so.67.1
M    /usr/lib/libip4tc.so.2.0.0
M    /usr/lib/libip6tc.so.2.0.0
M    /usr/lib/libipq.so.0.0.0
M    /usr/lib/libjson-c.so.5.1.0
M    /usr/lib/libjson-glib-1.0.so.0.600.0
M    /usr/lib/libk5crypto.so.3.1
M    /usr/lib/libkadm5clnt_mit.so.11.0
M    /usr/lib/libkadm5srv_mit.so.11.0
M    /usr/lib/libkdb5.so.9.0
M    /usr/lib/libkmod.so.2.3.5
M    /usr/lib/libkrad.so.0.0
M    /usr/lib/libkrb5.so.3.3
M    /usr/lib/libkrb5support.so.0.1
M    /usr/lib/libksba.so.8.12.0
M    /usr/lib/liblber-2.4.so.2.11.1
M    /usr/lib/libldap-2.4.so.2.11.1
M    /usr/lib/libldap_r-2.4.so.2.11.1
M    /usr/lib/libltdl.so.7.3.1
M    /usr/lib/liblua.so.5.3.4
M    /usr/lib/liblz4.so.1.9.2
M    /usr/lib/liblzma.so.5.2.5
M    /usr/lib/libm-2.32.so
M    /usr/lib/libmagic.so.1.0.0
M    /usr/lib/libmemusage.so
M    /usr/lib/libmenuw.so.6.2
M    /usr/lib/libmetalink.so.3.1.0
M    /usr/lib/libmicrohttpd.so.12.56.0
M    /usr/lib/libmodulemd.so.2
M    /usr/lib/libmount.so.1.1.0
M    /usr/lib/libmozjs-78.so
M    /usr/lib/libmpfr.so.6.1.0
M    /usr/lib/libmspack.so.0.1.0
M    /usr/lib/libmvec-2.32.so
M    /usr/lib/libncursesw.so.6.2
M    /usr/lib/libnettle.so.8.0
M    /usr/lib/libnpth.so.0.1.2
M    /usr/lib/libnsl-2.32.so
M    /usr/lib/libnsl.so.2.0.1
M    /usr/lib/libnspr4.so
M    /usr/lib/libnss3.so
M    /usr/lib/libnss_altfiles.so.2
M    /usr/lib/libnss_compat-2.32.so
M    /usr/lib/libnss_db-2.32.so
M    /usr/lib/libnss_dns-2.32.so
M    /usr/lib/libnss_files-2.32.so
M    /usr/lib/libnss_hesiod-2.32.so
M    /usr/lib/libnss_myhostname.so.2
M    /usr/lib/libnss_mymachines.so.2
M    /usr/lib/libnss_resolve.so.2
M    /usr/lib/libnss_systemd.so.2
M    /usr/lib/libnssckbi-testlib.so
M    /usr/lib/libnssckbi.so
M    /usr/lib/libnssdbm3.chk
M    /usr/lib/libnssdbm3.so
M    /usr/lib/libnsssysinit.so
M    /usr/lib/libnssutil3.so
M    /usr/lib/libomapi.a
M    /usr/lib/libopts.so.25.17.1
M    /usr/lib/libostree-1.so.1.0.0
M    /usr/lib/libpam.so.0.85.1
M    /usr/lib/libpam_misc.so.0.82.1
M    /usr/lib/libpamc.so.0.82.1
M    /usr/lib/libpanelw.so.6.2
M    /usr/lib/libpcre.so.1.2.12
M    /usr/lib/libpcre16.so.0.2.12
M    /usr/lib/libpcre32.so.0.0.12
M    /usr/lib/libpcrecpp.so.0.0.2
M    /usr/lib/libpcreposix.so.0.0.7
M    /usr/lib/libpkcs11testmodule.so
M    /usr/lib/libplc4.so
M    /usr/lib/libplds4.so
M    /usr/lib/libpolkit-agent-1.so.0.0.0
M    /usr/lib/libpolkit-gobject-1.so.0.0.0
M    /usr/lib/libpopt.so.0.0.0
M    /usr/lib/libprocps.so.8.0.2
M    /usr/lib/libpsl.so.5.3.3
M    /usr/lib/libpthread-2.32.so
M    /usr/lib/libpwquality.so.1.0.2
M    /usr/lib/libpython3.so
M    /usr/lib/libreadline.so.7.0
M    /usr/lib/librepo.so.0
M    /usr/lib/libresolv-2.32.so
M    /usr/lib/librpmostree-1.so.1.0.0
M    /usr/lib/librt-2.32.so
M    /usr/lib/libsasl2.so.3.0.0
M    /usr/lib/libseccomp.so.2.5.0
M    /usr/lib/libselinux.so.1
M    /usr/lib/libsemanage.so.1
M    /usr/lib/libsepol.so.1
M    /usr/lib/libsmartcols.so.1.1.0
M    /usr/lib/libsmime3.so
M    /usr/lib/libsoftokn3.chk
M    /usr/lib/libsoftokn3.so
M    /usr/lib/libsolv.so.0
M    /usr/lib/libsolvext.so.0
M    /usr/lib/libsoup-2.4.so.1.11.0
M    /usr/lib/libsoup-gnome-2.4.so.1.11.0
M    /usr/lib/libsqlite3.so.0.8.6
M    /usr/lib/libss.so.2.0
M    /usr/lib/libssh2.so.1.0.1
M    /usr/lib/libssl.so.1.1
M    /usr/lib/libssl3.so
M    /usr/lib/libstdc++.so.6
M    /usr/lib/libsystemd.so.0
M    /usr/lib/libtasn1.so.6.5.6
M    /usr/lib/libthread_db-1.0.so
M    /usr/lib/libtirpc.so.3.0.0
M    /usr/lib/libudev.so.1
M    /usr/lib/libulockmgr.so.1.0.1
M    /usr/lib/libunistring.a
M    /usr/lib/libunistring.so.2.1.0
M    /usr/lib/libutil-2.32.so
M    /usr/lib/libuuid.so.1.3.0
M    /usr/lib/libverto.so.0.0
M    /usr/lib/libvgauth.so.0.0.0
M    /usr/lib/libvmtools.so.0.0.0
M    /usr/lib/libwrap.a
M    /usr/lib/libwrap.so.0.7.6
M    /usr/lib/libxml2.so.2.9.10
M    /usr/lib/libxmlsec1-nss.so.1.2.30
M    /usr/lib/libxmlsec1-openssl.so.1.2.30
M    /usr/lib/libxmlsec1.so.1.2.30
M    /usr/lib/libxslt.so.1.1.34
M    /usr/lib/libxtables.so.12
M    /usr/lib/libyaml-0.so.2.0.9
M    /usr/lib/libz.so.1.2.11
M    /usr/lib/libzck.so.1.1.7
M    /usr/lib/libzstd.so.1.4.5
M    /usr/lib/bash/basename
M    /usr/lib/bash/dirname
M    /usr/lib/bash/fdflags
M    /usr/lib/bash/finfo
M    /usr/lib/bash/head
M    /usr/lib/bash/id
M    /usr/lib/bash/ln
M    /usr/lib/bash/logname
M    /usr/lib/bash/mkdir
M    /usr/lib/bash/mypid
M    /usr/lib/bash/pathchk
M    /usr/lib/bash/print
M    /usr/lib/bash/printenv
M    /usr/lib/bash/push
M    /usr/lib/bash/realpath
M    /usr/lib/bash/rmdir
M    /usr/lib/bash/seq
M    /usr/lib/bash/setpgid
M    /usr/lib/bash/sleep
M    /usr/lib/bash/strftime
M    /usr/lib/bash/sync
M    /usr/lib/bash/tee
M    /usr/lib/bash/truefalse
M    /usr/lib/bash/tty
M    /usr/lib/bash/uname
M    /usr/lib/bash/unlink
M    /usr/lib/bash/whoami
M    /usr/lib/cloud-init/ds-identify
M    /usr/lib/dracut/dracut-install
M    /usr/lib/dracut/dracut-version.sh
M    /usr/lib/dracut/skipcpio
M    /usr/lib/engines-1.1/afalg.so
M    /usr/lib/engines-1.1/capi.so
M    /usr/lib/engines-1.1/padlock.so
M    /usr/lib/gawk/filefuncs.so
M    /usr/lib/gawk/fnmatch.so
M    /usr/lib/gawk/fork.so
M    /usr/lib/gawk/inplace.so
M    /usr/lib/gawk/intdiv.so
M    /usr/lib/gawk/ordchr.so
M    /usr/lib/gawk/readdir.so
M    /usr/lib/gawk/readfile.so
M    /usr/lib/gawk/revoutput.so
M    /usr/lib/gawk/revtwoway.so
M    /usr/lib/gawk/rwarray.so
M    /usr/lib/gawk/time.so
M    /usr/lib/gconv/ANSI_X3.110.so
M    /usr/lib/gconv/ARMSCII-8.so
M    /usr/lib/gconv/ASMO_449.so
M    /usr/lib/gconv/BIG5.so
M    /usr/lib/gconv/BIG5HKSCS.so
M    /usr/lib/gconv/BRF.so
M    /usr/lib/gconv/CP10007.so
M    /usr/lib/gconv/CP1125.so
M    /usr/lib/gconv/CP1250.so
M    /usr/lib/gconv/CP1251.so
M    /usr/lib/gconv/CP1252.so
M    /usr/lib/gconv/CP1253.so
M    /usr/lib/gconv/CP1254.so
M    /usr/lib/gconv/CP1255.so
M    /usr/lib/gconv/CP1256.so
M    /usr/lib/gconv/CP1257.so
M    /usr/lib/gconv/CP1258.so
M    /usr/lib/gconv/CP737.so
M    /usr/lib/gconv/CP770.so
M    /usr/lib/gconv/CP771.so
M    /usr/lib/gconv/CP772.so
M    /usr/lib/gconv/CP773.so
M    /usr/lib/gconv/CP774.so
M    /usr/lib/gconv/CP775.so
M    /usr/lib/gconv/CP932.so
M    /usr/lib/gconv/CSN_369103.so
M    /usr/lib/gconv/CWI.so
M    /usr/lib/gconv/DEC-MCS.so
M    /usr/lib/gconv/EBCDIC-AT-DE-A.so
M    /usr/lib/gconv/EBCDIC-AT-DE.so
M    /usr/lib/gconv/EBCDIC-CA-FR.so
M    /usr/lib/gconv/EBCDIC-DK-NO-A.so
M    /usr/lib/gconv/EBCDIC-DK-NO.so
M    /usr/lib/gconv/EBCDIC-ES-A.so
M    /usr/lib/gconv/EBCDIC-ES-S.so
M    /usr/lib/gconv/EBCDIC-ES.so
M    /usr/lib/gconv/EBCDIC-FI-SE-A.so
M    /usr/lib/gconv/EBCDIC-FI-SE.so
M    /usr/lib/gconv/EBCDIC-FR.so
M    /usr/lib/gconv/EBCDIC-IS-FRISS.so
M    /usr/lib/gconv/EBCDIC-IT.so
M    /usr/lib/gconv/EBCDIC-PT.so
M    /usr/lib/gconv/EBCDIC-UK.so
M    /usr/lib/gconv/EBCDIC-US.so
M    /usr/lib/gconv/ECMA-CYRILLIC.so
M    /usr/lib/gconv/EUC-CN.so
M    /usr/lib/gconv/EUC-JISX0213.so
M    /usr/lib/gconv/EUC-JP-MS.so
M    /usr/lib/gconv/EUC-JP.so
M    /usr/lib/gconv/EUC-KR.so
M    /usr/lib/gconv/EUC-TW.so
M    /usr/lib/gconv/GB18030.so
M    /usr/lib/gconv/GBBIG5.so
M    /usr/lib/gconv/GBGBK.so
M    /usr/lib/gconv/GBK.so
M    /usr/lib/gconv/GEORGIAN-ACADEMY.so
M    /usr/lib/gconv/GEORGIAN-PS.so
M    /usr/lib/gconv/GOST_19768-74.so
M    /usr/lib/gconv/GREEK-CCITT.so
M    /usr/lib/gconv/GREEK7-OLD.so
M    /usr/lib/gconv/GREEK7.so
M    /usr/lib/gconv/HP-GREEK8.so
M    /usr/lib/gconv/HP-ROMAN8.so
M    /usr/lib/gconv/HP-ROMAN9.so
M    /usr/lib/gconv/HP-THAI8.so
M    /usr/lib/gconv/HP-TURKISH8.so
M    /usr/lib/gconv/IBM037.so
M    /usr/lib/gconv/IBM038.so
M    /usr/lib/gconv/IBM1004.so
M    /usr/lib/gconv/IBM1008.so
M    /usr/lib/gconv/IBM1008_420.so
M    /usr/lib/gconv/IBM1025.so
M    /usr/lib/gconv/IBM1026.so
M    /usr/lib/gconv/IBM1046.so
M    /usr/lib/gconv/IBM1047.so
M    /usr/lib/gconv/IBM1097.so
M    /usr/lib/gconv/IBM1112.so
M    /usr/lib/gconv/IBM1122.so
M    /usr/lib/gconv/IBM1123.so
M    /usr/lib/gconv/IBM1124.so
M    /usr/lib/gconv/IBM1129.so
M    /usr/lib/gconv/IBM1130.so
M    /usr/lib/gconv/IBM1132.so
M    /usr/lib/gconv/IBM1133.so
M    /usr/lib/gconv/IBM1137.so
M    /usr/lib/gconv/IBM1140.so
M    /usr/lib/gconv/IBM1141.so
M    /usr/lib/gconv/IBM1142.so
M    /usr/lib/gconv/IBM1143.so
M    /usr/lib/gconv/IBM1144.so
M    /usr/lib/gconv/IBM1145.so
M    /usr/lib/gconv/IBM1146.so
M    /usr/lib/gconv/IBM1147.so
M    /usr/lib/gconv/IBM1148.so
M    /usr/lib/gconv/IBM1149.so
M    /usr/lib/gconv/IBM1153.so
M    /usr/lib/gconv/IBM1154.so
M    /usr/lib/gconv/IBM1155.so
M    /usr/lib/gconv/IBM1156.so
M    /usr/lib/gconv/IBM1157.so
M    /usr/lib/gconv/IBM1158.so
M    /usr/lib/gconv/IBM1160.so
M    /usr/lib/gconv/IBM1161.so
M    /usr/lib/gconv/IBM1162.so
M    /usr/lib/gconv/IBM1163.so
M    /usr/lib/gconv/IBM1164.so
M    /usr/lib/gconv/IBM1166.so
M    /usr/lib/gconv/IBM1167.so
M    /usr/lib/gconv/IBM12712.so
M    /usr/lib/gconv/IBM1364.so
M    /usr/lib/gconv/IBM1371.so
M    /usr/lib/gconv/IBM1388.so
M    /usr/lib/gconv/IBM1390.so
M    /usr/lib/gconv/IBM1399.so
M    /usr/lib/gconv/IBM16804.so
M    /usr/lib/gconv/IBM256.so
M    /usr/lib/gconv/IBM273.so
M    /usr/lib/gconv/IBM274.so
M    /usr/lib/gconv/IBM275.so
M    /usr/lib/gconv/IBM277.so
M    /usr/lib/gconv/IBM278.so
M    /usr/lib/gconv/IBM280.so
M    /usr/lib/gconv/IBM281.so
M    /usr/lib/gconv/IBM284.so
M    /usr/lib/gconv/IBM285.so
M    /usr/lib/gconv/IBM290.so
M    /usr/lib/gconv/IBM297.so
M    /usr/lib/gconv/IBM420.so
M    /usr/lib/gconv/IBM423.so
M    /usr/lib/gconv/IBM424.so
M    /usr/lib/gconv/IBM437.so
M    /usr/lib/gconv/IBM4517.so
M    /usr/lib/gconv/IBM4899.so
M    /usr/lib/gconv/IBM4909.so
M    /usr/lib/gconv/IBM4971.so
M    /usr/lib/gconv/IBM500.so
M    /usr/lib/gconv/IBM5347.so
M    /usr/lib/gconv/IBM803.so
M    /usr/lib/gconv/IBM850.so
M    /usr/lib/gconv/IBM851.so
M    /usr/lib/gconv/IBM852.so
M    /usr/lib/gconv/IBM855.so
M    /usr/lib/gconv/IBM856.so
M    /usr/lib/gconv/IBM857.so
M    /usr/lib/gconv/IBM858.so
M    /usr/lib/gconv/IBM860.so
M    /usr/lib/gconv/IBM861.so
M    /usr/lib/gconv/IBM862.so
M    /usr/lib/gconv/IBM863.so
M    /usr/lib/gconv/IBM864.so
M    /usr/lib/gconv/IBM865.so
M    /usr/lib/gconv/IBM866.so
M    /usr/lib/gconv/IBM866NAV.so
M    /usr/lib/gconv/IBM868.so
M    /usr/lib/gconv/IBM869.so
M    /usr/lib/gconv/IBM870.so
M    /usr/lib/gconv/IBM871.so
M    /usr/lib/gconv/IBM874.so
M    /usr/lib/gconv/IBM875.so
M    /usr/lib/gconv/IBM880.so
M    /usr/lib/gconv/IBM891.so
M    /usr/lib/gconv/IBM901.so
M    /usr/lib/gconv/IBM902.so
M    /usr/lib/gconv/IBM903.so
M    /usr/lib/gconv/IBM9030.so
M    /usr/lib/gconv/IBM904.so
M    /usr/lib/gconv/IBM905.so
M    /usr/lib/gconv/IBM9066.so
M    /usr/lib/gconv/IBM918.so
M    /usr/lib/gconv/IBM921.so
M    /usr/lib/gconv/IBM922.so
M    /usr/lib/gconv/IBM930.so
M    /usr/lib/gconv/IBM932.so
M    /usr/lib/gconv/IBM933.so
M    /usr/lib/gconv/IBM935.so
M    /usr/lib/gconv/IBM937.so
M    /usr/lib/gconv/IBM939.so
M    /usr/lib/gconv/IBM943.so
M    /usr/lib/gconv/IBM9448.so
M    /usr/lib/gconv/IEC_P27-1.so
</code></pre><h2 id=listing-package-differences>Listing package differences</h2><p>We can also look at package differences, as you expect, using the right tool for the job.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree db diff 820b 965c
ostree diff commit from: 820b (820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88)
ostree diff commit to:   965c (965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f)
Upgraded:
audit 2.8.5-3.ph4 -&gt; 2.8.5-6.ph4
cloud-init 20.3-2.ph4 -&gt; 20.4.1-1.ph4
cpio 2.13-1.ph4 -&gt; 2.13-3.ph4
curl 7.72.0-2.ph4 -&gt; 7.74.0-1.ph4
curl-libs 7.72.0-2.ph4 -&gt; 7.74.0-1.ph4
cyrus-sasl 2.1.27-3.ph4 -&gt; 2.1.27-4.ph4
dhcp-client 4.4.2-1.ph4 -&gt; 4.4.2-2.ph4
dhcp-libs 4.4.2-1.ph4 -&gt; 4.4.2-2.ph4
dracut 050-5.ph4 -&gt; 050-7.ph4
dracut-tools 050-5.ph4 -&gt; 050-7.ph4
file 5.39-1.ph4 -&gt; 5.39-2.ph4
file-libs 5.39-1.ph4 -&gt; 5.39-2.ph4
gdbm 1.18.1-1.ph4 -&gt; 1.19-1.ph4
glibc 2.32-1.ph4 -&gt; 2.32-2.ph4
glibc-iconv 2.32-1.ph4 -&gt; 2.32-2.ph4
gobject-introspection 1.66.0-1.ph4 -&gt; 1.66.0-3.ph4
grub2-theme 4.0-1.ph4 -&gt; 4.0-2.ph4
grub2-theme-ostree 4.0-1.ph4 -&gt; 4.0-2.ph4
iproute2 5.8.0-1.ph4 -&gt; 5.10.0-1.ph4
iptables 1.8.4-1.ph4 -&gt; 1.8.7-1.ph4
json-c 0.15-2.ph4 -&gt; 0.15-3.ph4
libgcc 8.4.0-1.ph4 -&gt; 10.2.0-1.ph4
libmetalink 0.1.3-2.ph4 -&gt; 0.1.3-3.ph4
libmodulemd 2.9.4-1.ph4 -&gt; 2.11.0-1.ph4
librepo 1.12.1-3.ph4 -&gt; 1.12.1-4.ph4
libsepol 3.1-1.ph4 -&gt; 3.1-2.ph4
libsolv 0.6.35-5.ph4 -&gt; 0.6.35-7.ph4
libssh2 1.9.0-2.ph4 -&gt; 1.9.0-3.ph4
libstdc++ 8.4.0-1.ph4 -&gt; 10.2.0-1.ph4
libxml2 2.9.10-3.ph4 -&gt; 2.9.10-6.ph4
libxml2-devel 2.9.10-3.ph4 -&gt; 2.9.10-6.ph4
libxslt 1.1.34-1.ph4 -&gt; 1.1.34-2.ph4
linux 5.9.0-3.ph4 -&gt; 5.10.4-15.ph4
ncurses 6.2-2.ph4 -&gt; 6.2-3.ph4
ncurses-libs 6.2-2.ph4 -&gt; 6.2-3.ph4
ncurses-terminfo 6.2-2.ph4 -&gt; 6.2-3.ph4
nss 3.57-1.ph4 -&gt; 3.57-2.ph4
nss-libs 3.57-1.ph4 -&gt; 3.57-2.ph4
open-vm-tools 11.1.5-4.ph4 -&gt; 11.2.5-1.ph4
openldap 2.4.53-2.ph4 -&gt; 2.4.53-3.ph4
openssl 1.1.1g-3.ph4 -&gt; 1.1.1i-2.ph4
pcre 8.44-1.ph4 -&gt; 8.44-2.ph4
pcre-libs 8.44-1.ph4 -&gt; 8.44-2.ph4
python3 3.8.6-1.ph4 -&gt; 3.9.1-2.ph4
python3-PyYAML 5.3.1-1.ph4 -&gt; 5.4.1-1.ph4
python3-attrs 20.2.0-2.ph4 -&gt; 20.3.0-2.ph4
python3-cryptography 3.1.1-2.ph4 -&gt; 3.2.1-1.ph4
python3-gobject-introspection 1.66.0-1.ph4 -&gt; 1.66.0-3.ph4
python3-libs 3.8.6-1.ph4 -&gt; 3.9.1-2.ph4
python3-packaging 20.4-2.ph4 -&gt; 20.4-3.ph4
python3-pyrsistent 0.17.3-1.ph4 -&gt; 0.17.3-2.ph4
python3-setuptools 3.8.6-1.ph4 -&gt; 3.9.1-2.ph4
python3-urllib3 1.25.10-2.ph4 -&gt; 1.25.11-1.ph4
python3-xml 3.8.6-1.ph4 -&gt; 3.9.1-2.ph4
rpm 4.14.2-11.ph4 -&gt; 4.16.1.2-1.ph4
rpm-libs 4.14.2-11.ph4 -&gt; 4.16.1.2-1.ph4
rpm-ostree 2020.5-4.ph4 -&gt; 2020.5-5.ph4
shadow 4.8.1-2.ph4 -&gt; 4.8.1-3.ph4
shadow-tools 4.8.1-2.ph4 -&gt; 4.8.1-3.ph4
sudo 1.8.30-2.ph4 -&gt; 1.9.5-1.ph4
systemd 245.5-3.ph4 -&gt; 247.3-1.ph4
util-linux 2.36-1.ph4 -&gt; 2.36-2.ph4
util-linux-libs 2.36-1.ph4 -&gt; 2.36-2.ph4
Added:
libpcap-1.10.0-1.ph4.x86_64
python3-Pygments-2.7.2-2.ph4.noarch
python3-alabaster-0.7.12-1.ph4.noarch
python3-babel-2.8.0-3.ph4.noarch
python3-docutils-0.16-1.ph4.noarch
python3-imagesize-1.2.0-2.ph4.noarch
python3-pytz-2020.4-2.ph4.noarch
python3-snowballstemmer-2.0.0-1.ph4.noarch
python3-sphinx-3.3.0-2.ph4.noarch
python3-sphinxcontrib-applehelp-1.0.2-1.ph4.noarch
python3-sphinxcontrib-devhelp-1.0.2-1.ph4.noarch
python3-sphinxcontrib-htmlhelp-1.0.3-1.ph4.noarch
python3-sphinxcontrib-jsmath-1.0.1-1.ph4.noarch
python3-sphinxcontrib-qthelp-1.0.3-1.ph4.noarch
python3-sphinxcontrib-serializinghtml-1.1.4-1.ph4.noarch
python3-typing-3.7.4.3-1.ph4.noarch
systemd-libs-247.3-1.ph4.x86_64
systemd-pam-247.3-1.ph4.x86_64
systemd-rpm-macros-247.3-1.ph4.noarch
systemd-udev-247.3-1.ph4.x86_64
</code></pre><h2 id=rollback>Rollback</h2><p>If we want to go back to the previous image, we can rollback. The order of the images will be changed, so the old filetree will become the default bootable image. If -r option is passed, the rollback will continue with a reboot.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree rollback
Moving '965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f.0' to be first deployment
Transaction complete; bootconfig swap: yes; deployment count change: 0
Upgraded:
  audit 2.8.5-3.ph4 -&gt; 2.8.5-6.ph4
  cloud-init 20.3-2.ph4 -&gt; 20.4.1-1.ph4
  cpio 2.13-1.ph4 -&gt; 2.13-3.ph4
  curl 7.72.0-2.ph4 -&gt; 7.74.0-1.ph4
  curl-libs 7.72.0-2.ph4 -&gt; 7.74.0-1.ph4
  cyrus-sasl 2.1.27-3.ph4 -&gt; 2.1.27-4.ph4
  dhcp-client 4.4.2-1.ph4 -&gt; 4.4.2-2.ph4
  dhcp-libs 4.4.2-1.ph4 -&gt; 4.4.2-2.ph4
  dracut 050-5.ph4 -&gt; 050-7.ph4
  dracut-tools 050-5.ph4 -&gt; 050-7.ph4
  file 5.39-1.ph4 -&gt; 5.39-2.ph4
  file-libs 5.39-1.ph4 -&gt; 5.39-2.ph4
  gdbm 1.18.1-1.ph4 -&gt; 1.19-1.ph4
  glibc 2.32-1.ph4 -&gt; 2.32-2.ph4
  glibc-iconv 2.32-1.ph4 -&gt; 2.32-2.ph4
  gobject-introspection 1.66.0-1.ph4 -&gt; 1.66.0-3.ph4
  grub2-theme 4.0-1.ph4 -&gt; 4.0-2.ph4
  grub2-theme-ostree 4.0-1.ph4 -&gt; 4.0-2.ph4
  iproute2 5.8.0-1.ph4 -&gt; 5.10.0-1.ph4
  iptables 1.8.4-1.ph4 -&gt; 1.8.7-1.ph4
  json-c 0.15-2.ph4 -&gt; 0.15-3.ph4
  libgcc 8.4.0-1.ph4 -&gt; 10.2.0-1.ph4
  libmetalink 0.1.3-2.ph4 -&gt; 0.1.3-3.ph4
  libmodulemd 2.9.4-1.ph4 -&gt; 2.11.0-1.ph4
  librepo 1.12.1-3.ph4 -&gt; 1.12.1-4.ph4
  libsepol 3.1-1.ph4 -&gt; 3.1-2.ph4
  libsolv 0.6.35-5.ph4 -&gt; 0.6.35-7.ph4
  libssh2 1.9.0-2.ph4 -&gt; 1.9.0-3.ph4
  libstdc++ 8.4.0-1.ph4 -&gt; 10.2.0-1.ph4
  libxml2 2.9.10-3.ph4 -&gt; 2.9.10-6.ph4
  libxml2-devel 2.9.10-3.ph4 -&gt; 2.9.10-6.ph4
  libxslt 1.1.34-1.ph4 -&gt; 1.1.34-2.ph4
  linux 5.9.0-3.ph4 -&gt; 5.10.4-15.ph4
  ncurses 6.2-2.ph4 -&gt; 6.2-3.ph4
  ncurses-libs 6.2-2.ph4 -&gt; 6.2-3.ph4
  ncurses-terminfo 6.2-2.ph4 -&gt; 6.2-3.ph4
  nss 3.57-1.ph4 -&gt; 3.57-2.ph4
  nss-libs 3.57-1.ph4 -&gt; 3.57-2.ph4
  open-vm-tools 11.1.5-4.ph4 -&gt; 11.2.5-1.ph4
  openldap 2.4.53-2.ph4 -&gt; 2.4.53-3.ph4
  openssl 1.1.1g-3.ph4 -&gt; 1.1.1i-2.ph4
  pcre 8.44-1.ph4 -&gt; 8.44-2.ph4
  pcre-libs 8.44-1.ph4 -&gt; 8.44-2.ph4
  python3 3.8.6-1.ph4 -&gt; 3.9.1-2.ph4
  python3-PyYAML 5.3.1-1.ph4 -&gt; 5.4.1-1.ph4
  python3-attrs 20.2.0-2.ph4 -&gt; 20.3.0-2.ph4
  python3-cryptography 3.1.1-2.ph4 -&gt; 3.2.1-1.ph4
  python3-gobject-introspection 1.66.0-1.ph4 -&gt; 1.66.0-3.ph4
  python3-libs 3.8.6-1.ph4 -&gt; 3.9.1-2.ph4
  python3-packaging 20.4-2.ph4 -&gt; 20.4-3.ph4
  python3-pyrsistent 0.17.3-1.ph4 -&gt; 0.17.3-2.ph4
  python3-setuptools 3.8.6-1.ph4 -&gt; 3.9.1-2.ph4
  python3-urllib3 1.25.10-2.ph4 -&gt; 1.25.11-1.ph4
  python3-xml 3.8.6-1.ph4 -&gt; 3.9.1-2.ph4
  rpm 4.14.2-11.ph4 -&gt; 4.16.1.2-1.ph4
  rpm-libs 4.14.2-11.ph4 -&gt; 4.16.1.2-1.ph4
  rpm-ostree 2020.5-4.ph4 -&gt; 2020.5-5.ph4
  shadow 4.8.1-2.ph4 -&gt; 4.8.1-3.ph4
  shadow-tools 4.8.1-2.ph4 -&gt; 4.8.1-3.ph4
  sudo 1.8.30-2.ph4 -&gt; 1.9.5-1.ph4
  systemd 245.5-3.ph4 -&gt; 247.3-1.ph4
  util-linux 2.36-1.ph4 -&gt; 2.36-2.ph4
  util-linux-libs 2.36-1.ph4 -&gt; 2.36-2.ph4
Added:
  libpcap-1.10.0-1.ph4.x86_64
  python3-Pygments-2.7.2-2.ph4.noarch
  python3-alabaster-0.7.12-1.ph4.noarch
  python3-babel-2.8.0-3.ph4.noarch
  python3-docutils-0.16-1.ph4.noarch
  python3-imagesize-1.2.0-2.ph4.noarch
  python3-pytz-2020.4-2.ph4.noarch
  python3-snowballstemmer-2.0.0-1.ph4.noarch
  python3-sphinx-3.3.0-2.ph4.noarch
  python3-sphinxcontrib-applehelp-1.0.2-1.ph4.noarch
  python3-sphinxcontrib-devhelp-1.0.2-1.ph4.noarch
  python3-sphinxcontrib-htmlhelp-1.0.3-1.ph4.noarch
  python3-sphinxcontrib-jsmath-1.0.1-1.ph4.noarch
  python3-sphinxcontrib-qthelp-1.0.3-1.ph4.noarch
  python3-sphinxcontrib-serializinghtml-1.1.4-1.ph4.noarch
  python3-typing-3.7.4.3-1.ph4.noarch
  systemd-libs-247.3-1.ph4.x86_64
  systemd-pam-247.3-1.ph4.x86_64
  systemd-rpm-macros-247.3-1.ph4.noarch
  systemd-udev-247.3-1.ph4.x86_64
  Run &quot;systemctl reboot&quot; to start a reboot
</code></pre><p>In fact, we can repeat the rollback operation as many times as we want before reboot. On each execution, it&rsquo;s going to change the order. It will not delete any image.<br>However, an upgrade will keep the current default image and will eliminate the other image, whichever that is. So if Photon installation rolled back to an older build, an upgrade will keep that, eliminate the newer version and will replace it with an even newer version at the next upgrade.</p><p>The boot order moved back to original:</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree status
State: idle
Deployments:
  ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2021-02-20T07:15:43Z)
Commit: 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f
  Diff: 63 upgraded, 20 added

● ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2020-11-04T02:21:47Z)
Commit: 820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88
</code></pre><p>The current bootable image path moved also back to the original value:</p><pre><code class=language-console data-lang=console>root@photon-host-def [ ~ ]# ostree admin config-diff --print-current-dir
/ostree/deploy/photon/deploy/47899767bdd4276266383fce13c4a26a51ca0304ae754609283d75f7d8aad36e.0
</code></pre><h2 id=installing-packages>Installing Packages</h2><p>You can add more packages onto the system that are not part of the commit composed on the server.</p><pre><code class=language-console data-lang=console>rpm-ostree install &lt;packages&gt;
</code></pre><p><strong>Example</strong>:</p><pre><code class=language-console data-lang=console>rpm-ostree install https://kojipkgs.fedoraproject.org//packages/wget/1.19.5/5.fc29/x86_64/wget-1.19.5-5.fc29.x86_64.rpm
</code></pre><h2 id=uninstalling-packages>Uninstalling Packages</h2><p>To remove layered packages installed from a repository, use</p><pre><code class=language-console data-lang=console>rpm-ostree uninstall &lt;pkg&gt;
</code></pre><p>To remove layered packages installed from a local package, you must specify the full NEVRA of the package.</p><p>For example:</p><pre><code class=language-console data-lang=console>rpm-ostree uninstall ltrace-0.7.91-16.fc22.x86_64
</code></pre><p>To uninstall a package that is a part of the base layer, use</p><pre><code class=language-console data-lang=console>rpm-ostree override remove &lt;pkg&gt;
</code></pre><p>For example:</p><pre><code class=language-console data-lang=console>rpm-ostree override remove firefox
</code></pre><h2 id=deleting-a-deployed-filetree>Deleting a deployed filetree</h2><p>It is possible to delete a deployed tree. You won&rsquo;t need to do that normally, as upgrading to a new image will delete the old one, but if for some reason deploying failed (loss of power, networking issues), you&rsquo;ll want to delete the partially deployed image.<br>The only supported index is 1. (If multiple bootable images will be supported in the future, a larger than one, zero-based index of the image to delete will be supported).<br>You cannot delete the default bootable filetree, so passing 0 will result in an error.</p><pre><code class=language-console data-lang=console>root@photon-host-def [ ~ ]# ostree admin undeploy -v 1
OT: Using bootloader: OstreeBootloaderGrub2
Transaction complete; bootconfig swap: yes deployment count change: -1
Deleted deployment a31a843985e314a9e70bcf09afe8d59f7351817d9fb743c2b6dab84f20833650

root@photon-host-cus1 [ ~ ]# ostree admin undeploy -v 0
OT: Deployment cf357c0f376decb3bae42326737db7e36bcf3568ab901c33dc57800c3718f07b.0 unlocked=0
error: Cannot undeploy currently booted deployment 0
</code></pre><p>Now, we can see that the newer image is gone, the deployment directory for commit a31a has been removed.</p><pre><code class=language-console data-lang=console>root@photon-host-def [ ~ ]# rpm-ostree status
  State: idle
  AutomaticUpdates: disabled
  Deployments:
  * ostree://photon-2:photon/4.0/x86_64/minimal
      Version: 4.0_minimal (2019-09-18T12:48:03Z)
  Commit: cf357c0f376decb3bae42326737db7e36bcf3568ab901c33dc57800c3718f07b
  
  root@photon-host-cus1 [ ~ ]# ls /ostree/deploy/photon/deploy/
  cf357c0f376decb3bae42326737db7e36bcf3568ab901c33dc57800c3718f07b.0
  cf357c0f376decb3bae42326737db7e36bcf3568ab901c33dc57800c3718f07b.0.origin 
</code></pre><p>However the commit is still there in the OSTree repo.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree log 965c
  commit 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f
  ContentChecksum:  9bc85673bd8d5599d61a02a99accce9bc9b72612c7a3cebd35427875f6514288
  Date:  2021-02-20 07:15:43 +0000
  Version: 4.0_minimal
  (no subject)
</code></pre><p>But there is nothing to rollback to.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree rollback
Moving '820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88.0' to be first deployment
Transaction complete; bootconfig swap: yes; deployment count change: 0
Run &quot;systemctl reboot&quot; to start a reboot
</code></pre><p>If we were to upgrade again, it would bring these packages back, but let&rsquo;s just check the differeneces.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree upgrade --check-diff
  ⠚ Receiving metadata objects: 0/(estimating) -/s 0 bytes... 
  Receiving metadata objects: 0/(estimating) -/s 0 bytes... done
  No updates available.
</code></pre><h2 id=version-skipping-upgrade>Version skipping upgrade</h2><p>Let&rsquo;s assume that after a while, VMware releases version 2 that removes <strong>sudo</strong> and adds <strong>bison</strong> and <strong>tar</strong>. Now, an upgrade will skip version 1 and go directly to 2. Let&rsquo;s first look at what packages are pulled (notice sudo missing, as expected), then upgrade with reboot option.</p><pre><code class=language-console data-lang=console>root@photon-host-def [ ~ ]# rpm-ostree upgrade --check-diff
Updating from: photon:photon/4.0/x86_64/minimal

7 metadata, 13 content objects fetched; 1287 KiB transferred in 0 seconds
+bison-3.0.2-2.ph1.x86_64
+gawk-4.1.0-2.ph1.x86_64
+tar-1.27.1-1.ph1.x86_64
+wget-1.15-1.ph1.x86_64

root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree upgrade -r
⠒ Receiving metadata objects: 0/(estimating) -/s 0 bytes... 
Receiving metadata objects: 0/(estimating) -/s 0 bytes... done
No upgrade available.
</code></pre><p>After reboot, let&rsquo;s check the booting filetrees, the current dir for the current filetree and look at commit differences:</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree status
State: idle
Deployments:
● ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2020-11-04T02:21:47Z)
Commit: 820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88

  ostree://photon:photon/4.0/x86_64/minimal
    Version: 4.0_minimal (2021-02-20T07:15:43Z)
Commit: 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f


root@photon-7c2d910d79e9 [ ~ ]# ostree admin config-diff --print-current-dir
/ostree/deploy/photon/deploy/820b584a6f90bf6b9b8cb6aad8c093064b88d0ab686be8130baa03d68917ad88.0


root@photon-host-cus1 [ ~ ]# rpm-ostree db diff  8b4b e663
ostree diff commit old: rollback deployment (8b4b9d4ec033d1eb816711bfdda595d1013fecbe5cd340f6a619cdc9d83a3bf2)
ostree diff commit new: booted deployment (e663b2872efa01d80e4c34c823431472beb653373af32de83c7d2480316b8a6a)

root@photon-host-cus1 [ ~ ]# rpm-ostree db diff  82bc 092e
error: Refspec '82bc' not found
Interesting fact: The metadata for commit 82bc has been removed from the local repo.
</code></pre><h2 id=tracking-parent-commits>Tracking parent commits</h2><p>OSTree will display limited commit history - maximum 2 levels, so if you want to traverse the history even though it may not find a commitment by its ID, you can refer to its parent using &lsquo;^&rsquo; suffix, grandfather via &lsquo;^^&rsquo; and so on. We know that 82bc is the parent of 092e:</p><pre><code class=language-console data-lang=console>root@photon-host-def [ ~ ]# rpm-ostree db diff  092e^ 092e
  error: No such metadata object 82bca728eadb7292d568404484ad6889c3f6303600ca8c743a4336e0a10b3817.commit
  error: Refspec '82cb' not found
  root@photon-host-def [ ~ ]# rpm-ostree db diff  092e^^ 092e
  error: No such metadata object 82bca728eadb7292d568404484ad6889c3f6303600ca8c743a4336e0a10b3817.commit
</code></pre><p>So commit 092e knows who its parent is, but its metadata is no longer in the local repo, so it cannot traverse further to its parent to find an existing grandfather.</p><h2 id=resetting-a-branch-to-a-previous-commit>Resetting a branch to a previous commit</h2><p>We can reset the head of a branch in a local repo to a previous commit, for example corresponding to version 0 (3.0_minimal).</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree reset photon:photon/4.0/x86_64/minimal 965c
</code></pre><p>Now if we look again at the branch commit history, the head is at version 0.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree log photon/4.0/x86_64/minimal
commit 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f
ContentChecksum:  9bc85673bd8d5599d61a02a99accce9bc9b72612c7a3cebd35427875f6514288
Date:  2021-02-20 07:15:43 +0000
Version: 4.0_minimal
(no subject)
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-9a48799a4bec43b263b76904358449d1>6 - Creating a Server</h1><p>Photon OS 4.0 includes a <code>rpm-ostree-repo</code> package that can be installed on a VM.</p><p>This package provides an automated script that creates a repo tree that acts as a server.</p><p>Run the following commands to create a server:</p><pre><code class=language-console data-lang=console>tdnf install rpm-ostree-repo
</code></pre><p>A script is created, which provides options to create a server.</p><p>Script to create a Photon OSTree repo
Usage:<pre><code class=language-console data-lang=console>/usr/bin/rpm-ostree-server/mkostreerepo -r=&lt;repo path&gt; 
/usr/bin/rpm-ostree-server/mkostreerepo -r=&lt;repo path&gt; -p=&lt;json treefile&gt;
/usr/bin/rpm-ostree-server/mkostreerepo -c -r=&lt;repo path&gt; -p=&lt;json treefile&gt;
-r|--repopath   &lt;Provide repo path&gt; 
-p|--jsonfile   &lt;Provide Json file&gt; 
-c|--customrepo &lt;Provide custom repo file inside repo path directory&gt;
</code></pre><p><strong>Note</strong></p><ul><li>Use <code>PATH=$PATH:/usr/bin/rpm-ostree-server</code> and then use <code>mkostreerepo</code> from any directory for ease of use.</li><li><code>mkostreerepo</code> is used to create the fresh tree for ostree.</li><li><code>mkostreerepo</code> is also used to update a new commit to the existing tree.</li><li>You can also use custom repo as to create/append the tree.</li></ul><p>Run the following command to initiate the script, choose different help options to create a server.</p><pre><code class=language-console data-lang=console>mkostreerepo
</code></pre><h2 id=manually-composing-your-ostree-repo>Manually Composing your OSTree repo</h2><p>Use the following commands to initialize a new repo and to compose it.</p><pre><code class=language-console data-lang=console>root [ ~ ]# cd /srv/rpm-ostree
root [ /srv/rpm-ostree ]# ostree --repo=repo init --mode=archive-z2
root [ /srv/rpm-ostree ]# rpm-ostree compose tree --repo=repo photon-base.json
</code></pre><p>You can now deploy a host. For more information, see <a href=../../../../docs/administration-guide/photon-rpm-ostree/file-oriented-server-operations>File oriented server operations</a> and <a href=../../../../docs/administration-guide/photon-rpm-ostree/package-oriented-server-operations/>Package oriented server operations</a> to learn how to create your own customized file tree.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-51d1d7888a9d42c1f88448d4c263a998>7 - Installing a Photon RPM-OStree host against a custom server repository</h1><p>Organizations that maintain their own OSTree servers create custom image trees suited to their needs from which hosts can be deployed and upgraded. One single server may make available several branches to install, for example &ldquo;base&rdquo;, &ldquo;minimal&rdquo; and &ldquo;full&rdquo;. Or, if you think in terms of Windows OS SKUs - &ldquo;Home&rdquo;, &ldquo;Professional&rdquo; or &ldquo;Enterprise&rdquo; edition.</p><p>So in fact there are two pieces of information the OSTree host installer needs - the server URL and the branch ref. Also, there are two ways to pass this info - manually via keyboard, when prompted and automated, by reading from a config file.</p><h2 id=manual-install-of-a-custom-host>Manual install of a custom host</h2><p>Installing a Photon RPM-OSTree host that will pull from a server repository of your choice is very similar to the way we installed the host against the default server repo in <a href=../../../../docs/administration-guide/photon-rpm-ostree/installing-a-host-against-default-server-repository/>this document</a>.</p><p>We will follow the same steps, selecting &ldquo;Photon OSTree Host&rdquo;, and after assigning a host name like <strong>photon-host</strong> and a root password, this time we will click on &ldquo;Custom RPM-OSTree Server&rdquo;.</p><p><img src=../../../../docs/images/rpmostree-custom.png alt=PhotonHostCustom></p><p>An additional screen will ask for the URL of server repo - just enter the IP address or fully qualified domain name of the <a href=../../../../docs/administration-guide/photon-rpm-ostree/creating-a-rpm-ostree-server/>server installed in the previous step</a>.</p><p><img src=../../../../docs/images/rpmostree-url.png alt=PhotonHostCustomURL></p><p>Once this is done and the installation finished, reboot and you are ready to use it.
You may verify - just like in <a href=../../../../docs/administration-guide/photon-rpm-ostree/concepts-in-action/#querying-the-deployed-filetrees>this document</a> - that you can get an rpm-ostree status. The value for the CommitID should be identical to the <a href=../../../../docs/administration-guide/photon-rpm-ostree/installing-a-host-against-default-server-repository/>host that installed from default repo</a>, if the <a href=../../../../docs/administration-guide/photon-rpm-ostree/creating-a-rpm-ostree-server/>server</a> has been installed fresh, from the same ISO.</p><h2 id=automated-install-of-a-custom-host-via-kickstart>Automated install of a custom host via kickstart</h2><p>Photon supports automated install that will not interact with the user, in other words installer will display its progress, but will not prompt for any keys to be clicked, and will boot at the end of installation.</p><p>If not familiar with the way kickstart works, visit <a href=../../../../docs/user-guide/working-with-kickstart/>Kickstart Support in Photon OS</a>. The kickstart json config for OSTree is similar to minimal or full, except for these settings that should sound familiar:</p><pre><code>    ...
    &quot;type&quot;: &quot;ostree_host&quot;,
    &quot;ostree_repo_url&quot;: &quot;http://192.168.218.249&quot;,
    &quot;ostree_repo_ref&quot;: &quot;photon/4.0/x86_64/minimal&quot;,
    ...
</code></pre><p>Or, for default installation</p><pre><code>    ....
    &quot;type&quot;: &quot;ostree_host&quot;,
    &quot;default_repo&quot;: true,
    ....
</code></pre><p>If the server is a future version of Photon OS, say Photon OS 5.0, and the administrator composed trees for the included json files, the ostree_repo_ref will take either value: <strong>photon/5.0/x86_64/base</strong>, <strong>photon/5.0/x86_64/minimal</strong>, or <strong>photon/5.0/x86_64/full</strong>.</p><p>In most situations, kickstart file is accessed via http from PXE boot. That enables booting from network and end to end install of hosts from pre-defined server URL and branch without assistance from user.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d4ceeae3e03f91651df3a54320340a53>8 - Automatic Updates</h1><p>Automatic updates are disabled by default.</p><p>To verify this, run the status command.</p><pre><code>root@photon-7c2d910d79e9 [ ~ ]# rpm-ostree status 
State: idle
Deployments:
● ostree://photon:photon/4.0/x86_64/minimal
   Version: 4.0_minimal (2021-02-20T07:15:43Z)
Commit: 965c1abeb048e1a8ff77e9cd34ffccc5e3356176cda3332b4ff0e7a6c66b661f
</code></pre><h2 id=enable-automatic-updates>Enable Automatic Updates</h2><ol><li>Run the following command:</li></ol><pre><code>$ systemctl restart rpm-ostreed
</code></pre><ol><li><p>To enable automatic background updates, edit the <code>/etc/rpm-ostreed.conf</code>, and include the below lines in the <code>Daemon</code> section:</p><pre><code>[Daemon]
AutomaticUpdatePolicy=stage
#IdleExitTimeout=60
</code></pre></li><li><p>Run the following commands:</p><pre><code>$ systemctl reload rpm-ostreed
$ systemctl enable rpm-ostree-automatic.timer --now  
$ systemctl restart rpm-ostree-automatic
</code></pre></li><li><p>Verify that the automatic update feature has been enabled:</p><pre><code>$ rpm-ostree status -v 
      State: idle

      AutomaticUpdates: stage; rpm-ostreed-automatic.timer: last run 16min ago
</code></pre></li><li><p>On the server machine, perform another commit on the base tree.</p></li></ol><p>Automatic updates are now enabled and will automatically update the host system.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b7d11860a5b7ce11ea16ac719d59deb4>9 - File Oriented Server Operations</h1><p>In this section, we will checkout a filetree into a writable directory structure on disk, make several file changes and commit the changes back into the repository. Then we will download this commit and apply at the host. As you may have guessed, this chapter is mostly about OSTree - the base technology. I&rsquo;ve not mentioned anything about packages, although it is quite possible to install packages (afler all, packages are made of files, right?) and commit without the help of rpm-ostree, but it&rsquo;s too much of a headache and not worth the effort, since rpm-ostree does it simpler and better.</p><p>When would you want to do that? When you want for all your hosts to get an application or configuration customization that is not encapsulated as part of a package upgrade.</p><h2 id=starting-a-fresh-ostree-repo>Starting a fresh OSTree repo</h2><p>If you want to start fresh with your own branch and/or versioning scheme, you can delete the OSTree repo created during the Photon 3.0 RPM-OSTree server install and re-create it empty.</p><pre><code>root [ /srv/rpm-ostree ]# rm -rf repo/*

root [ /srv/rpm-ostree ]# ostree --repo=repo init --mode=archive-z2

root [ /srv/rpm-ostree ]# ls repo
config  objects  refs  state  tmp  uncompressed-objects-cache

root [ /srv/rpm-ostree ]# cat repo/config
[core]
repo_version=1
mode=archive-z2
</code></pre><h2 id=creating-summary-metadata>Creating summary metadata</h2><p>A newer ostree feature, available in Photon OS 2.0 and higher, allows the OSTree server admin to create server summary metadata, that includes among other things the list of available branches and the list of static deltas, so they could be discovered by hosts. To create a summary, run this command after you committed for your branches:</p><pre><code>root [ /srv/rpm-ostree ]# ostree summary -u &quot;This is BigData's OSTree server, it has three branches&quot;
</code></pre><p>We will find out later how the <a href=../remotes/#list-available-branches>hosts query for branches list</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-80a9484e4b01a64f6235e211efb26409>10 - Package Oriented Server Operations</h1><p>Now that we have a Photon RPM-OSTree server up and running (if not, see how to <a href=../creating-a-rpm-ostree-server/>install</a>), we will learn how to provide the desired set of packages as input and instruct rpm-ostree to compose a filetree, that will result in creation (or update) of an OSTree repo.<br>The simplest way to explain is to take a look at the files installed by the Photon RPM-OSTree server during setup.</p><pre><code class=language-console data-lang=console>root [ ~ ]# cd /srv/rpm-ostree/
root [ /srv/rpm-ostree ]# ls -l
total 16
-rw-r--r-- 1 root root 7356 Aug 28 19:06 ostree-httpd.conf
-rw-r--r-- 1 root root 1085 Aug 28 19:06 photon-base.json
lrwxrwxrwx 1 root root   35 Aug 28 19:06 photon-extras-ostree.repo -&gt; /etc/yum.repos.d/photon-extras.repo
lrwxrwxrwx 1 root root   32 Aug 28 19:06 photon-iso-ostree.repo -&gt; /etc/yum.repos.d/photon-iso.repo
lrwxrwxrwx 1 root root   28 Aug 28 19:06 photon-ostree.repo -&gt; /etc/yum.repos.d/photon.repo
lrwxrwxrwx 1 root root   36 Aug 28 19:06 photon-updates-ostree.repo -&gt; /etc/yum.repos.d/photon-updates.repo
drwxr-xr-x 7 root root 4096 Aug 20 22:27 repo
</code></pre><h2 id=json-configuration-file>JSON configuration file</h2><p>How can we tell rpm-ostree what packages we want to include, where to get them from and how to compose the filetree? There is JSON file for that. Let&rsquo;s take a look at photon-base.json used by the Photon OS team.</p><pre><code class=language-console data-lang=console>root [ /srv/rpm-ostree ]# cat photon-base.json
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;comment&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Photon Minimal OSTree&#34;</span><span style=color:#000;font-weight:700>,</span>

    <span style=color:#204a87;font-weight:700>&#34;osname&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;photon&#34;</span><span style=color:#000;font-weight:700>,</span>

    <span style=color:#204a87;font-weight:700>&#34;ref&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;photon/4.0/x86_64/minimal&#34;</span><span style=color:#000;font-weight:700>,</span>

    <span style=color:#204a87;font-weight:700>&#34;automatic_version_prefix&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;4.0_minimal&#34;</span><span style=color:#000;font-weight:700>,</span>

    <span style=color:#204a87;font-weight:700>&#34;repos&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;photon&#34;</span><span style=color:#000;font-weight:700>],</span>

    <span style=color:#204a87;font-weight:700>&#34;selinux&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>,</span>

    <span style=color:#204a87;font-weight:700>&#34;initramfs-args&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;--no-hostonly&#34;</span><span style=color:#000;font-weight:700>],</span>

    <span style=color:#204a87;font-weight:700>&#34;bootstrap_packages&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;filesystem&#34;</span><span style=color:#000;font-weight:700>],</span>

    <span style=color:#204a87;font-weight:700>&#34;documentation&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>,</span>

    <span style=color:#204a87;font-weight:700>&#34;packages&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;glibc&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;zlib&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;binutils&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;gmp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;mpfr&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;libgcc&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;libstdc++&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;libgomp&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;pkg-config&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ncurses&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;bash&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;bzip2&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;cracklib&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;cracklib-dicts&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;shadow&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;procps-ng&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;iana-etc&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;readline&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;coreutils&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;bc&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;libtool&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;net-tools&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;findutils&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;xz&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;grub2&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;grub2-pc&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;grub2-efi&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;iproute2&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;util-linux&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;linux&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;attr&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;libcap&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;kmod&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;expat&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;dbus&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;file&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;sed&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;grep&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;cpio&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;gzip&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;openssl&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ca-certificates&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;curl&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;systemd&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;openssh&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;iptables&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;photon-release&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;vim&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;photon-repos&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;docker&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;bridge-utils&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;dracut&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;dracut-tools&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;rpm-ostree&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;nss-altfiles&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;which&#34;</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>There are some mandatory settings, some optional. I&rsquo;m only going to explain the most important ones for our use case.
<strong>osname</strong> and <strong>ref</strong> should be familiar, they have been explained in previous sections <a href=../concepts-in-action/#osname>OSname</a> and <a href=../concepts-in-action#refspec>Refspec</a>. Basicaly, we are asking <code>rpm-ostree</code> to compose a tree for photon OS and photon/3.0/x86_64/minimal branch.</p><p>For more information, see the <a href=https://coreos.github.io/rpm-ostree/treefile/>OS Tree Documentation</a>.</p><h2 id=package-addition-removal-upgrade>Package addition, removal, upgrade</h2><p><strong>packages</strong> is the list of packages that are to be added, in this case, in the &ldquo;minimal&rdquo; installation profile, on top of the packages already included by default. This is not quite the identical set of RPMS you get when you select the minimal profile in the ISO installer, but it&rsquo;s pretty close and that&rsquo;s why it&rsquo;s been named the same.
Let&rsquo;s add to the list three new packages: gawk, sudo and wget using <code>vim photon-base.json</code></p><p><strong>!!!Warning: do not remove any packages from the default list, even an &ldquo;innocent&rdquo; one, as it may bring the system to an unstable condition. During my testing, I&rsquo;ve removed &ldquo;which&rdquo;; it turns out it was used to figure out the grub booting roots: on reboot, the system was left hanging at grub prompt.</strong></p><h2 id=rpms-repository>RPMS repository</h2><p>But where are these packages located? RPM-OStree uses the same standard RPMS repositories, that yum installs from.</p><pre><code class=language-console data-lang=console>root [ /srv/rpm-ostree ]# ls /etc/yum.repos.d/
photon-debuginfo.repo  photon-extras.repo  photon-iso.repo  photon-updates.repo  photon.repo
</code></pre><p>Going back to our JSON file, <strong>repos</strong> is a multi-value setting that tells RPM-OSTree in what RPMS repositories to look for packages. In this case, it looks in the current directory for a &ldquo;photon&rdquo; repo configuration file, that is a .repo file starting with a <code>[photon]</code> section. There is such a file: <strong>photon-ostree.repo</strong>, that is in fact a link to <strong>photon.repo</strong> in /etc/yum.repos.d directory.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#c4a000>root [ /srv/rpm-ostree ]# cat /etc/yum.repos.d/photon.repo </span>
<span style=color:#204a87;font-weight:700>[photon]</span>
<span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>VMware Photon Linux 4.0(x86_64)</span>
<span style=color:#c4a000>baseurl</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>https://packages.vmware.com/photon/4.0/photon_release_$releasever_$basearch</span>
<span style=color:#c4a000>gpgkey</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>file:///etc/pki/rpm-gpg/VMWARE-RPM-GPG-KEY</span>
<span style=color:#c4a000>gpgcheck</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>1</span>
<span style=color:#c4a000>enabled</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>1</span>
<span style=color:#c4a000>skip_if_unavailable</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>True</span>
</code></pre></div><p>In this case, <code>rpm-ostree</code> is instructed to download its packages in RPM format from the VMware Photon Packgaes URL, which is the location of an online RPMS repo maintained by the VMware Photon OS team. To ensure those packages can be validated as being genuine and signed by VMware, the signature is checked against the official VMware public key.</p><p>So what&rsquo;s in an RPMS repository? If we point the browser to <a href=https://packages.vmware.com/photon/photon_publish_rpms/>packages.vmware.com/photon/photon_publish_rpms/</a>, we can see there are three top directories:</p><ul><li>noarch - where all packages that don&rsquo;t depend on the architecture reside. Those may contain scripts, platform neutral source files, configuration.</li><li>x86_64 - platform dependent packages for Intel 32 and 64 bits CPUs.</li><li>repodata - internal repo management data, like a catalog of all packages, and for every package its name, id, version, architecture and full path file/directory list. There is also a compressed XML file containing the history of changelogs extracted from github, as packages in RPM format were built by Photon OS team members from sources.</li></ul><p>Fortunately, in order to compose a tree, you don&rsquo;t need to download the packages from the online repository (which is time consuming - in the order of minutes), unless there are some new ones or updated versions of them, added by the Photon team after shipping 1.0 version or the 1.0 Refresh. A copy of the starter RPMS repository (as of 1.0 shipping date) has been included on the CD-ROM and you can access it.</p><pre><code class=language-console data-lang=console>root [ /srv/rpm-ostree ]# mount /dev/cdrom
root [ /srv/rpm-ostree ]# ls /mnt/cdrom/RPMS
noarch  repodata  x86_64
</code></pre><p>All you have to do now is to replace the <code>"repos": ["photon"]</code> entry by <code>"repos": ["photon-iso"]</code>, which will point to the RPMS repo on CD-ROM, rather than the online repo. This way, composing saves time, bandwidth and reduces to zero the risk of failure because of a networking issue.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#c4a000>root [ /srv/rpm-ostree ]# cat /etc/yum.repos.d/photon-iso.repo</span>
<span style=color:#204a87;font-weight:700>[photon-iso]</span>
<span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>VMWare Photon Linux ISO 4.0(x86_64)</span>
<span style=color:#c4a000>baseurl</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>file:///mnt/cdrom/RPMS</span>
<span style=color:#c4a000>gpgkey</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>file:///etc/pki/rpm-gpg/VMWARE-RPM-GPG-KEY</span>
<span style=color:#c4a000>gpgcheck</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>1</span>
<span style=color:#c4a000>enabled</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>0</span>
<span style=color:#c4a000>skip_if_unavailable</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>True</span>
</code></pre></div><p>There are already in current directory links created to all repositories in /etc/yum.repos.d, so they are found when tree compose command is invoked. You may add any other repo to the list and include packages found in that repo to be part of the image.</p><h2 id=composing-a-tree>Composing a tree</h2><p>After so much preparation, we can execute a tree compose. We have only added 3 new packages and changed the RPMS repo source. Assuming that the JSON file is editted, run the following:</p><pre><code class=language-console data-lang=console>root [ /srv/rpm-ostree ]# rpm-ostree compose tree --repo=repo photon-base.json
Previous commit: 2940e10c4d90ce6da572cbaeeff7b511cab4a64c280bd5969333dd2fca57cfa8

Downloading metadata [=========================================================================] 100%

Transaction: 117 packages
  Linux-PAM-1.1.8-2.ph3.x86_64
  attr-2.4.47-1.ph3.x86_64
  ...
  gawk-4.1.0-2.ph3.x86_64
  ...
  sudo-1.8.11p1-4.ph3.x86_64
  ...
  wget-1.15-1.ph3.x86_64
  which-2.20-1.ph3.x86_64
  xz-5.0.5-2.ph3.x86_64
  zlib-1.2.8-2.ph3.x86_64
Installing packages [==========================================================================] 100%
Writing '/var/tmp/rpm-ostree.TVO089/rootfs.tmp/usr/share/rpm-ostree/treefile.json'
Preparing kernel
Creating empty machine-id
Executing: /usr/bin/dracut -v --tmpdir=/tmp -f /var/tmp/initramfs.img 4.0.9 --no-hostonly
...
*** Including module: bash ***
*** Including module: kernel-modules ***
*** Including module: resume ***
*** Including module: rootfs-block ***
*** Including module: terminfo ***
*** Including module: udev-rules ***
Skipping udev rule: 91-permissions.rules
Skipping udev rule: 80-drivers-modprobe.rules
*** Including module: ostree ***
*** Including module: systemd ***
*** Including module: usrmount ***
*** Including module: base ***
/etc/os-release: line 1: Photon: command not found
*** Including module: fs-lib ***
*** Including module: shutdown ***
*** Including modules done ***
*** Installing kernel module dependencies and firmware ***
*** Installing kernel module dependencies and firmware done ***
*** Resolving executable dependencies ***
*** Resolving executable dependencies done***
*** Stripping files ***
*** Stripping files done ***
*** Store current command line parameters ***
*** Creating image file ***
*** Creating image file done ***
Image: /var/tmp/initramfs.img: 11M
========================================================================
Version: dracut-041-1.ph3

Arguments: -v --tmpdir '/tmp' -f --no-hostonly

dracut modules:
bash
kernel-modules
resume
rootfs-block
terminfo
udev-rules
ostree
systemd
usrmount
base
fs-lib
shutdown
========================================================================
drwxr-xr-x  12 root     root            0 Sep  1 00:52 .
crw-r--r--   1 root     root       5,   1 Sep  1 00:52 dev/console
crw-r--r--   1 root     root       1,  11 Sep  1 00:52 dev/kmsg
...   (long list of files removed)
========================================================================
Initializing rootfs
Migrating /etc/passwd to /usr/lib/
Migrating /etc/group to /usr/lib/
Moving /usr to target
Linking /usr/local -&gt; ../var/usrlocal
Moving /etc to /usr/etc
Placing RPM db in /usr/share/rpm
Ignoring non-directory/non-symlink '/var/tmp/rpm-ostree.TVO089/rootfs.tmp/var/lib/nss_db/Makefile'
Ignoring non-directory/non-symlink '/var/tmp/rpm-ostree.TVO089/rootfs.tmp/var/cache/ldconfig/aux-cache'
Ignoring non-directory/non-symlink '/var/tmp/rpm-ostree.TVO089/rootfs.tmp/var/log/btmp'
Ignoring non-directory/non-symlink '/var/tmp/rpm-ostree.TVO089/rootfs.tmp/var/log/lastlog'
Ignoring non-directory/non-symlink '/var/tmp/rpm-ostree.TVO089/rootfs.tmp/var/log/wtmp'
Moving /boot
Using boot location: both
Copying toplevel compat symlinks
Adding tmpfiles-ostree-integration.conf
Committing '/var/tmp/rpm-ostree.TVO089/rootfs.tmp' ...
photon/1.0/x86_64/minimal =&gt; c505f4bddb4381e8b5213682465f1e5bb150a18228aa207d763cea45c6a81bbe
</code></pre><p>We&rsquo;ve omitted a large portion of the logging output, however you can see that the new filetree adds to the top of the previous (initial) commit <strong>2940e10c4d</strong> and produces a new commit <strong>c505f4bddb</strong>. Our packages <code>gawk-4.1.0-2.ph3.x86_64</code>, <code>sudo-1.8.11p1-4.ph3.x86_64</code> and <code>wget-1.15-1.ph3.x86_64</code> have been added.</p><p>During compose, <code>rpm-ostree</code> checks out the file tree into its uncompressed form, applies the package changes, places the updated RPM repo into /usr/share/rpm and calls <code>ostree</code> to commit its changes back into the OSTree repo. If we were to look at the temp directory during this time:</p><pre><code class=language-console data-lang=console>root [ /srv/rpm-ostree ]# ls /var/tmp/rpm-ostree.TVO089/rootfs.tmp
bin   dev   lib    media  opt     proc  run   srv  sysroot  usr
boot  home  lib64  mnt    ostree  root  sbin  sys  tmp      var
</code></pre><p>If we repeat the command, and there is no change in the JSON file settings and no change in metadata, rpm-ostree will figure out that nothing has changed and stop. You can force however to redo the whole composition.</p><pre><code class=language-console data-lang=console>root [ /srv/rpm-ostree ]# rpm-ostree compose tree --repo=repo photon-base.json
Previous commit: c505f4bddb4381e8b5213682465f1e5bb150a18228aa207d763cea45c6a81bbe

Downloading metadata [=========================================================================] 100%


No apparent changes since previous commit; use --force-nocache to override
</code></pre><p>This takes several minutes. Then why is the RPM-OSTree server installing so fast, in 45 seconds on my SSD? The server doesn&rsquo;t compose the tree, it uses a pre-created OSTree repo that is stored on the CD-ROM. It comes of course at the expense of larger CD-ROM size. This OSTree repo is created from the same set of RPMS on the CD-ROM, so if you compose fresh, you will get the same exact tree, with same commit ID for the &ldquo;minimal&rdquo; ref.</p><h2 id=automatic-version-prefix>Automatic version prefix</h2><p>If you recall the filetree version explained earlier, this is where it comes into play. When a tree is composed from scratch, the first version (0) associated to the initial commit is going to get that human readable value. Any subsequent compose operation will auto-increment to .1, .2, .3 and so on.<br>It&rsquo;s a good idea to start a versionning scheme of your own, so that your customized Photon builds that may get different packages of your choice don&rsquo;t get the same version numbers as the official Photon team builds coming from VMware&rsquo;s OSTree Packages repository. There is no conflict, it&rsquo;s just confusing to have same name for different commits coming from different repos.<br>So if you work for a company named Big Data Inc., you may want to switch to a new versioning scheme <strong>&ldquo;automatic_version_prefix&rdquo;: &ldquo;1.0_bigdata&rdquo;</strong>.</p><h2 id=installing-package-updates>Installing package updates</h2><p>If you want to provide hosts with the package updates that VMware periodically releases, all that you need to do is to add the photon-updates.repo to the list of repos in photon-base.json and then re-compose the usual way.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#c4a000>&#34;repos&#34;: [&#34;photon&#34;, &#34;photon-updates&#34;],</span>
</code></pre></div><p>Even though you may have not modified the &ldquo;packages&rdquo; section in the json file, the newer versions of existing packages will be included in the new image and then downloaded by the host the usual way. Note that upgrading a package shows differently than adding (+) or removing (-). You may still see packages added (or removed) though because they are new dependencies (or no longer dependencies) for the newer versions of other packages, as libssh2 in the example below.</p><pre><code class=language-console data-lang=console>root [ ~ ]# rpm-ostree upgrade --check-diff
Updating from: photon:photon/4.0/x86_64/minimal

8 metadata, 13 content objects fetched; 1002 KiB transferred in 0 seconds
!bridge-utils-1.5-2.ph3.x86_64
=bridge-utils-1.5-3.ph3.x86_64
!bzip2-1.0.6-5.ph3.x86_64
=bzip2-1.0.6-6.ph3.x86_64
!curl-7.47.1-2.ph3.x86_64
=curl-7.51.0-2.ph3.x86_64
!docker-1.11.0-5.ph3.x86_64
=docker-1.12.1-1.ph3.x86_64
...
+libssh2-1.8.0-1.ph3.x86_64
...

root [ ~ ]# rpm-ostree upgrade
Updating from: photon:photon/1.0/x86_64/minimal

258 metadata, 1165 content objects fetched; 76893 KiB transferred in 8 seconds
Copying /etc changes: 6 modified, 0 removed, 14 added
Transaction complete; bootconfig swap: yes deployment count change: 1
Changed:
  bridge-utils 1.5-2.ph3 -&gt; 1.5-3.ph3
  bzip2 1.0.6-5.ph3 -&gt; 1.0.6-6.ph3
  curl 7.47.1-2.ph3 -&gt; 7.51.0-2.ph3
  docker 1.11.0-5.ph3 -&gt; 1.12.1-1.ph3
  ...
Added:
  libssh2-1.8.0-1.ph3.x86_64
Upgrade prepared for next boot; run &quot;systemctl reboot&quot; to start a reboot
</code></pre><p>Now if we want to see what packages have been updated and what issues have been fixed, just run at the host the command that we learned about in chapter 5.4.</p><pre><code class=language-console data-lang=console>root [ ~ ]# rpm-ostree db diff 56ef 396e
ostree diff commit old: 56e (56ef687f1319604b7900a232715718d26ca407de7e1dc89251b206f8e255dcb4)
ostree diff commit new: 396 (396e1116ad94692b8c105edaee4fa12447ec3d8f73c7b3ade4e955163d517497)
Upgraded:
 bridge-utils-1.5-3.ph3.x86_64
* Mon Sep 12 2016 user1 &lt;user1@vmware.com&gt; 1.5-3
-	Update patch to fix-2.

 bzip2-1.0.6-6.ph3.x86_64
* Fri Oct 21 2016 user2 &lt;user2@vmware.com&gt; 1.0.6-6
-       Fixing security bug CVE-2016-3189.

 curl-7.51.0-2.ph3.x86_64
* Wed Nov 30 2016 user3 &lt;user3@vmware.com&gt; 7.51.0-2
-   Enable sftp support.

* Wed Nov 02 2016 user4 &lt;user4@vmware.com&gt; 7.51.0-1
-   	Upgrade curl to 7.51.0

* Thu Oct 27 2016 user4 &lt;user4@vmware.com&gt; 7.47.1-4
-   	Patch for CVE-2016-5421

* Mon Sep 19 2016 user3 &lt;user3@vmware.com&gt; 7.47.1-3
-   	Applied CVE-2016-7167.patch.

 docker-1.12.1-1.ph3.x86_64
* Wed Sep 21 2016 user3 &lt;user3@vmware.com&gt; 1.12.1-1
-   Upgraded to version 1.12.1

* Mon Aug 22 2016 user1 &lt;user1@vmware.com&gt; 1.12.0-2
-   Added bash completion file

* Tue Aug 09 2016 user4 &lt;user4@vmware.com&gt; 1.12.0-1
-   Upgraded to version 1.12.0

* Tue Jun 28 2016 user4 &lt;user4@vmware.com&gt; 1.11.2-1
-   Upgraded to version 1.11.2
...
Added:
 libssh2-1.8.0-1.ph3.x86_64
</code></pre><h2 id=composing-for-a-different-branch>Composing for a different branch</h2><p>RPM-OSTree makes it very easy to create and update new branches, by composing using json config files that include the Refspec as the new branch name, the list of packages and the other settings we are now familiar with. Photon OS RPM-OSTRee Server installer adds two extra files photon-minimal.json and photon-full.json in addition to photon-base.json, that correspond almost identically to the minimal and full profiles installed via tdnf. It also makes &lsquo;photon-base&rsquo; a smaller set of starter branch.</p><p>Of course, you can create your own config files for your branches with desired lists of packages. You may compose on top of the existing tree, or you can <a href=../../../../docs/administration-guide/photon-rpm-ostree/file-oriented-server-operations/#starting-a-fresh-ostree-repo>start fresh your own OSTRee repo</a>, using your own customized versioning.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-2472b0296edd8e9542da1d39ed9b48cd>11 - Remotes</h1><p>In Chapter 3 we talked about the Refspec that contains a <strong>photon:</strong> prefix, that is the name of a remote. When a Photon host is installed, a remote is added - which contains the URL for an OSTree repository that is the origin of the commits we are going to pull from and deploy filetrees, in our case the Photon RPM-OSTree server we installed the host from. This remote is named <strong>photon</strong>, which may be confusing, because it&rsquo;s also the OS name and part of the Refspec (branch) path.</p><h2 id=listing-remotes>Listing remotes</h2><p>A host repo can be configured to switch between multiple remotes to pull from, however only one remote is the &ldquo;active&rdquo; one at a time. We can list the remotes created so far, which brings back the expected result.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree remote list
photon
</code></pre><p>We can inquiry about the URL for that remote name, which for the default host is the expected Photon OS online OSTree repo.</p><pre><code class=language-console data-lang=console>root@photon-host-def [ ~ ]# ostree remote show-url photon
https://&lt;host-name&gt;:8080/repo
</code></pre><p>But where is this information stored? The repo&rsquo;s config file has it.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#c4a000>root@photon-host-def [ ~ ]# cat /ostree/repo/config </span>
<span style=color:#204a87;font-weight:700>[core]</span>
<span style=color:#c4a000>repo_version</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>1</span>
<span style=color:#c4a000>mode</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>bare</span>

<span style=color:#204a87;font-weight:700>[remote &#34;photon&#34;]</span>
<span style=color:#c4a000>url</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>http:&lt;Server-IP-Address:port&gt;/repo</span>
<span style=color:#c4a000>gpg-verify</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>false</span>
</code></pre></div><p>If same command is executed on the custom host we&rsquo;ve installed, it&rsquo;s going to reveal the URL of the Photon RPM-OSTree server connected to during setup.</p><pre><code class=language-console data-lang=console>root@photon-7c2d910d79e9 [ ~ ]# ostree remote show-url photon
https://packages.vmware.com/photon/rpm-ostree/base/4.0/x86_64/repo
</code></pre><h2 id=gpg-signature-verification>GPG signature verification</h2><p>You may wonder what is the purpose of <code>gpg-verify=false</code> in the config file, associated with the specific remote. This will instruct any host update to skip the signing verification for the updates that come from server, resulted from tree composed locally at the server, as they are not signed. Without this, host updating will fail.</p><p>There is a whole chapter about signing, importing keys and so on that I will not get into, but the idea is that signing adds an extra layer of security, by validating that everything you download comes from the trusted publisher and has not been altered. That is the case for all Photon OS artifacts downloaded from VMware official site. All OVAs and packages, either from the online RPMS repositories or included in the ISO file - are signed by VMware. We&rsquo;ve seen a similar setting <code>gpgcheck=1</code> in the RPMS repo configuration files that tdnf uses to validate or not the signature for all packages downloaded to be installed.</p><h2 id=switching-repositories>Switching repositories</h2><p>Since mapping name/url is stored in the repo&rsquo;s config file, in principle you can re-assign a different URL, connecting the host to a different server. The next upgrade will get the latest commit chain from the new server.<br>If we edit photon-host-def&rsquo;s repo config and replace the VMware Photon Packages URL by photon-srv1&rsquo;s IP address, all original packages in the original 4.0_minimal version will be preserved, but any new package change (addition, removal, upgrade) added after that (in 4.0_minimal.1, 4.0_minimal.2) will be reverted and all new commits from photon-srv1 (that may have same version) will be applied. This is because the two repos are identical copies, so they have the same original commit ID as a common ancestor, but they diverge from there.</p><p>If the old and new repo have nothing in common (no common ancestor commit), this will undo even the original commit, so all commits from the new tree will be applied.<br>A better solution would be to add a new remote that will identify where the commits come from.</p><h2 id=adding-and-removing-remotes>Adding and removing remotes</h2><p>A cleaner way to switch repositories is to add remotes that point to different servers. Let us add another server that we will refer to as <strong>photon2</strong>, along with (optional) the refspecs for branches that it provides (we will see later that in the newer OSTree versions, we don&rsquo;t need to know the branch names, they could be <a href=#list-available-branches>queried at run-time</a>).</p><pre><code class=language-console data-lang=console>root@photon-host-cus [ ~ ]# ostree remote add --repo=/ostree/repo -v --no-gpg-verify photon2 http://10.197.103.204:8080 photon/4.0/x86_64/minimal photon/4.0/x86_64/full
root@photon-host-cus [ ~ ]# ostree remote list
photon
photon2
root@photon-host-cus [ ~ ]# ostree remote show-url photon2
http://10.0.0.86
</code></pre><p>Where is this information stored? There is an extra config file created per each remote:</p><pre><code class=language-console data-lang=console>root@photon-host-cus [ ~ ]# cat /etc/ostree/remotes.d/photon2.conf 
[remote &quot;photon2&quot;]
url=http://10.0.0.86
branches=photon/4.0/x86_64/minimal;photon/4.0/x86_64/full;
gpg-verify=false
</code></pre><p>You may have guessed what is the effect of <code>--no-gpg-verify option</code>.<br>Obviously, remotes could also be deleted.</p><pre><code class=language-console data-lang=console>root@photon-host-cus [ ~ ]# ostree remote delete photon2
root@photon-host-cus [ ~ ]# ostree remote list
photon
</code></pre><h2 id=list-available-branches>List available branches</h2><p>If a host has been deployed from a specific branch and would like to switch to a different one, maybe from a different server, how would it know what branches are available? In git, you would run <code>git remote show origin</code> or <code>git remote -a</code> (although last command would not show all branches, unless you ran <code>git fetch</code> first).</p><p>In Photon OS, the hosts are able to query the server, if summary metadata has been generated, as we&rsquo;ve seen in <a href=../../../../docs/administration-guide/photon-rpm-ostree/file-oriented-server-operations/#creating-summary-metadata>Creating summary metadata</a>. This command lists all branches available for remote <strong>photon2</strong>.</p><pre><code class=language-console data-lang=console>root@photon-host-cus [ ~ ]# ostree remote refs photon2 
photon2:photon/4.0/x86_64/base
photon2:photon/4.0/x86_64/full
photon2:photon/4.0/x86_64/minimal
</code></pre><h2 id=switching-branches-rebasing>Switching branches (rebasing)</h2><p>If you have an installed Photon 3.0 that you want to carry to 4.0, you need to rebase it.</p><p>See <a href=../../../../docs/administration-guide/photon-rpm-ostree/install-or-rebase-to-photon-os-4/>rebasing</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-732a7f8dd299bd9ffbffb4afab9b21f0>12 - Running container applications between bootable images</h1><p>In this chapter, we want to test a docker application and make sure that all the settings and downloads done in one bootable filetree are going to be saved into writable folders and be available in the other image, in other words after reboot from the other image, everything is available exactly the same way.<br>We are going to do this twice: first, to verify an existing bootable image installed in parallel and then create a new one.</p><h2 id=downloading-a-docker-container-appliance>Downloading a docker container appliance</h2><p>Photon OS comes with docker package installed and configured, but we expect that the docker daemon is inactive (not started). Configuration file /usr/lib/systemd/system/docker.service is read-only (remember /usr is bound as read-only).</p><pre><code class=language-console data-lang=console>root@sample-host-def [ ~ ]# systemctl status docker
* docker.service - Docker Daemon
   Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled)
   Active: inactive (dead)

root@sample-host-def [ ~ ]# cat /usr/lib/systemd/system/docker.service
[Unit]
Description=Docker Application Container Engine
Documentation=https://docs.docker.com
After=network-online.target
Wants=network-online.target

[Service]
Type=notify
# the default is not to use systemd for cgroups because the delegate issues still
# exists and systemd currently does not support the cgroup feature set required
# for containers run by docker
ExecStart=/usr/bin/dockerd
ExecReload=/bin/kill -s HUP $MAINPID
# Having non-zero Limit*s causes performance problems due to accounting overhead
# in the kernel. We recommend using cgroups to do container-local accounting.
LimitNOFILE=infinity
LimitNPROC=infinity
LimitCORE=infinity
# Uncomment TasksMax if your systemd version supports it.
# Only systemd 226 and above support this version.
#TasksMax=infinity
TimeoutStartSec=0
# set delegate yes so that systemd does not reset the cgroups of docker containers
Delegate=yes
# kill only the docker process, not all processes in the cgroup
KillMode=process
# restart the docker process if it exits prematurely
Restart=on-failure
StartLimitBurst=3
StartLimitInterval=60s

[Install]
WantedBy=multi-user.target
</code></pre><p>Now let&rsquo;s enable docker daemon to start at boot time - this will create a symbolic link into writable folder /etc/systemd/system/multi-user.target.wants to its systemd configuration, as with all other systemd controlled services.</p><pre><code class=language-console data-lang=console>root@sample-host-def [ ~ ]# systemctl enable docker
Created symlink /etc/systemd/system/multi-user.target.wants/docker.service -&gt; /lib/systemd/system/docker.service.

root@sample-host-def [ ~ ]# ls -l /etc/systemd/system/multi-user.target.wants
total 0
lrwxrwxrwx 1 root root 34 Sep 10 10:48 docker.service -&gt; /lib/systemd/system/docker.service
lrwxrwxrwx 1 root root 36 Sep  4 04:59 iptables.service -&gt; /lib/systemd/system/iptables.service
lrwxrwxrwx 1 root root 35 Sep  4 04:59 machines.target -&gt; /lib/systemd/system/machines.target
lrwxrwxrwx 1 root root 36 Sep  4 04:59 remote-fs.target -&gt; /lib/systemd/system/remote-fs.target
lrwxrwxrwx 1 root root 39 Sep  4 04:59 sshd-keygen.service -&gt; /lib/systemd/system/sshd-keygen.service
lrwxrwxrwx 1 root root 32 Sep  4 04:59 sshd.service -&gt; /lib/systemd/system/sshd.service
lrwxrwxrwx 1 root root 44 Sep  4 04:59 systemd-networkd.service -&gt; /lib/systemd/system/systemd-networkd.service
lrwxrwxrwx 1 root root 44 Sep  4 04:59 systemd-resolved.service -&gt; /lib/systemd/system/systemd-resolved.service
</code></pre><p>To verify that the symbolic link points to a file in a read-only directory, try to make a change in this file using vim and save. you&rsquo;ll get an error: <code>/usr/lib/systemd/system/docker.service" E166: Can't open linked file for writing</code>.</p><p>Finally, let&rsquo;s start the daemon, check again that is active.</p><pre><code class=language-console data-lang=console>root@sample-host-def [ ~ ]# systemctl start docker

root@sample-host-def [ ~ ]# systemctl status -l docker
* docker.service - Docker Application Container Engine
   Loaded: loaded (/lib/systemd/system/docker.service; enabled; vendor preset: disabled)
   Active: active (running) since Tue 2019-09-10 10:54:32 UTC; 14s ago
     Docs: https://docs.docker.com
 Main PID: 2553 (dockerd)
    Tasks: 35 (limit: 4711)
   Memory: 148.2M
   CGroup: /system.slice/docker.service
           |-2553 /usr/bin/dockerd
           `-2566 docker-containerd --config /var/run/docker/containerd/containerd.toml

Sep 10 10:54:31 photon-76718dd2fa33 dockerd[2553]: time=&quot;2019-09-10T10:54:31.421759662Z&quot; level=info msg=&quot;pickfirstBalancer: HandleSubConnStateChange: 0xc420312f90, CONNECTING&quot; module=grpc
Sep 10 10:54:31 photon-76718dd2fa33 dockerd[2553]: time=&quot;2019-09-10T10:54:31.421935355Z&quot; level=info msg=&quot;pickfirstBalancer: HandleSubConnStateChange: 0xc420312f90, READY&quot; module=grpc
Sep 10 10:54:31 photon-76718dd2fa33 dockerd[2553]: time=&quot;2019-09-10T10:54:31.421980614Z&quot; level=info msg=&quot;Loading containers: start.&quot;
Sep 10 10:54:31 photon-76718dd2fa33 dockerd[2553]: time=&quot;2019-09-10T10:54:31.886520281Z&quot; level=info msg=&quot;Default bridge
(docker0) is assigned with an IP address 172.17.0.0/16. Daemon option --bip can be used to set a preferred IP address&quot;
Sep 10 10:54:32 photon-76718dd2fa33 dockerd[2553]: time=&quot;2019-09-10T10:54:32.027763113Z&quot; level=info msg=&quot;Loading containers: done.&quot;
Sep 10 10:54:32 photon-76718dd2fa33 dockerd[2553]: time=&quot;2019-09-10T10:54:32.468277184Z&quot; level=info msg=&quot;Docker daemon&quot;
commit=6d37f41 graphdriver(s)=overlay2 version=18.06.2-ce
Sep 10 10:54:32 photon-76718dd2fa33 dockerd[2553]: time=&quot;2019-09-10T10:54:32.468441587Z&quot; level=info msg=&quot;Daemon has completed initialization&quot;
Sep 10 10:54:32 photon-76718dd2fa33 dockerd[2553]: time=&quot;2019-09-10T10:54:32.684925824Z&quot; level=warning msg=&quot;Could not register builder git source: failed to find git binary: exec: \&quot;git\&quot;: executable file not found in $PATH&quot;
Sep 10 10:54:32 photon-76718dd2fa33 dockerd[2553]: time=&quot;2019-09-10T10:54:32.691070166Z&quot; level=info msg=&quot;API listen on /var/run/docker.sock&quot;
Sep 10 10:54:32 photon-76718dd2fa33 systemd[1]: Started Docker Application Container Engine.
</code></pre><p>We&rsquo;ll ask docker to run Ubuntu Linux in a container. Since it&rsquo;s not present locally, it&rsquo;s going to be downloaded first from the official docker repository <a href=https://hub.docker.com/_/ubuntu/>https://hub.docker.com/_/ubuntu/</a>.</p><pre><code class=language-console data-lang=console>root@sample-host-def [ ~ ]# docker ps -a
CONTAINER ID        IMAGE            COMMAND      CREATED           STATUS              PORTS       NAMES

root@sample-host-def [ ~ ]# docker run -it ubuntu
Unable to find image 'ubuntu:latest' locally
latest: Pulling from library/ubuntu
35c102085707: Pull complete
251f5509d51d: Pull complete
8e829fe70a46: Pull complete
6001e1789921: Pull complete
Digest: sha256:d1d454df0f579c6be4d8161d227462d69e163a8ff9d20a847533989cf0c94d90
Status: Downloaded newer image for ubuntu:latest
</code></pre><p>When downloading is complete, it comes to Ubuntu root prompt with assigned host name 7029a64e7aa3, that is actually the Container ID. Let&rsquo;s verify it&rsquo;s indeed the expected OS.</p><pre><code class=language-console data-lang=console>root@sample-host-def [ ~ ]# docker run -it ubuntu
Unable to find image 'ubuntu:latest' locally
latest: Pulling from library/ubuntu
d3a1f33e8a5a: Pull complete
c22013c84729: Pull complete
d74508fb6632: Pull complete
91e54dfb1179: Already exists
library/ubuntu:latest: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.
Digest: sha256:fde8a8814702c18bb1f39b3bd91a2f82a8e428b1b4e39d1963c5d14418da8fba
Status: Downloaded newer image for ubuntu:latest

root@7029a64e7aa3:/# cat /etc/os-release
NAME=&quot;Ubuntu&quot;
VERSION=&quot;18.04.3 LTS (Bionic Beaver)&quot;
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME=&quot;Ubuntu 18.04.3 LTS&quot;
VERSION_ID=&quot;18.04&quot;
HOME_URL=&quot;https://www.ubuntu.com/&quot;
SUPPORT_URL=&quot;https://help.ubuntu.com/&quot;
BUG_REPORT_URL=&quot;https://bugs.launchpad.net/ubuntu/&quot;
PRIVACY_POLICY_URL=&quot;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&quot;
VERSION_CODENAME=bionic
UBUNTU_CODENAME=bionic
root@7029a64e7aa3:/#
</code></pre><p>Now let&rsquo;s write a file into Ubuntu home directory</p><pre><code class=language-console data-lang=console>echo &quot;Ubuntu file&quot; &gt;&gt; /home/myfile
root@7029a64e7aa3:/home# cat /home/myfile
Ubuntu file
</code></pre><p>We&rsquo;ll exit back to the Photon prompt and if it&rsquo;s stopped, we will re-start it.</p><pre><code class=language-console data-lang=console>root@7029a64e7aa3:/# exit
exit

root@sample-host-def [ ~ ]# docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                       PORTS               NAMES
7029a64e7aa3        ubuntu              &quot;/bin/bash&quot;         6 minutes ago       Exited (0) 11 seconds ago                        gifted_dijkstra

root@photon-host-cus1 [ ~ ]# docker start  7029a64e7aa3
7029a64e7aa3

root@photon-host-cus1 [ ~ ]# docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                       PORTS               NAMES
7029a64e7aa3        ubuntu              &quot;/bin/bash&quot;         7 minutes ago       Up 21 seconds                                    gifted_dijkstra
</code></pre><h2 id=rebooting-into-an-existing-image>Rebooting into an existing image</h2><p>Now let&rsquo;s reboot the machine and select the other image. First, we&rsquo;ll verify that the docker daemon is automaically started.</p><pre><code class=language-console data-lang=console>root@photon-host-cus1 [ ~ ]# systemctl status docker
* docker.service - Docker Application Container Engine
   Loaded: loaded (/lib/systemd/system/docker.service; enabled; vendor preset: disabled)
   Active: active (running) since Tue 2019-09-10 10:54:32 UTC; 13min ago
     Docs: https://docs.docker.com
 Main PID: 2553 (dockerd)
    Tasks: 55 (limit: 4711)
   Memory: 261.3M
   CGroup: /system.slice/docker.service
           |-2553 /usr/bin/dockerd
   ...
</code></pre><p>Next, is the Ubuntu OS container still there?</p><pre><code class=language-console data-lang=console>root@photon-host-cus1 [ ~ ]# docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                       PORTS               NAMES
7029a64e7aa3        ubuntu              &quot;/bin/bash&quot;         9 minutes ago       Up 2 minutes                                     gifted_dijkstra
</code></pre><p>It is, so let&rsquo;s start it, attach and verify that our file is persisted, then add another line to it and save, exit.</p><pre><code class=language-console data-lang=console>root@photon-host-cus1 [ ~ ]# docker start -i  7029a64e7aa3
root@7029a64e7aa3:/# cat /home/myfile
Ubuntu file
root@7029a64e7aa3:/# echo &quot;booted into existing image&quot; &gt;&gt; /home/myfile
root@7029a64e7aa3:/# exit
exit
</code></pre><h2 id=reboot-into-a-newly-created-image>Reboot into a newly created image</h2><p>Let&rsquo;s upgrade and replace the .0 image by a .4 build that contains git and also perl_YAML (because it is a dependency of git).</p><pre><code class=language-console data-lang=console>root@photon-host-cus1 [ ~ ]# rpm-ostree status
  TIMESTAMP (UTC)         VERSION               ID             OSNAME     REFSPEC
* 2015-09-04 00:36:37     4.0_minimal     092e21d292     photon     photon:photon/x86_64/minimal
  2015-08-20 22:27:43     4.0_minimal       2940e10c4d     photon     photon:photon/x86_64/minimal

root@photon-host-cus1 [ ~ ]# rpm-ostree upgrade
Updating from: photon:photon/tp2/x86_64/minimal

43 metadata, 209 content objects fetched; 19992 KiB transferred in 0 seconds
Copying /etc changes: 5 modified, 0 removed, 19 added
Transaction complete; bootconfig swap: yes deployment count change: 0
Freed objects: 16.2 MB
Added:
  git-2.1.2-1.ph3tp2.x86_64
  perl-YAML-1.14-1.ph3tp2.noarch
Upgrade prepared for next boot; run &quot;systemctl reboot&quot; to start a reboot

root@photon-host-cus1 [ ~ ]# rpm-ostree status
  TIMESTAMP (UTC)         VERSION               ID             OSNAME     REFSPEC
  2015-09-06 18:12:08     4.0_minimal     d16aebd803     photon     photon:photon/x86_64/minimal
* 2015-09-04 00:36:37     4.0_minimal     092e21d292     photon     photon:photon/x86_64/minimal
</code></pre><p>After reboot from 4.0_minimal. build, let&rsquo;s check that the 3-way /etc merge succeeded as expected. The docker.service slink is still there, and docker demon restarted at boot.</p><pre><code class=language-console data-lang=console>root@photon-host-cus1 [ ~ ]# ls -l /etc/systemd/system/multi-user.target.wants/docker.service
lrwxrwxrwx 1 root root 38 Sep  6 12:50 /etc/systemd/system/multi-user.target.wants/docker.service -&gt; /usr/lib/systemd/system/docker.service

root@photon-host-cus1 [ ~ ]# systemctl status docker
* docker.service - Docker Daemon
   Loaded: loaded (/usr/lib/systemd/system/docker.service; enabled)
   Active: active (running) since Sun 2015-09-06 12:56:33 UTC; 1min 27s ago
 Main PID: 292 (docker)
   CGroup: /system.slice/docker.service
           `-292 /bin/docker -d -s overlay
   ...
</code></pre><p>Let&rsquo;s revisit the Ubuntu container. Is the container still there? is myfile persisted?</p><pre><code class=language-console data-lang=console>root@photon-host-cus1 [ ~ ]# docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                    PORTS               NAMES
7029a64e7aa3        ubuntu              &quot;/bin/bash&quot;         5 days ago          Exited (0) 5 days ago                         gifted_dijkstra
55825c961f95        ubuntu              &quot;/bin/bash&quot;         5 days ago          Exited (127) 5 days ago                       distracted_shannon

root@photon-host-cus1 [ ~ ]# docker start 57dcac5d0490

root@57dcac5d0490:/# cat /home/myfile
Ubuntu file
booted into existing image
root@57dcac5d0490:/# echo &quot;booted into new image&quot; &gt;&gt; /home/myfile
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-f4acccc20969d619858c0e6c930ecb82>13 - Install or rebase to Photon OS 4.0</h1><p>Photon OS 4.0 provides full RPM-OSTree functionality, it lets the user drive it, rather than provide a pre-defined solution as part of the installation.</p><p>The number of packages included in the RPMS repo in Photon OS 4.0 increased significantly, compared to 1.0. To keep the ISO at reasonable size, the previous versions no longer include the compressed ostree.repo file, that helped optimize both the server and host install in 1.0 or 1.0 Rev2. That decision affected the OSTree features we ship out of the box. Customer could achieve the same results by several additional simple steps, that will be explained in this chapter. In addition, there is a new way to create a host raw image at server.</p><h2 id=composing-your-own-rpm-ostree-server>Composing your own RPM-OSTree Server</h2><p>You can compose your own RPM-OSTRee server in the following two ways:</p><ol><li>By Manually executing the below command:</li></ol><pre><code class=language-console data-lang=console>root [ /srv/rpm-ostree ]# ostree --repo=repo init --mode=archive-z2
root [ /srv/rpm-ostree ]# rpm-ostree compose tree --repo=repo photon-base.json
</code></pre><ol start=2><li>By installing <code>rpm-ostree-repo package</code> . This provides the script to create the repo tree which act as server by executing a single command.</li></ol><h2 id=installing-an-rpm-ostree-host>Installing an RPM-OSTree host</h2><p>Automated host install is supported, as explained in <a href=../../../../docs/administration-guide/photon-rpm-ostree/installing-a-host-against-custom-server-repository/#automated-install-of-a-custom-host-via-kickstart>Automated install of a custom host via kickstart</a>.</p><h2 id=rebasing-a-host-from-photon-10-to-40>Rebasing a host from Photon 1.0 to 4.0</h2><p>If kickstart sounds too complicated and we still want to go the UI way there is a workaround that requires an extra step. Also, if you have an installed Photon 1.0 or 1.0 Rev2 that you want to carry to 4.0, you need to rebase it. Notice that we didn&rsquo;t say &ldquo;upgrade&rdquo;.</p><p>Practically, the OSTree repo will switch to a different branch on a different server, following the new server&rsquo;s branch versioning scheme. The net result is that the lots of packages will get changed to newer versions listed in the newer OSTree repo, which has been composed from a newer Photon OS 4.0 RPMS repo. Again, we didn&rsquo;t say &ldquo;upgraded&rdquo;, neither the rebase command output, that lists &ldquo;changed&rdquo; packages. Some obsolete packages will be removed, new packages will be added, either because they didn&rsquo;t exist in older repo, or because the new config file includes them.<br>The OS name is the same (Photon), so the content in /var and /etc will be transferred over.</p><ol><li><p>To install fresh, deploy a Photon 4 host default, as described in the section <a href=../../../../docs/administration-guide/photon-rpm-ostree/installing-a-host-against-default-server-repository/>Installing A Host Against the Default Server Repository</a>. Of course, if you already have an existing Photon OS 3.0 host that you want to move to 4.0, skip this step.</p></li><li><p>Edit /ostree/repo/config and substitute the url, providing the IP address for the Photon OS RPM-OSTree server installed above. This was explained in the &ldquo;Switching Repositories&rdquo; section of the <a href=../../../../docs/administration-guide/photon-rpm-ostree/remotes/#switching-repositories>Remotes</a> document.<br>Ostree should confirm that is the updated server IP for the &ldquo;photon&rdquo; remote.</p></li></ol><pre><code class=language-console data-lang=console>root@ostree-host [ ~ ]# ostree remote show-url photon
http://10.20.30.175:8000/repo
</code></pre><ol start=3><li>Rebase your host to the new 4.0 server and Refspec.</li></ol><pre><code class=language-console data-lang=console>root@ostree-host [ ~ ]# ostree remote add photon-4 http://10.20.30.204:8000/repo --no-gpg-verify
root@ostree-host [ ~ ]# rpm-ostree rebase photon-4:photon/4.0/x86_64/minimal

Rebasing to photon-4:photon/4.0/x86_64/minimal
⠉ Receiving objects: 99% (1541/1549) 478.3 kB/s 107.1 MB
Receiving objects: 99% (1541/1549) 478.3 kB/s 107.1 MB... done
Staging deployment... done
Upgraded:
  docker 18.06.2-3.ph3 -&gt; 18.06.2-4.ph3
  gmp 6.1.2-2.ph3 -&gt; 6.1.2-3.ph3
  gobject-introspection 1.58.0-2.ph3 -&gt; 1.58.0-3.ph3
  gzip 1.9-1.ph3 -&gt; 1.9-2.ph3
  linux 4.19.65-3.ph3 -&gt; 4.19.69-1.ph3
  mpfr 4.0.1-1.ph3 -&gt; 4.0.1-2.ph3
  ostree 2019.2-1.ph3 -&gt; 2019.2-2.ph3
  ostree-grub2 2019.2-1.ph3 -&gt; 2019.2-2.ph3
  ostree-libs 2019.2-1.ph3 -&gt; 2019.2-2.ph3
  zlib 1.2.11-1.ph3 -&gt; 1.2.11-2.ph3
Added:
  efibootmgr-15-1.ph3.x86_64
  efivar-36-1.ph3.x86_64
  tar-1.30-3.ph3.x86_64
Run &quot;systemctl reboot&quot; to start a reboot
</code></pre><ol><li>Check the status</li></ol><pre><code class=language-console data-lang=console>root@ostree-host [ ~ ]# rpm-ostree status
State: idle
AutomaticUpdates: disabled
Deployments:
* ostree://photon-1:photon/4.0/x86_64/minimal
                Version: 4.0_minimal (2019-09-18T08:22:15Z)
            BaseCommit: c8f2b116b067d7695f9033bf2a99505198269354e157c0f2d5b78266cb874239
        LayeredPackages: createrepo_c rpm wget

  ostree://photon:photon/3.0/x86_64/minimal
                Version: 3.0_minimal.1 (2017-01-11T02:18:42)
            BaseCommit: 28dc49ecb4604c0bc349e4445adc659491a1874c01198e6253a261f4d59708b7
        LayeredPackages: createrepo_c rpm wget
</code></pre><p>You may now reboot to the new Photon OS 4.0 image.</p><h2 id=creating-a-host-raw-image>Creating a host raw image</h2><p>It is now possible to run at server a script that is part of RPM-OStree package, to create a host raw mage.</p></div></main></div></div><div class=container><footer class="container-fluid p-0 m-0 py-5 row d-print-none"><div class="container-fluid p-0"><div class="row d-flex justify-content-between align-items-center mx-0"><div class="order-sm-1 left-links"><ul class="list-inline mb-0"><li class="list-inline-item h1 px-3 m-0" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class="text-dark ml-4" target=_blank rel="noopener noreferrer" href=https://github.com/vmware/photon#readme><i class="fab fa-github">&nbsp;</i>
GitHub</a></li><li class="list-inline-item h1 px-3 m-0" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class="text-dark ml-4" target=_blank rel="noopener noreferrer" href=https://vmwarecode.slack.com><i class="fab fa-slack">&nbsp;</i>
Slack</a></li></ul></div><div class="order-sm-3 justify-items-end footer-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.4375 135.7375" height="135.7375" width="511.4375" id="svg3355"><defs id="defs3359"><clipPath id="clipPath3387" clipPathUnits="userSpaceOnUse"><path id="path3389" d="M142.293 245.191l494.93 337.36L74.8398 348.098"/></clipPath><linearGradient id="linearGradient3391" spreadMethod="pad" gradientTransform="matrix(-493.8,-339.007,339.007,-493.8,601.845,634.081)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3393" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3395" offset="1" style="stop-opacity:1;stop-color:#80c64c"/></linearGradient><clipPath id="clipPath3405" clipPathUnits="userSpaceOnUse"><path id="path3407" d="M85.2852 570.719 516.813 593.84 54.5195 690.582"/></clipPath><linearGradient id="linearGradient3409" spreadMethod="pad" gradientTransform="matrix(-304.079,-208.759,208.759,-304.079,420.197,734.568)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3411" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3413" offset="1" style="stop-opacity:1;stop-color:#22437e"/></linearGradient><clipPath id="clipPath3423" clipPathUnits="userSpaceOnUse"><path id="path3425" d="m538.137 270.234 95.324 293.5-205.699-247.089"/></clipPath><linearGradient id="linearGradient3427" spreadMethod="pad" gradientTransform="matrix(-255.101,-175.134,175.134,-255.101,686.667,486.234)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3429" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3431" offset="1" style="stop-opacity:1;stop-color:#65a5de"/></linearGradient><clipPath id="clipPath3441" clipPathUnits="userSpaceOnUse"><path id="path3443" d="M857.758 94.3906 656.035 546.801 745.172 53.6406"/></clipPath><linearGradient id="linearGradient3445" spreadMethod="pad" gradientTransform="matrix(-102.35,-449.574,449.574,-102.35,800.888,513.826)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3447" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3449" offset="1" style="stop-opacity:1;stop-color:#c6da3a"/></linearGradient><clipPath id="clipPath3459" clipPathUnits="userSpaceOnUse"><path id="path3461" d="M481.316 864.746 635.938 602.125l-41.313 301.32"/></clipPath><linearGradient id="linearGradient3463" spreadMethod="pad" gradientTransform="matrix(67.7401,274.401,-274.401,67.7401,532.514,627.656)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3465" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3467" offset="1" style="stop-opacity:1;stop-color:#c6da3a"/></linearGradient><clipPath id="clipPath3477" clipPathUnits="userSpaceOnUse"><path id="path3479" d="M1085.54 913.828 683.598 585.359l456.522 219.75"/></clipPath><linearGradient id="linearGradient3481" spreadMethod="pad" gradientTransform="matrix(441.375,262.068,-262.068,441.375,675.147,599.59)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3483" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3485" offset="1" style="stop-opacity:1;stop-color:#22638b"/></linearGradient><clipPath id="clipPath3495" clipPathUnits="userSpaceOnUse"><path id="path3497" d="M1177.19 335.031 693.664 556.211 1106.69 235.887"/></clipPath><linearGradient id="linearGradient3499" spreadMethod="pad" gradientTransform="matrix(450.785,-274.875,274.875,450.785,694.818,558.101)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3501" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3503" offset="1" style="stop-opacity:1;stop-color:#a6dbe7"/></linearGradient><clipPath id="clipPath3513" clipPathUnits="userSpaceOnUse"><path id="path3515" d="M209.754 773.73l382.32-187.417L280.926 872.391"/></clipPath><linearGradient id="linearGradient3517" spreadMethod="pad" gradientTransform="matrix(-360.263,223.047,-223.047,-360.263,601.957,602.271)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop3519" offset="0" style="stop-opacity:1;stop-color:#ffffff"/><stop id="stop3521" offset="1" style="stop-opacity:1;stop-color:#a6dbe7"/></linearGradient></defs><g transform="matrix(1.25,0,0,-1.25,0,135.7375)" id="g3363"><g transform="scale(0.1,0.1)" id="g3365"><path id="path3367" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1544.2 536.77c69.27.0 114.66 37.031 114.66 91.972v1.192c0 59.726-44.79 90.781-112.28 90.781h-105.7V536.77h103.32zm-150.51 203.652c0 13.141 10.75 23.891 23.29 23.891h133.19c94.36.0 156.47-50.172 156.47-132.586v-1.192c0-90.183-75.25-136.765-164.24-136.765h-101.52V367.148c0-13.132-10.76-23.886-23.9-23.886-12.54.0-23.29 10.754-23.29 23.886v373.274"/><path id="path3369" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1765.51 743.41c0 13.141 10.76 23.887 23.29 23.887 13.14.0 23.9-10.746 23.9-23.887V578.574h241.28V743.41c0 13.141 10.74 23.887 23.88 23.887 12.55.0 23.3-10.746 23.3-23.887V367.148c0-13.132-10.75-23.886-23.3-23.886-13.14.0-23.88 10.754-23.88 23.886v167.227H1812.7V367.148c0-13.132-10.76-23.886-23.9-23.886-12.53.0-23.29 10.754-23.29 23.886V743.41"/><path id="path3371" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2554.86 554.082v1.203c0 94.957-69.28 172.598-164.83 172.598-95.56.0-163.65-76.445-163.65-171.406v-1.192c0-94.961 69.28-172.597 164.84-172.597 95.55.0 163.64 76.445 163.64 171.394zm-377.45.0v1.203c0 115.262 86.6 216.192 213.81 216.192 127.2.0 212.6-99.739 212.6-215v-1.192c0-115.265-86.59-216.203-213.79-216.203-127.22.0-212.62 99.738-212.62 215"/><path id="path3373" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2756.35 720.715h-121.24c-11.94.0-22.09 9.555-22.09 21.5.0 11.941 10.15 22.098 22.09 22.098h290.26c11.94.0 22.1-10.157 22.1-22.098.0-11.945-10.16-21.5-22.1-21.5h-121.23V367.148c0-13.132-10.75-23.886-23.9-23.886-13.13.0-23.89 10.754-23.89 23.886v353.567"/><path id="path3375" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3332.78 554.082v1.203c0 94.957-69.28 172.598-164.83 172.598-95.56.0-163.65-76.445-163.65-171.406v-1.192c0-94.961 69.28-172.597 164.84-172.597 95.55.0 163.64 76.445 163.64 171.394zm-377.45.0v1.203c0 115.262 86.6 216.192 213.81 216.192 127.2.0 212.6-99.739 212.6-215v-1.192c0-115.265-86.59-216.203-213.79-216.203-127.22.0-212.62 99.738-212.62 215"/><path id="path3377" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3458.31 742.813c0 12.539 10.75 23.292 23.29 23.292h6.57c10.75.0 17.32-5.375 23.89-13.742l253.83-323.691v315.332c0 12.547 10.14 23.293 23.29 23.293 12.54.0 22.69-10.746 22.69-23.293V366.555c0-12.539-8.96-22.09-21.5-22.09h-2.4c-10.14.0-17.31 5.965-24.48 14.324l-259.2 331.465V366.555c0-12.539-10.14-23.293-23.29-23.293-12.54.0-22.69 10.754-22.69 23.293v376.258"/><path id="path3379" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3982.91 759.98c0 4.528 3.13 7.665 7.66 7.665h2.09c3.14.0 5.22-1.395 6.97-3.829l37.6-58.503 38.3 58.503c1.74 2.434 3.83 3.829 6.61 3.829h2.09c3.83.0 7.32-3.485 7.32-7.665v-94.011c0-4.18-3.49-7.66-7.66-7.66-4.18.0-7.31 3.48-7.31 7.66v72.426l-32.38-48.403c-1.75-2.785-3.83-4.527-6.97-4.527-3.13.0-5.22 1.742-6.96 4.527l-32.04 48.403v-72.426c0-4.18-3.48-7.66-7.66-7.66s-7.66 3.48-7.66 7.66v94.011zm-73.47-7.308h-28.91c-3.82.0-7.3 3.48-7.3 7.308.0 3.836 3.48 7.317 7.3 7.317h72.78c4.18.0 7.31-3.481 7.31-7.317.0-3.828-3.13-7.308-7.31-7.308h-28.55v-86.703c0-4.18-3.48-7.66-8.01-7.66-4.18.0-7.31 3.48-7.31 7.66v86.703"/><path id="path3381" style="fill:#696566;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m597.898 989.039c-236.39.0-428.714-192.324-428.714-428.719.0-236.39 192.324-428.715 428.714-428.715 236.395.0 428.722 192.325 428.722 428.715.0 236.395-192.327 428.719-428.722 428.719zm0-954.289c-289.796.0-525.566 235.773-525.566 525.57s235.77 525.57 525.566 525.57c289.801.0 525.572-235.773 525.572-525.57S887.699 34.75 597.898 34.75"/><g id="g3383"><g clip-path="url(#clipPath3387)" id="g3385"><path id="path3397" style="fill:url(#linearGradient3391);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M142.293 245.191l494.93 337.36L74.8398 348.098"/></g></g><path id="path3399" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m167.938 304.09c-4.524 34.332-36.024 58.496-70.356 53.973-34.332-4.52-58.5-36.02-53.9765-70.352 4.5234-34.336 36.0234-58.5 70.3555-53.977 34.332 4.524 58.5 36.02 53.977 70.356"/><g id="g3401"><g clip-path="url(#clipPath3405)" id="g3403"><path id="path3415" style="fill:url(#linearGradient3409);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M85.2852 570.719 516.813 593.84 54.5195 690.582"/></g></g><path id="path3417" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m124.875 636.605c-4.523 34.333-36.0234 58.5-70.3555 53.977C20.1875 686.059-3.98047 654.559.542969 620.227 5.06641 585.895 36.5664 561.727 70.8984 566.25c34.3356 4.523 58.4996 36.023 53.9766 70.355"/><g id="g3419"><g clip-path="url(#clipPath3423)" id="g3421"><path id="path3433" style="fill:url(#linearGradient3427);fill-opacity:1;fill-rule:nonzero;stroke:none" d="m538.137 270.234 95.324 293.5-205.699-247.089"/></g></g><path id="path3435" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m541.352 289.715c-4.524 34.332-36.024 58.5-70.356 53.973-34.336-4.52-58.5-36.02-53.976-70.352 4.523-34.336 36.023-58.5 70.355-53.977 34.332 4.524 58.496 36.024 53.977 70.356"/><g id="g3437"><g clip-path="url(#clipPath3441)" id="g3439"><path id="path3451" style="fill:url(#linearGradient3445);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M857.758 94.3906 656.035 546.801 745.172 53.6406"/></g></g><path id="path3453" style="fill:#b9d110;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m846.91 110.883c-26.609 22.164-66.144 18.558-88.308-8.051-22.164-26.6132-18.559-66.1406 8.05-88.3125 26.61-22.16013 66.145-18.55075 88.309 8.0586 22.164 26.6016 18.559 66.1446-8.051 88.3049"/><g id="g3455"><g clip-path="url(#clipPath3459)" id="g3457"><path id="path3469" style="fill:url(#linearGradient3463);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M481.316 864.746 635.938 602.125l-41.313 301.32"/></g></g><path id="path3471" style="fill:#b9d110;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m491.863 848.059c26.203-22.645 65.797-19.758 88.442 6.441 22.64 26.203 19.758 65.797-6.446 88.441-26.199 22.645-65.796 19.758-88.437-6.445-22.645-26.199-19.762-65.797 6.441-88.437"/><g id="g3473"><g clip-path="url(#clipPath3477)" id="g3475"><path id="path3487" style="fill:url(#linearGradient3481);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M1085.54 913.828 683.598 585.359l456.522 219.75"/></g></g><path id="path3489" style="fill:#22638b;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1050.12 855.145c2.26-34.555 32.1-60.743 66.66-58.485 34.55 2.254 60.74 32.098 58.48 66.653-2.25 34.554-32.09 60.742-66.65 58.484-34.56-2.254-60.74-32.098-58.49-66.652"/><g id="g3491"><g clip-path="url(#clipPath3495)" id="g3493"><path id="path3505" style="fill:url(#linearGradient3499);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M1177.19 335.031 693.664 556.211 1106.69 235.887"/></g></g><path id="path3507" style="fill:#91d2e1;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1108.75 338.84c-29.47-18.176-38.63-56.805-20.46-86.281 18.18-29.477 56.81-38.637 86.29-20.461 29.47 18.179 38.63 56.808 20.45 86.285-18.17 29.476-56.8 38.637-86.28 20.457"/><g id="g3509"><g clip-path="url(#clipPath3513)" id="g3511"><path id="path3523" style="fill:url(#linearGradient3517);fill-opacity:1;fill-rule:nonzero;stroke:none" d="M209.754 773.73l382.32-187.417L280.926 872.391"/></g></g><path id="path3525" style="fill:#91d2e1;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m278.168 769.453c29.598 17.977 39.02 56.543 21.043 86.145-17.977 29.597-56.543 39.019-86.145 21.043-29.597-17.977-39.019-56.543-21.043-86.141 17.977-29.602 56.543-39.023 86.145-21.047"/><path id="path3527" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m714.422 718.262c8.172-9.321 22.351-10.246 31.672-2.074 9.316 8.175 10.246 22.355 2.07 31.675-8.172 9.317-22.351 10.246-31.672 2.071-9.316-8.172-10.246-22.356-2.07-31.672"/><path id="path3529" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m827.305 484.969c8.175-9.321 22.355-10.25 31.672-2.074 9.32 8.171 10.25 22.355 2.074 31.671-8.172 9.321-22.356 10.247-31.672 2.075-9.32-8.176-10.246-22.356-2.074-31.672"/><path id="path3531" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m906.813 877.289c8.175-9.316 22.355-10.246 31.675-2.07 9.317 8.172 10.246 22.351 2.071 31.672-8.172 9.32-22.356 10.246-31.672 2.074-9.321-8.176-10.246-22.356-2.074-31.676"/><path id="path3533" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m987.531 166.984c8.172-9.32 22.359-10.246 31.669-2.074 9.32 8.176 10.25 22.356 2.08 31.676-8.18 9.316-22.358 10.242-31.678 2.07-9.317-8.176-10.247-22.355-2.071-31.672"/><path id="path3535" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m140.008 473.707c8.172-9.32 22.351-10.246 31.672-2.074 9.316 8.176 10.246 22.355 2.074 31.676-8.176 9.316-22.356 10.246-31.676 2.07-9.316-8.172-10.246-22.356-2.07-31.672"/><path id="path3537" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m609.063 315.641c8.171-9.321 22.355-10.246 31.671-2.075 9.321 8.176 10.246 22.356 2.075 31.676-8.176 9.317-22.356 10.246-31.676 2.071-9.317-8.172-10.246-22.352-2.07-31.672"/><path id="path3539" style="fill:#62b92c;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m458.551 398.422c8.172-9.317 22.351-10.246 31.672-2.07 9.32 8.171 10.246 22.351 2.074 31.671-8.176 9.317-22.356 10.247-31.676 2.071-9.316-8.172-10.246-22.352-2.07-31.672"/><path id="path3541" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m518.754 661.82c8.176-9.32 22.355-10.246 31.672-2.074 9.32 8.176 10.25 22.356 2.074 31.676-8.176 9.316-22.355 10.246-31.672 2.07-9.32-8.172-10.25-22.355-2.074-31.672"/><path id="path3543" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m744.523 394.66c8.172-9.32 22.356-10.246 31.672-2.074 9.321 8.176 10.246 22.355 2.075 31.676-8.176 9.316-22.356 10.246-31.672 2.07-9.321-8.172-10.25-22.355-2.075-31.672"/><path id="path3545" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m714.422 605.379c8.172-9.32 22.351-10.246 31.672-2.074 9.316 8.172 10.246 22.355 2.07 31.672-8.172 9.32-22.351 10.246-31.672 2.074-9.316-8.176-10.246-22.356-2.07-31.672"/><path id="path3547" style="fill:#133a73;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m368.242 469.918c8.172-9.32 22.356-10.25 31.672-2.074 9.32 8.172 10.246 22.355 2.074 31.672-8.175 9.32-22.355 10.246-31.675 2.074-9.317-8.176-10.247-22.356-2.071-31.672"/><path id="path3549" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m633.461 620.176c8.172-9.317 22.355-10.246 31.672-2.071 9.32 8.172 10.246 22.356 2.074 31.672-8.176 9.321-22.355 10.246-31.676 2.075-9.316-8.176-10.246-22.356-2.07-31.676"/><path id="path3551" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m646.691 752.129c8.172-9.32 22.352-10.25 31.672-2.074 9.321 8.172 10.246 22.355 2.075 31.672-8.176 9.32-22.356 10.246-31.676 2.074-9.317-8.176-10.246-22.356-2.071-31.672"/><path id="path3553" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m819.777 334.453c8.176-9.316 22.356-10.246 31.676-2.07 9.317 8.172 10.246 22.351 2.07 31.672-8.171 9.32-22.351 10.246-31.671 2.074-9.321-8.176-10.247-22.356-2.075-31.676"/><path id="path3555" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m812.242 571.512c8.176-9.321 22.356-10.246 31.676-2.074 9.316 8.175 10.246 22.355 2.07 31.675-8.172 9.317-22.351 10.246-31.672 2.071-9.316-8.172-10.246-22.356-2.074-31.672"/><path id="path3557" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m382.156 392.988c8.172-9.316 22.356-10.246 31.672-2.07 9.32 8.172 10.246 22.355 2.074 31.672-8.175 9.32-22.355 10.246-31.672 2.074-9.32-8.176-10.25-22.355-2.074-31.676"/><path id="path3559" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m613.543 476.398c8.176-9.32 22.355-10.25 31.676-2.074 9.316 8.176 10.246 22.356 2.07 31.672-8.172 9.32-22.355 10.246-31.672 2.074-9.32-8.175-10.246-22.355-2.074-31.672"/><path id="path3561" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m435.969 645.902c8.172-9.32 22.351-10.246 31.672-2.074 9.32 8.176 10.246 22.356 2.074 31.676-8.176 9.316-22.356 10.246-31.676 2.07-9.316-8.172-10.246-22.355-2.07-31.672"/><path id="path3563" style="fill:#4194d7;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m629.688 164.293c8.171-9.32 22.355-10.246 31.671-2.074 9.321 8.176 10.246 22.355 2.075 31.676-8.176 9.316-22.356 10.246-31.672 2.07-9.321-8.172-10.25-22.356-2.074-31.672"/><path id="path3565" style="fill:#b9d110;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m499.398 462.395c12.329-1.301 23.379 7.632 24.684 19.96 1.305 12.325-7.633 23.375-19.961 24.68-12.324 1.305-23.375-7.633-24.68-19.957-1.304-12.328 7.633-23.379 19.957-24.683"/><path id="path3567" style="fill:#b9d110;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m721.23 510.641c-12.3 1.527-23.511-7.207-25.039-19.508-1.527-12.301 7.207-23.512 19.508-25.039 12.301-1.528 23.512 7.207 25.039 19.508 1.528 12.3-7.207 23.507-19.508 25.039"/><path id="path3569" style="fill:#22638b;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m594.34 420.676c-7.543 9.836-21.629 11.695-31.469 4.152-9.836-7.543-11.691-21.633-4.148-31.469s21.632-11.695 31.468-4.152 11.696 21.633 4.149 31.469"/><path id="path3571" style="fill:#22638b;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m594.828 581.156c-7.543 9.836-21.633 11.696-31.469 4.153s-11.695-21.633-4.152-31.469c7.547-9.836 21.633-11.695 31.469-4.152 9.836 7.542 11.695 21.632 4.152 31.468"/><path id="path3573" style="fill:#91d2e1;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m458.199 576.973c5.156 11.273.199 24.59-11.07 29.75-11.274 5.156-24.59.199-29.746-11.071-5.16-11.273-.203-24.589 11.066-29.75 11.274-5.156 24.594-.199 29.75 11.071"/><path id="path3575" style="fill:#91d2e1;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m635.691 569.449c-5.234-11.234-.367-24.59 10.868-29.82 11.238-5.234 24.589-.371 29.824 10.867 5.234 11.234.367 24.586-10.867 29.82-11.239 5.235-24.59.372-29.825-10.867"/></g></g></svg></div></div><div class="row d-flex m-0 my-4 justify-content-end align-items-end"><small class="text-dark align-content-center mx-3">&copy; 2021 Photon OS Authors. <a href=https://vmware.github.io>A VMware Backed Project</a></small><div class=text-right><a href=../../../../><img class=vmw-footer-logo src=../../../../img/vmware-logo.svg></a></div></div></footer></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=../../../../js/main.min.906bd02f142be20eb94bb49539a18a3e93ec0b9ff5f5dcf3796eed436a6103d2.js integrity="sha256-kGvQLxQr4g65S7SVOaGKPpPsC5/19dzzeW7tQ2phA9I=" crossorigin=anonymous></script><script src=../../../../js/animated.js></script></body></html>